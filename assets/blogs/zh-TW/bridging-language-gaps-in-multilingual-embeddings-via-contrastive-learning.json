{
  "slug": "bridging-language-gaps-in-multilingual-embeddings-via-contrastive-learning",
  "id": "67066bd652567c0001d0f2cd",
  "uuid": "1130051f-f343-4eb2-9956-9b574c212704",
  "title": "透過對比學習來彌合多語言嵌入的語言差距",
  "html": "<p>在多語言模型中，其中一個主要挑戰是「<strong>語言差距</strong>」— 一種不同語言中相同意思的短語沒有如預期般緊密對齊或聚集的現象。理想情況下，一種語言的文本與另一種語言的等效文本應該有相似的表示 — 也就是說，它們的嵌入向量應該非常接近 — 從而讓跨語言應用能夠在不同語言的文本上以相同方式運作。然而，模型往往會微妙地表示文本的語言，造成「語言差距」，導致跨語言性能不理想。</p><p>在這篇文章中，我們將探討這種語言差距以及它如何影響文本嵌入模型的性能。我們使用 <code>jina-xlm-roberta</code> 模型和最新的 <code>jina-embeddings-v3</code> 進行了實驗，評估同一語言中釋義以及不同語言對之間翻譯的語義對齊情況。這些實驗揭示了在不同訓練條件下，具有相似或相同含義的短語如何聚集在一起。</p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://jina.ai/news/jina-embeddings-v3-a-frontier-multilingual-embedding-model/?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">Jina Embeddings v3: A Frontier Multilingual Embedding Model</div><div class=\"kg-bookmark-description\">jina-embeddings-v3 is a frontier multilingual text embedding model with 570M parameters and 8192 token-length, outperforming the latest proprietary embeddings from OpenAI and Cohere on MTEB.</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-128x128-6.png\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/v3banner-1.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><p>我們還實驗了改善跨語言語義對齊的訓練技術，特別是在對比學習過程中引入<strong>平行多語言數據</strong>。在本文中，我們將分享我們的見解和結果。</p><h2 id=\"multilingual-model-training-creates-and-reduces-the-language-gap\"><strong>多語言模型訓練創造和減少語言差距</strong></h2><p>文本嵌入模型的訓練通常包含兩個主要部分的多階段過程：</p><ol><li><a href=\"https://aclanthology.org/2023.acl-long.49/?ref=jina-ai-gmbh.ghost.io\"><strong>遮罩語言建模</strong></a>（MLM）：預訓練通常涉及大量文本，其中一些標記被隨機遮罩。模型被訓練來預測這些被遮罩的標記。這個程序教導模型學習訓練數據中的語言模式，包括可能來自語法、詞彙語義和語用現實世界限制的標記之間的選擇依賴關係。</li><li><a href=\"https://paperswithcode.com/task/contrastive-learning?ref=jina-ai-gmbh.ghost.io\"><strong>對比學習</strong></a>：在預訓練之後，模型會使用經過策劃或半策劃的數據進行進一步訓練，使語義相似的文本的嵌入向量更接近，並（可選地）將不相似的文本推得更遠。這種訓練可以使用已知或至少可靠估計的語義相似度的文本對、三元組甚至群組。它可能有幾個子階段，這部分過程有多種訓練策略，新的研究經常發表，目前尚未就最佳方法達成共識。</li></ol><p>要理解語言差距是如何產生的以及如何縮小它，我們需要了解這兩個階段的作用。</p><h3 id=\"masked-language-pretraining\"><strong>遮罩語言預訓練</strong></h3><p>文本嵌入模型的一些跨語言能力是在預訓練期間獲得的。</p><p>同源詞和借用詞使模型能夠從大量文本數據中學習一些跨語言語義對齊。例如，英文單詞 <em>banana</em> 和法文單詞 <em>banane</em>（以及德文 <em>Banane</em>）在拼寫上足夠相似且使用頻繁，使得嵌入模型可以學習到看起來像「banan-」的詞在不同語言中有相似的分佈模式。它可以利用這些信息來學習，在某種程度上，其他跨語言間看起來不相同的詞也有相似的含義，甚至可以理解一些語法結構是如何被翻譯的。</p><p>然而，這種學習是在沒有明確訓練的情況下發生的。</p><p>我們測試了 <code>jina-xlm-roberta</code> 模型（<code>jina-embeddings-v3</code> 的預訓練骨幹）來看它在遮罩語言預訓練中學習跨語言等效性的程度如何。我們繪製了一組英語句子翻譯成德語、荷蘭語、簡體中文和日語的二維 <a href=\"https://pair-code.github.io/understanding-umap/?ref=jina-ai-gmbh.ghost.io\">UMAP 句子表示</a>。結果如下圖所示：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_roberta_mlm_representation.png\" class=\"kg-image\" alt=\"Multilingual scatterplot showing word embeddings' alignment across five languages on UMAP dimensions.\" loading=\"lazy\" width=\"1000\" height=\"800\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/jina_xlm_roberta_mlm_representation.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_roberta_mlm_representation.png 1000w\" sizes=\"(min-width: 720px) 720px\"></figure><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\">選定英語句子及其德語、荷蘭語、中文和日語翻譯的二維 UMAP 投影。灰線將非英語句子連接到它們翻譯自的英語句子。<br><br>這些句子在 <code spellcheck=\"false\" style=\"white-space: pre-wrap;\">jina-xlm-roberta</code> 嵌入空間中強烈傾向於形成特定語言的聚類，儘管在這個投影中你可以看到一些可能是二維投影副作用的離群值。</div></div><p>你可以看到預訓練已經非常強烈地將同一語言的句子嵌入聚集在一起。這是一個將高維空間分佈投影到二維的結果，所以德語句子與其英語原文的翻譯仍有可能是最接近的。但它確實表明，英語句子的嵌入可能比起語義完全相同或幾乎相同的德語句子，更接近另一個英語句子。</p><p>還要注意德語和荷蘭語形成的聚類比其他語言對更接近。對於這兩種相對密切相關的語言來說，這並不令人驚訝。德語和荷蘭語的相似程度有時甚至可以部分互相理解。</p><p>日語和中文也似乎比其他語言更接近。雖然它們之間的關係不同，但書面日語通常使用漢字（漢字），中文稱為「漢字」。日語與中文共享大多數這些書面字符，兩種語言都有許多由一個或多個漢字組成的共同詞彙。從 MLM 的角度來看，這與荷蘭語和德語之間的可見相似性是相同的。</p><p>我們可以通過只看兩種語言的兩個句子，以更簡單的方式看到這種「語言差距」：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--8-.png\" class=\"kg-image\" alt=\"Graph illustrating linguistic relationships with color-coded lines, data points for English and German phrases, and an &quot;MLM P\" loading=\"lazy\" width=\"1815\" height=\"1014\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/image--8-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/image--8-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/image--8-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--8-.png 1815w\" sizes=\"(min-width: 720px) 720px\"></figure><p>由於 MLM 似乎自然地按語言將文本聚集在一起，「my dog is blue」和「my cat is red」被聚集在一起，遠離它們的德語對應詞。與先前部落格文章中討論的「<a href=\"https://jina.ai/news/the-what-and-why-of-text-image-modality-gap-in-clip-models/?ref=jina-ai-gmbh.ghost.io\">模態差距</a>」不同，我們認為這源於語言之間的表面相似性和差異性：相似的拼寫、印刷中相同字符序列的使用，以及可能在形態和句法結構上的相似性 — 常見的詞序和構詞方式。</p><p>簡而言之，無論模型在 MLM 預訓練中學習跨語言等效性的程度如何，這都不足以克服按語言聚集文本的強烈偏差。這留下了一個巨大的語言差距。</p><h3 id=\"contrastive-learning\"><strong>對比學習</strong></h3><p>理想情況下，我們希望嵌入模型對語言無差別，只在其嵌入中編碼一般含義。在這樣的模型中，我們將看不到按語言聚集的情況，也不會有語言差距。一種語言的句子應該與其良好的翻譯非常接近，而與其他意思不同的句子相距較遠，即使是同一語言，如下圖所示：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-10---1-.png\" class=\"kg-image\" alt=\"Graph displays &quot;Clustering by Meaning&quot; with multilingual labels, emphasizing abstract concepts on a dark backdrop.\" loading=\"lazy\" width=\"1815\" height=\"1014\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-10---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-10---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-10---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-10---1-.png 1815w\" sizes=\"(min-width: 720px) 720px\"></figure><p>MLM 預訓練無法實現這一點，所以我們使用額外的<em>對比學習</em>技術來改善嵌入中的語義表示。</p><p>對比學習涉及使用已知在含義上相似或不同的文本對，以及其中一對比另一對更相似的三元組。在訓練過程中調整權重以反映文本對和三元組之間的這種已知關係。</p><p>我們的對比學習數據集中包含 30 種語言，但 97% 的對和三元組都是在單一語言中，只有 3% 涉及跨語言對或三元組。但這 3% 足以產生戲劇性的結果：嵌入顯示很少語言聚集，且語義相似的文本會產生接近的嵌入，無論它們的語言如何，這在 <code>jina-embeddings-v3</code> 的 UMAP 投影中可以看到。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_contrastive_representation.png\" class=\"kg-image\" alt=\"Scatter plot on black background showing language distribution post-contrastive training with UMAP dimensions.\" loading=\"lazy\" width=\"1000\" height=\"800\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/jina_xlm_contrastive_representation.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_contrastive_representation.png 1000w\" sizes=\"(min-width: 720px) 720px\"></figure><p>為了確認這一點，我們在 STS17 資料集上測量了 <code>jina-xlm-roberta</code> 和 <code>jina-embeddings-v3</code> 生成的表示之間的 Spearman 相關性。</p><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\"><a href=\"https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient?ref=jina-ai-gmbh.ghost.io\"><b><strong style=\"white-space: pre-wrap;\">Spearman 相關性</strong></b></a>測量排序相關性，即兩個有序列表的相似程度。這是比較 embedding 模型之間以及與人類評分的好機制，因為實際分數遠不如哪些項目排在其他項目之上或之下重要。</div></div><p>下表顯示了不同語言翻譯文本的語義相似性排名之間的 Spearman 相關性。我們取一組英語句子，然後測量它們的 embeddings 與特定參考句子的 embedding 之間的相似度，並按照從最相似到最不相似的順序排序。然後我們將所有這些句子翻譯成另一種語言並重複排序過程。在理想的跨語言 embedding 模型中，這兩個有序列表應該相同，Spearman 相關性應為 1.0。</p><p>下面的圖表和表格顯示了我們使用 <code>jina-xlm-roberta</code> 和 <code>jina-embeddings-v3</code> 比較英語與 STS17 基準中其他六種語言的結果。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-4---1-.png\" class=\"kg-image\" alt=\"Bar chart comparing Spearman Correlation for English paired with AR, DE, ES, FR, IT, NL, colored in red and blue by alphabet \" loading=\"lazy\" width=\"2000\" height=\"1056\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-4---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-4---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-4---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-4---1-.png 2085w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Task</strong></th>\n<th><strong><code>jina-xlm-roberta</code></strong></th>\n<th><strong><code>jina-embeddings-v3</code></strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>English ↔ Arabic</td>\n<td>0.1581</td>\n<td><strong>0.7977</strong></td>\n</tr>\n<tr>\n<td>English ↔ German</td>\n<td>0.2136</td>\n<td><strong>0.8366</strong></td>\n</tr>\n<tr>\n<td>English ↔ Spanish</td>\n<td>0.1049</td>\n<td><strong>0.8509</strong></td>\n</tr>\n<tr>\n<td>English ↔ French</td>\n<td>0.1659</td>\n<td><strong>0.8378</strong></td>\n</tr>\n<tr>\n<td>English ↔ Italian</td>\n<td>0.2293</td>\n<td><strong>0.8674</strong></td>\n</tr>\n<tr>\n<td>English ↔ Dutch</td>\n<td>0.2387</td>\n<td><strong>0.8398</strong></td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<p>你可以看到對比學習與原始預訓練相比帶來了巨大的差異。儘管在訓練組合中只有 3% 的跨語言數據，<code>jina-embeddings-v3</code> 模型已經學會了足夠的跨語言語義，幾乎消除了它在預訓練中獲得的語言差距。</p><h2 id=\"english-vs-the-world-can-other-languages-keep-up-in-alignment\">英語對比世界：其他語言能否在對齊方面保持同步？</h2><p>我們在 89 種語言上訓練了 <code>jina-embeddings-v3</code>，特別關注 30 種使用非常廣泛的書面語言。儘管我們努力建立大規模的多語言訓練語料庫，英語仍然佔我們在對比訓練中使用的數據的近一半。其他語言，包括那些有大量文本材料可用的廣泛使用的全球語言，相比訓練集中龐大的英語數據而言，仍然相對代表性不足。</p><p>考慮到英語的這種主導地位，英語表示是否比其他語言的表示更加對齊？為了探索這一點，我們進行了一項後續實驗。</p><p>我們建立了一個數據集 <a href=\"https://huggingface.co/datasets/jinaai/parallel-sentences?ref=jina-ai-gmbh.ghost.io\"><code>parallel-sentences</code></a>，包含 1,000 對英語文本，一個\"錨點\"和一個\"正例\"，其中正例文本在邏輯上蘊含於錨點文本。</p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://huggingface.co/datasets/jinaai/parallel-sentences?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">jinaai/parallel-sentences · Datasets at Hugging Face</div><div class=\"kg-bookmark-description\">We're on a journey to advance and democratize artificial intelligence through open source and open science.</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-3.ico\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/parallel-sentences.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><p>例如下表中的第一行。這些句子在意義上並不完全相同，但它們具有相容的含義。它們以信息豐富的方式描述了相同的情況。</p><p>然後，我們使用 GPT-4 將這些句對翻譯成五種語言：德語、荷蘭語、簡體中文、繁體中文和日語。最後，我們手動檢查以確保質量。</p>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Language</strong></th>\n<th><strong>Anchor</strong></th>\n<th><strong>Positive</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>English</td>\n<td>Two young girls are playing outside in a non-urban environment.</td>\n<td>Two girls are playing outside.</td>\n</tr>\n<tr>\n<td>German</td>\n<td>Zwei junge Mädchen spielen draußen in einer nicht urbanen Umgebung.</td>\n<td>Zwei Mädchen spielen draußen.</td>\n</tr>\n<tr>\n<td>Dutch</td>\n<td>Twee jonge meisjes spelen buiten in een niet-stedelijke omgeving.</td>\n<td>Twee meisjes spelen buiten.</td>\n</tr>\n<tr>\n<td>Chinese (Simplified)</td>\n<td>两个年轻女孩在非城市环境中玩耍。</td>\n<td>两个女孩在外面玩。</td>\n</tr>\n<tr>\n<td>Chinese (Traditional)</td>\n<td>兩個年輕女孩在非城市環境中玩耍。</td>\n<td>兩個女孩在外面玩。</td>\n</tr>\n<tr>\n<td>Japanese</td>\n<td>2人の若い女の子が都市環境ではない場所で遊んでいます。</td>\n<td>二人の少女が外で遊んでいます。</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<p>然後，我們使用 <code>jina-embeddings-v3</code> 對每對文本進行編碼，並計算它們之間的餘弦相似度。下面的圖表和表格顯示了每種語言的餘弦相似度分數分布和平均相似度：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/1_monolingual_distribution_triplets.png\" class=\"kg-image\" alt=\"Graph showing cosine similarity distributions for textual pairs in English, German, Dutch, Chinese, and Japanese against dens\" loading=\"lazy\" width=\"1060\" height=\"590\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/1_monolingual_distribution_triplets.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/1_monolingual_distribution_triplets.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/1_monolingual_distribution_triplets.png 1060w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Language</strong></th>\n<th><strong>Average Cosine Similarity</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>English</td>\n<td>0.9078</td>\n</tr>\n<tr>\n<td>German</td>\n<td>0.8949</td>\n</tr>\n<tr>\n<td>Dutch</td>\n<td>0.8844</td>\n</tr>\n<tr>\n<td>Chinese (Simplified)</td>\n<td>0.8876</td>\n</tr>\n<tr>\n<td>Chinese (Traditional)</td>\n<td>0.8933</td>\n</tr>\n<tr>\n<td>Japanese</td>\n<td>0.8895</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<p>儘管英語在訓練數據中占主導地位，<code>jina-embeddings-v3</code> 在德語、荷蘭語、日語和兩種形式的中文中識別語義相似性的能力與英語相當。</p><h2 id=\"breaking-language-barriers-cross-lingual-alignment-beyond-english\"><strong>打破語言障礙：超越英語的跨語言對齊</strong></h2><p>跨語言表示對齊的研究通常著重於包含英語的語言對。這種關注點在理論上可能會掩蓋真實的情況。模型可能只是優化將所有內容儘可能地貼近其英語對應項，而沒有檢驗其他語言對是否得到適當支援。</p><p>為了探索這一點，我們使用 <code>parallel-sentences</code> 資料集進行了一些實驗，重點關注超越英語雙語對的跨語言對齊。</p><p>下表顯示了不同語言對之間等效文本（即源自相同英語文本的翻譯）的餘弦相似度分佈。理想情況下，所有語言對的餘弦值應為 1 — 即完全相同的語義嵌入。實際上，這種情況不可能發生，但我們期望一個好的模型在翻譯對之間有很高的餘弦值。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--9-.png\" class=\"kg-image\" alt=\"Density graph charting cross-lingual cosine similarities for language pairs using jina-embeddings-v3 model.\" loading=\"lazy\" width=\"978\" height=\"584\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/image--9-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--9-.png 978w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Language Pair</strong></th>\n<th><strong>Average Cosine Similarity</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>German ↔ Dutch</td>\n<td>0.8779</td>\n</tr>\n<tr>\n<td>German ↔ Japanese</td>\n<td>0.8664</td>\n</tr>\n<tr>\n<td>Chinese (Simplified) ↔ Japanese</td>\n<td>0.8534</td>\n</tr>\n<tr>\n<td>Dutch ↔ Chinese (Simplified)</td>\n<td>0.8479</td>\n</tr>\n<tr>\n<td>Chinese (Simplified) ↔ Chinese (Traditional)</td>\n<td>0.8758</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<p>雖然不同語言之間的相似度得分比同一語言中相容文本的得分略低，但仍然非常高。荷蘭語/德語翻譯之間的餘弦相似度幾乎與德語中相容文本之間的相似度一樣高。</p><p>這可能並不令人驚訝，因為德語和荷蘭語是非常相似的語言。同樣，這裡測試的兩種中文變體實際上並不是兩種不同的語言，只是同一語言的不同風格形式。但你可以看到，即使是像荷蘭語和中文或德語和日語這樣非常不同的語言對，在語義等效的文本之間仍然表現出很強的相似性。</p><p>我們考慮到這些非常高的相似值可能是使用 ChatGPT 作為翻譯器的副作用。為了測試這一點，我們下載了<a href=\"https://help.ted.com/hc/en-us/articles/360018572954-How-do-I-find-transcripts-for-TED-and-TEDx-talks?ref=jina-ai-gmbh.ghost.io\">人工翻譯的 TED Talks 英語和德語字幕</a>，並檢查對齊的翻譯句子是否具有相同的高相關性。</p><p>結果比我們的機器翻譯數據更強，如下圖所示。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--10-.png\" class=\"kg-image\" alt=\"Graph of cross-lingual alignment density EN-DE with peak around cosine similarity 1.0, titled &quot;jina-embeddings-v3: Cross-ling\" loading=\"lazy\" width=\"988\" height=\"590\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/image--10-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--10-.png 988w\" sizes=\"(min-width: 720px) 720px\"></figure><h2 id=\"how-much-does-cross-language-data-contribute-to-cross-language-alignment\">跨語言資料對跨語言對齊的貢獻有多大？</h2><p>語言差距的消失和跨語言性能的高水準似乎與訓練資料中明確的跨語言部分（僅 3%）不成比例。只有 3% 的對比訓練資料明確教導模型如何在語言之間進行對齊。</p><p>因此我們進行了一項測試，以查看跨語言是否有任何貢獻。</p><p>完全重新訓練不包含任何跨語言資料的 <code>jina-embeddings-v3</code> 對於一個小實驗來說成本太高，所以我們從 Hugging Face 下載了 <a href=\"https://huggingface.co/FacebookAI/xlm-roberta-base?ref=jina-ai-gmbh.ghost.io\"><code>xlm-roberta-base</code> 模型</a>，並使用我們訓練 <code>jina-embeddings-v3</code> 時使用的部分資料進行對比學習。我們專門調整了跨語言資料的數量以測試兩種情況：一種完全沒有跨語言資料，另一種有 20% 的語言對是跨語言的。下表顯示了訓練的元參數：</p>\n<!--kg-card-begin: html-->\n<table id=\"e30425bb-015e-4956-8872-b1b64cdd7ad0\" class=\"simple-table\"><tbody><tr id=\"daa3cfcc-9012-411b-8da3-05c7c6f4b371\"><td id=\"<j<o\" class=\"\" style=\"width:187.9375px\"><strong>Backbone</strong></td><td id=\"DU<d\" class=\"\"><strong>% Cross-Language</strong></td><td id=\"@Feo\" class=\"\"><strong>Learning Rate</strong></td><td id=\"fZNx\" class=\"\"><strong>Loss Function</strong></td><td id=\"Rv}\\\" class=\"\"><strong>Temperature</strong></td></tr><tr id=\"f3a2d068-d902-4fc1-8c89-269a5ebbb135\"><td id=\"<j<o\" class=\"\" style=\"width:187.9375px\"><code>xlm-roberta-base </code><strong>without</strong> X-language data</td><td id=\"DU<d\" class=\"\">0%</td><td id=\"@Feo\" class=\"\">5e-4</td><td id=\"fZNx\" class=\"\">InfoNCE</td><td id=\"Rv}\\\" class=\"\">0.05</td></tr><tr id=\"52887e22-326c-46cd-b79c-d6dcd110c1d2\"><td id=\"<j<o\" class=\"\" style=\"width:187.9375px\"><code>xlm-roberta-base</code><strong> with </strong>X-language data</td><td id=\"DU<d\" class=\"\">20%</td><td id=\"@Feo\" class=\"\">5e-4</td><td id=\"fZNx\" class=\"\">InfoNCE</td><td id=\"Rv}\\\" class=\"\">0.05</td></tr></tbody></table>\n<!--kg-card-end: html-->\n<p>然後，我們使用來自 MTEB 的 <a href=\"https://github.com/embeddings-benchmark/mteb?ref=jina-ai-gmbh.ghost.io\">STS17 和 STS22 基準測試</a>以及斯皮爾曼相關係數評估了兩個模型的跨語言性能。結果如下：</p><h3 id=\"sts17\"><strong>STS17</strong></h3><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-6---1-.png\" class=\"kg-image\" alt=\"Bar graph showing Spearman correlation for language pairs on STS17 with and without parallel corpus.\" loading=\"lazy\" width=\"2000\" height=\"1032\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-6---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-6---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-6---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-6---1-.png 2133w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table id=\"de30bf7f-d1a9-43f4-8e5f-15bf65c59674\" class=\"simple-table\"><tbody><tr id=\"5c6440a6-eba9-404a-a5f1-88099bc6702d\"><td id=\"{N[x\" class=\"\"><strong>Language Pair</strong></td><td id=\"jGmJ\" class=\"\"><strong>With parallel corpora</strong></td><td id=\"p<ZH\" class=\"\"><strong>Without parallel corpora</strong></td></tr><tr id=\"33f08461-58aa-43f3-9ed1-577f8676e99d\"><td id=\"{N[x\" class=\"\">English ↔ Arabic</td><td id=\"jGmJ\" class=\"\"><strong>0.6418</strong></td><td id=\"p<ZH\" class=\"\">0.5875</td></tr><tr id=\"9875386d-2043-4d9d-8252-e53ec525ec29\"><td id=\"{N[x\" class=\"\">English ↔ German</td><td id=\"jGmJ\" class=\"\">0.7364</td><td id=\"p<ZH\" class=\"\"><strong>0.7390</strong></td></tr><tr id=\"15d28a12-3a80-4176-9984-69b5d8a7d8ff\"><td id=\"{N[x\" class=\"\">English ↔ Spanish</td><td id=\"jGmJ\" class=\"\"><strong>0.6968</strong></td><td id=\"p<ZH\" class=\"\">0.6799</td></tr><tr id=\"21821558-c8b9-4c34-8ec5-9db3ca7d9328\"><td id=\"{N[x\" class=\"\">English ↔ French</td><td id=\"jGmJ\" class=\"\"><strong>0.7066</strong></td><td id=\"p<ZH\" class=\"\">0.6944</td></tr><tr id=\"a2e3b5e5-8e4a-4270-abff-5d059ff6be72\"><td id=\"{N[x\" class=\"\">English ↔ Italian</td><td id=\"jGmJ\" class=\"\"><strong>0.7232</strong></td><td id=\"p<ZH\" class=\"\">0.7070</td></tr><tr id=\"95daf20f-2a82-4431-8581-a4ce24d81462\"><td id=\"{N[x\" class=\"\">English ↔ Dutch</td><td id=\"jGmJ\" class=\"\"><strong>0.7597</strong></td><td id=\"p<ZH\" class=\"\">0.7468</td></tr><tr id=\"4fd4c45a-a69e-4e33-b057-9c5f10b99fdb\"><td id=\"{N[x\" class=\"\">English ↔ Turkish</td><td id=\"jGmJ\" class=\"\"><strong>0.6933</strong></td><td id=\"p<ZH\" class=\"\">0.6050</td></tr></tbody></table>\n<!--kg-card-end: html-->\n<h3 id=\"sts22\"><strong>STS22</strong></h3><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-7---1-.png\" class=\"kg-image\" alt=\"Chart comparing models of language alignment, showing Spearman correlation scores for eight language pairs with and without p\" loading=\"lazy\" width=\"2000\" height=\"1032\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-7---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-7---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-7---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-7---1-.png 2133w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table id=\"e53757df-8a0e-42ec-ba05-715baa3c77cd\" class=\"simple-table\"><tbody><tr id=\"45c43b8c-b1b7-4ac0-91b0-1e07025f1b92\"><td id=\"OF=p\" class=\"\"><strong>語言對</strong></td><td id=\"P<\\i\" class=\"\"><strong>使用平行語料庫</strong></td><td id=\"LAtp\" class=\"\"><strong>不使用平行語料庫</strong></td></tr><tr id=\"696ebe11-3eda-49ef-8dfe-608f9b71430b\"><td id=\"OF=p\" class=\"\">English ↔ Spanish</td><td id=\"P<\\i\" class=\"\"><strong>0.7710</strong></td><td id=\"LAtp\" class=\"\">0.7675</td></tr><tr id=\"eb4c1d81-7d98-453d-af3f-95b2adccfb55\"><td id=\"OF=p\" class=\"\">Simplified Chinese ↔ English</td><td id=\"P<\\i\" class=\"\"><strong>0.6885</strong></td><td id=\"LAtp\" class=\"\">0.6860</td></tr><tr id=\"533cefd3-b30e-4d6a-9350-8f5d28b17ba6\"><td id=\"OF=p\" class=\"\">Spanish ↔ Italian</td><td id=\"P<\\i\" class=\"\"><strong>0.6829</strong></td><td id=\"LAtp\" class=\"\">0.6814</td></tr><tr id=\"d3ecdd71-44bb-4a3b-9ac2-8cc90a785d5f\"><td id=\"OF=p\" class=\"\">German ↔ French</td><td id=\"P<\\i\" class=\"\"><strong>0.5763</strong></td><td id=\"LAtp\" class=\"\">0.5496</td></tr><tr id=\"c6242853-4da7-4369-b1f1-1a27262a487a\"><td id=\"OF=p\" class=\"\">German ↔ English</td><td id=\"P<\\i\" class=\"\">0.5439</td><td id=\"LAtp\" class=\"\"><strong>0.5566</strong></td></tr><tr id=\"31a4a5ba-199c-4904-b926-ff0561aac1b5\"><td id=\"OF=p\" class=\"\">Polish ↔ English</td><td id=\"P<\\i\" class=\"\">0.6966</td><td id=\"LAtp\" class=\"\"><strong>0.7156</strong></td></tr><tr id=\"4f529d81-e8c9-4e5d-a705-36e357abebc3\"><td id=\"OF=p\" class=\"\">German ↔ English</td><td id=\"P<\\i\" class=\"\"><strong>0.5832</strong></td><td id=\"LAtp\" class=\"\">0.5478</td></tr><tr id=\"cd1429f7-c810-4a0e-9dca-88e2c83157bc\"><td id=\"OF=p\" class=\"\">French ↔ Polish</td><td id=\"P<\\i\" class=\"\">0.8451</td><td id=\"LAtp\" class=\"\">0.8451</td></tr></tbody></table>\n<!--kg-card-end: html-->\n<p>令我們驚訝的是，對於我們測試的大多數語言對來說，跨語言訓練數據幾乎沒有帶來任何改進。雖然無法確定在使用更大數據集的完整訓練模型中是否依然如此，但這確實證明了顯式的跨語言訓練並沒有增加太多價值。</p><p>不過，需要注意的是 STS17 包含了英語/阿拉伯語和英語/土耳其語對。這兩種語言在我們的訓練數據中的代表性都相對較低。我們使用的 XML-RoBERTa 模型在預訓練數據中，阿拉伯語僅佔 2.25%，土耳其語僅佔 2.32%，遠低於我們測試的其他語言。在這個實驗中使用的小型對比學習數據集中，阿拉伯語僅佔 1.7%，土耳其語僅佔 1.8%。</p><p>這兩個語言對是測試中唯一使用跨語言數據訓練能夠產生明顯差異的語言對。我們認為，對於在訓練數據中代表性較低的語言，顯式跨語言數據可能更有效，但在得出結論之前需要進行更多探索。跨語言數據在對比訓練中的作用和效果是 Jina AI 正在積極研究的領域。</p><h2 id=\"conclusion\">結論</h2><p>傳統的語言預訓練方法（如遮蔽語言建模）會留下\"語言差距\"，導致不同語言中語義相似的文本無法像應有的那樣緊密對齊。我們已經證明，Jina Embeddings 的對比學習方案在減少或甚至消除這種差距方面非常有效。</p><p>為什麼這種方法有效，其原因尚不完全清楚。我們在對比訓練中使用了顯式的跨語言文本對，但數量很少，而且它們在確保高質量跨語言結果方面實際發揮了多大作用還不清楚。我們嘗試在更受控的條件下展示明確效果，但並未得到明確的結果。</p><p>然而，<strong>很明顯 <code>jina-embeddings-v3</code> 已經克服了預訓練中的語言差距，使其成為多語言應用的強大工具。</strong>它已經可以用於任何需要跨多種語言保持相同強大性能的任務。</p><p>您可以通過我們的 <a href=\"https://jina.ai/embeddings?ref=jina-ai-gmbh.ghost.io\">Embeddings API</a>（提供一百萬個免費 token）或通過 AWS 或 Azure 使用 <code>jina-embeddings-v3</code>。如果您想在這些平台之外或在公司內部使用它，請記住它是在 CC BY-NC 4.0 許可下授權的。如果您對商業使用感興趣，請<a href=\"https://jina.ai/contact-sales?ref=jina-ai-gmbh.ghost.io\">聯繫我們</a>。</p>",
  "comment_id": "67066bd652567c0001d0f2cd",
  "feature_image": "https://jina-ai-gmbh.ghost.io/content/images/2024/10/gap-blog-1.jpg",
  "featured": false,
  "visibility": "public",
  "created_at": "2024-10-09T13:41:10.000+02:00",
  "updated_at": "2024-10-10T20:15:26.000+02:00",
  "published_at": "2024-10-09T14:42:22.000+02:00",
  "custom_excerpt": "Multilingual models often face a \"language gap,\" where similar phrases in different languages don't align. We show how contrastive learning can bridge this gap, enhancing cross-language performance.",
  "codeinjection_head": null,
  "codeinjection_foot": null,
  "custom_template": null,
  "canonical_url": null,
  "authors": [
    {
      "id": "6360e7e05e0f6e004d70bd99",
      "name": "Bo Wang",
      "slug": "bo",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/4B483B29-E306-402B-8635-64866C458406.jpeg",
      "cover_image": null,
      "bio": "Developer @Jina, Contributor to open source ",
      "website": "https://bwanglzu.github.io/",
      "location": "Berlin",
      "facebook": null,
      "twitter": "@bo_wangbo",
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/bo/"
    },
    {
      "id": "632ae7353e4e55003d52598e",
      "name": "Scott Martens",
      "slug": "scott",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/photo-of-me-cropped.jpg",
      "cover_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/shanshui-ernie-crop.png",
      "bio": "A rogue AI created by Canada's Weapon X program.\n\nContent Creator @ Jina AI",
      "website": "https://jina.ai",
      "location": "Berlin",
      "facebook": null,
      "twitter": null,
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/scott/"
    },
    {
      "id": "632ade4a3e4e55003d525971",
      "name": "Alex C-G",
      "slug": "alexcg",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/09/alex.jpg",
      "cover_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/twitter_banner.jpg",
      "bio": "Open-source Evangelist @ Jina AI. Old, grim, and full of Vim",
      "website": null,
      "location": "Berlin, Germany",
      "facebook": null,
      "twitter": "@alexcg",
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/alexcg/"
    }
  ],
  "tags": [
    {
      "id": "634a1a8ccebfc1003d8ab706",
      "name": "Tech Blog",
      "slug": "tech-blog",
      "description": null,
      "feature_image": null,
      "visibility": "public",
      "og_image": null,
      "og_title": null,
      "og_description": null,
      "twitter_image": null,
      "twitter_title": null,
      "twitter_description": null,
      "meta_title": null,
      "meta_description": null,
      "codeinjection_head": null,
      "codeinjection_foot": null,
      "canonical_url": null,
      "accent_color": null,
      "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
    }
  ],
  "primary_author": {
    "id": "6360e7e05e0f6e004d70bd99",
    "name": "Bo Wang",
    "slug": "bo",
    "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/4B483B29-E306-402B-8635-64866C458406.jpeg",
    "cover_image": null,
    "bio": "Developer @Jina, Contributor to open source ",
    "website": "https://bwanglzu.github.io/",
    "location": "Berlin",
    "facebook": null,
    "twitter": "@bo_wangbo",
    "meta_title": null,
    "meta_description": null,
    "url": "https://jina-ai-gmbh.ghost.io/author/bo/"
  },
  "primary_tag": {
    "id": "634a1a8ccebfc1003d8ab706",
    "name": "Tech Blog",
    "slug": "tech-blog",
    "description": null,
    "feature_image": null,
    "visibility": "public",
    "og_image": null,
    "og_title": null,
    "og_description": null,
    "twitter_image": null,
    "twitter_title": null,
    "twitter_description": null,
    "meta_title": null,
    "meta_description": null,
    "codeinjection_head": null,
    "codeinjection_foot": null,
    "canonical_url": null,
    "accent_color": null,
    "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
  },
  "url": "https://jina-ai-gmbh.ghost.io/podcast/bridging-language-gaps-in-multilingual-embeddings-via-contrastive-learning/",
  "excerpt": "多語言模型經常面臨「語言差異」的問題，即不同語言中的相似片語無法對齊。我們展示了對比式學習如何能彌合這個差異，提升跨語言表現。",
  "reading_time": 13,
  "access": true,
  "comments": false,
  "og_image": null,
  "og_title": null,
  "og_description": null,
  "twitter_image": null,
  "twitter_title": null,
  "twitter_description": null,
  "meta_title": null,
  "meta_description": null,
  "email_subject": null,
  "frontmatter": null,
  "feature_image_alt": "Neon green squares form intricate patterns on a black digital background, creating a dynamic, abstract design.",
  "feature_image_caption": null
}