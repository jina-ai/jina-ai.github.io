{
  "slug": "readerlm-v2-frontier-small-language-model-for-html-to-markdown-and-json",
  "id": "6785bfd62defad0001fb5f22",
  "uuid": "a8e2e140-18e5-49e6-aa8f-71bf4c9e3293",
  "title": "ReaderLM v2：用於 HTML 轉換 Markdown 和 JSON 的前沿小型語言模型",
  "html": "<figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://huggingface.co/jinaai/ReaderLM-v2?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">jinaai/ReaderLM-v2 · Hugging Face</div><div class=\"kg-bookmark-description\">We're on a journey to advance and democratize artificial intelligence through open source and open science.</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-24.ico\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/ReaderLM-v2.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><p>2024 年 4 月，我們推出了 <a href=\"https://jina.ai/reader?ref=jina-ai-gmbh.ghost.io\">Jina Reader</a>，這是一個只需在 URL 前加上 <code>r.jina.ai</code> 前綴就能將任何網頁轉換為 LLM 友好格式 markdown 的 API。2024 年 9 月，<a href=\"https://jina.ai/news/reader-lm-small-language-models-for-cleaning-and-converting-html-to-markdown?ref=jina-ai-gmbh.ghost.io\">我們推出了兩個專門用於將原始 HTML 轉換為乾淨 markdown 的小型語言模型：<code>reader-lm-0.5b</code> 和 <code>reader-lm-1.5b</code></a>。今天，我們很高興推出 ReaderLM 的第二代，這是一個 1.5B 參數的語言模型，可以將原始 HTML 轉換為格式優美的 markdown 或 JSON，具有更高的準確性和改進的長文本處理能力。<code>ReaderLM-v2</code> 可處理高達 512K 個 token 的輸入和輸出總長度。該模型提供 29 種語言的多語言支援，包括英語、中文、日語、韓語、法語、西班牙語、葡萄牙語、德語、義大利語、俄語、越南語、泰語、阿拉伯語等。</p><p>得益於其<strong>新的訓練範式</strong>和<strong>更高品質的訓練數據</strong>，<code>ReaderLM-v2</code> 較其前代產品有了重大突破，特別是在處理長文本內容和生成 markdown 語法方面。雖然第一代將 HTML 轉 markdown 的轉換視為<a href=\"https://jina.ai/news/reader-lm-small-language-models-for-cleaning-and-converting-html-to-markdown/?ref=jina-ai-gmbh.ghost.io#:~:text=primarily%20needs%20to-,selective%2Dcopy,-from%20the%20input\">「選擇性複製」任務</a>，但<strong>v2 將其視為真正的翻譯過程</strong>。這種轉變使模型能夠熟練地運用 markdown 語法，尤其擅長<strong>生成程式碼區塊、巢狀列表、表格和 LaTex 方程式</strong>等複雜元素。</p><figure class=\"kg-card kg-video-card kg-width-regular kg-card-hascaption\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2025/01/Heading--1500-x-800-px---1500-x-1000-px-_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2025/01/Heading--1500-x-800-px---1500-x-1000-px-.mp4\" poster=\"https://img.spacergif.org/v1/1500x1000/0a/spacer.png\" width=\"1500\" height=\"1000\" loop=\"\" autoplay=\"\" muted=\"\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2025/01/Heading--1500-x-800-px---1500-x-1000-px-_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Play video\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container kg-video-hide\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Play video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Pause video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:21</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Adjust playback speed\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Unmute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Mute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            <figcaption><p><span style=\"white-space: pre-wrap;\">比較 ReaderLM v2、ReaderLM 1.5b、Claude 3.5 Sonnet 和 Gemini 2.0 Flash 在將 HackerNews 首頁轉換為 markdown 的結果，展示了 ReaderLM v2 獨特的風格和性能。ReaderLM v2 擅長保留原始 HTML 中的全面資訊，包括 HackerNews 原始連結，同時使用 markdown 語法巧妙地組織內容。該模型使用巢狀列表來組織本地元素（積分、時間戳和評論），同時透過適當的標題層次結構（h1 和 h2 標籤）維持一致的全局格式。</span></p></figcaption>\n        </figure><p>我們第一版的一個主要挑戰是在生成長序列後出現<a href=\"https://jina.ai/news/reader-lm-small-language-models-for-cleaning-and-converting-html-to-markdown/?ref=jina-ai-gmbh.ghost.io#degeneration-and-dull-loops\"><strong>退化</strong></a>現象，特別是重複和循環的形式。模型要麼開始重複相同的 token，要麼陷入循環，在達到最大輸出長度之前重複循環一小段 token 序列。<code>ReaderLM-v2</code> 透過在訓練過程中加入對比損失大大緩解了這個問題——無論上下文長度或已生成的 token 數量如何，其性能都保持一致。</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--1500-x-800-px---1500-x-1000-px---6-.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"1500\" height=\"1000\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/Heading--1500-x-800-px---1500-x-1000-px---6-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/Heading--1500-x-800-px---1500-x-1000-px---6-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--1500-x-800-px---1500-x-1000-px---6-.png 1500w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\">我們透過將</span><a href=\"https://jina.ai/legal?ref=jina-ai-gmbh.ghost.io\" rel=\"noreferrer\"><span style=\"white-space: pre-wrap;\">我們的法律頁面</span></a><span style=\"white-space: pre-wrap;\">轉換為 markdown 來測試 ReaderLM v2——這個頁面的長度大約是 HackerNews 首頁的 20 倍，包括頁面末尾的一個大型子處理器表格。儘管面臨這個巨大的挑戰，ReaderLM v2 仍成功地以 markdown 格式生成了完整的表格，同時在整個文件中保持一致的結構，即使在表格之後也保持了標題層次和列表格式。這種水平的性能是前一代</span><code spellcheck=\"false\" style=\"white-space: pre-wrap;\"><span>reader-lm-1.5b</span></code><span style=\"white-space: pre-wrap;\">所無法達到的，因為它在生成長序列後會出現退化現象。</span></figcaption></figure><p>除了 markdown 轉換，<code>ReaderLM-v2</code> 還引入了<strong>直接 HTML 轉 JSON 生成</strong>功能，允許使用者按照給定的 JSON schema 從原始 HTML 中提取特定資訊。這種端到端的方法消除了在許多 LLM 驅動的資料清理和提取管道中常見的中間 markdown 轉換需求。</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--1500-x-800-px---1500-x-1000-px---9-.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"1500\" height=\"1000\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/Heading--1500-x-800-px---1500-x-1000-px---9-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/Heading--1500-x-800-px---1500-x-1000-px---9-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--1500-x-800-px---1500-x-1000-px---9-.png 1500w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\">在這個範例中，我們向 ReaderLM v2 提供了來自 HackerNews 首頁的原始 HTML，以及一個指定了討論主題標題、URL、摘要、關鍵字、作者和評論數的 JSON schema。雖然某些欄位可以直接從 HTML 中獲取，其他欄位（如關鍵字）則需要從內容中推導出來。ReaderLM v2 成功地以驚人的準確度提取和生成了所有欄位。</span></figcaption></figure><p>在定量和定性基準測試中，<code>ReaderLM-v2</code> 在 HTML 轉 Markdown 的任務上優於像 <code>Qwen2.5-32B-Instruct</code>、<code>Gemini2-flash-expr</code> 和 <code>GPT-4o-2024-08-06</code> 等更大的模型，同時在 HTML 轉 JSON 提取任務上展現出相當的性能，而且使用的參數數量顯著較少。</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/HTML2Markdown.svg\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"709\" height=\"371\"><figcaption><code spellcheck=\"false\" style=\"white-space: pre-wrap;\"><span>ReaderLM-v2-pro</span></code><span style=\"white-space: pre-wrap;\"> 是專門為我們的企業客戶保留的高級版本，具有額外的訓練和優化。</span></figcaption></figure><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/Instructed-HTML2Markdown.svg\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"709\" height=\"371\"></figure><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/HTML2JSON.svg\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"709\" height=\"371\"></figure><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/Qualitative-Evaluation--2-.svg\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"709\" height=\"620\"><figcaption><span style=\"white-space: pre-wrap;\">我們的人工評估涵蓋了 10 個不同的 HTML 來源，包括英文、日文和中文的新聞文章、部落格文章、產品登陸頁面、電子商務網站和法律文件。測試內容包含了具有挑戰性的元素，如多行表格、動態佈局、連結表格、數學公式（行內和獨立顯示）、程式碼區塊和深度巢狀列表。定性評估集中在三個關鍵面向，模型評分從 1（最低）到 5（最高）。然後將分數標準化為每個方面最高 1.0，以便更容易比較。</span></figcaption></figure><p>這些結果證明，一個設計良好的 1.5B 參數模型不僅可以匹配，而且經常能夠在結構化數據提取任務中超越更大的模型。從 <code>ReaderLM-v2</code> 到 <code>ReaderLM-v2-pro</code> 的持續改進，展示了我們新訓練策略在提高模型性能的同時保持計算效率方面的有效性。</p><h2 id=\"get-started\">開始使用</h2><h3 id=\"via-reader-api\">透過 Reader API</h3><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://jina.ai/reader/?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">Reader API</div><div class=\"kg-bookmark-description\">Read URLs and search web for better grounding LLMs.</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-128x128-17.png\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/banner-reader-api-1.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><p><code>ReaderLM-v2</code> 現已整合到我們的 Reader API 中。要使用它，只需在請求標頭中指定 <code>x-engine: readerlm-v2</code>，並使用 <code>-H 'Accept: text/event-stream'</code> 啟用響應串流：</p><pre><code class=\"language-bash\">curl https://r.jina.ai/https://news.ycombinator.com/ -H 'x-engine: readerlm-v2' -H 'Accept: text/event-stream'\n</code></pre><p>您可以在較低的速率限制下無需 API 金鑰即可試用。<a href=\"https://jina.ai/contact-sales?ref=jina-ai-gmbh.ghost.io#rate-limit\">若需更高的速率限制</a>，您可以購買 API 金鑰。<strong>請注意，ReaderLM-v2 請求會從您的 API 金鑰中消耗正常 token 數量的 3 倍。</strong>此功能目前處於測試階段，我們正在與 GCP 團隊合作優化 GPU 效率並提高模型可用性。</p><h3 id=\"on-google-colab\">在 Google Colab 上</h3><figure class=\"kg-card kg-bookmark-card kg-card-hascaption\"><a class=\"kg-bookmark-container\" href=\"https://colab.research.google.com/drive/1FfPjZwkMSocOLsEYH45B3B4NxDryKLGI?usp=sharing&ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">Google Colab</div><div class=\"kg-bookmark-description\"></div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-22.ico\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/colab_favicon_256px-6.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a><figcaption><p dir=\"ltr\"><span style=\"white-space: pre-wrap;\">請注意，免費的 T4 GPU 有限制—它不支援 </span><code spellcheck=\"false\" style=\"white-space: pre-wrap;\"><span>bfloat16</span></code><span style=\"white-space: pre-wrap;\"> 或 flash attention 2，這導致更高的內存使用量和較慢的長輸入處理速度。儘管如此，ReaderLM v2 在這些限制下仍能成功處理我們的整個法律頁面，達到 67 tokens/s 的輸入速度和 36 tokens/s 的輸出速度。對於生產用途，我們建議使用 RTX 3090/4090 以獲得最佳性能。</span></p></figcaption></figure><p>在託管環境中試用 <code>ReaderLM-v2</code> 最簡單的方式是透過我們的 Colab notebook，它展示了使用 HackerNews 首頁作為範例的 HTML 轉 Markdown 轉換、JSON 提取和指令跟隨功能。該 notebook 針對 Colab 的免費 T4 GPU 等級進行了優化，並需要 <code>vllm</code> 和 <code>triton</code> 來加速和運行。歡迎使用任何網站進行測試。</p><h4 id=\"html-to-markdown-conversion\">HTML 轉 Markdown 轉換</h4><p>您可以使用 <code>create_prompt</code> 輔助函數輕鬆創建用於將 HTML 轉換為 Markdown 的提示：</p><pre><code class=\"language-python\">prompt = create_prompt(html)\nresult = llm.generate(prompt, sampling_params=sampling_params)[0].outputs[0].text.strip()</code></pre><p><code>result</code> 將是一個用 Markdown 反引號代碼圍欄包裹的字串。您也可以覆蓋默認設置來探索不同的輸出，例如：</p><pre><code class=\"language-python\">prompt = create_prompt(html, instruction=\"Extract the first three news and put into in the makdown list\")\nresult = llm.generate(prompt, sampling_params=sampling_params)[0].outputs[0].text.strip()</code></pre><p>然而，由於我們的訓練數據可能無法涵蓋每種類型的指令，特別是需要多步驟推理的任務，最可靠的結果來自 HTML 轉 Markdown 轉換。為了最有效的信息提取，我們建議使用如下所示的 JSON schema：</p><h4 id=\"html-to-json-extraction-with-json-schema\">使用 JSON schema 進行 HTML 到 JSON 的提取</h4><pre><code class=\"language-python\">import json\n\nschema = {\n    \"type\": \"object\",\n    \"properties\": {\n        \"title\": {\"type\": \"string\", \"description\": \"News thread title\"},\n        \"url\": {\"type\": \"string\", \"description\": \"Thread URL\"},\n        \"summary\": {\"type\": \"string\", \"description\": \"Article summary\"},\n        \"keywords\": {\"type\": \"list\", \"description\": \"Descriptive keywords\"},\n        \"author\": {\"type\": \"string\", \"description\": \"Thread author\"},\n        \"comments\": {\"type\": \"integer\", \"description\": \"Comment count\"}\n    },\n    \"required\": [\"title\", \"url\", \"date\", \"points\", \"author\", \"comments\"]\n}\n\nprompt = create_prompt(html, schema=json.dumps(schema, indent=2))\nresult = llm.generate(prompt, sampling_params=sampling_params)[0].outputs[0].text.strip()\n</code></pre><p><code>result</code> 將是一個用 JSON 格式的代碼圍欄反引號包裹的字串，而不是實際的 JSON/dict 對象。您可以使用 Python 將該字串解析為適當的字典或 JSON 對象以進行進一步處理。</p><h3 id=\"in-production-available-on-csp\">生產環境：可在 CSP 上使用</h3><p><code>ReaderLM-v2</code> 可在 AWS SageMaker、Azure 和 GCP marketplace 上使用。如果您需要在這些平台之外或在公司內部使用這些模型，請注意該模型和 <code>ReaderLM-v2-pro</code> 都是在 CC BY-NC 4.0 許可下授權的。<a href=\"https://jina.ai/contact-sales/?ref=jina-ai-gmbh.ghost.io\" rel=\"noreferrer\">如需商業使用諮詢或獲取 <code>ReaderLM-v2-pro</code> 的訪問權限，請隨時聯繫我們。</a></p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://aws.amazon.com/marketplace/pp/prodview-jwfct4j4rvxk2?sr=0-21&ref_=beagle&applicationId=AWSMPContessa&ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">AWS Marketplace: Reader-LM v2</div><div class=\"kg-bookmark-description\"></div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-23.ico\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/socialPreview-3.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><h2 id=\"quantitative-evaluation\">定量評估</h2><p>我們針對三個結構化資料抽取任務，將 ReaderLM-v2 與最先進的模型進行評估比較：<code>GPT-4o-2024-08-06</code>、<code>Gemini2-flash-expr</code> 和 <code>Qwen2.5-32B-Instruct</code>。我們的評估框架結合了測量內容準確度和結構忠實度的指標。<code>ReaderLM-v2</code> 是開放權重的公開版本，而 <code>ReaderLM-v2-pro</code> 是僅供企業客戶使用的專屬高級版本，具有額外的訓練和優化。請注意，我們的第一代 <code>reader-lm-1.5b</code> 僅針對主要內容抽取任務進行評估，因為它不支援指令式抽取或 JSON 抽取功能。</p><h3 id=\"evaluation-metrics\">評估指標</h3><p>對於 HTML 轉 Markdown 的任務，我們採用七個互補的指標。注意：↑ 表示數值越高越好，↓ 表示數值越低越好</p><ul><li><strong>ROUGE-L</strong>（↑）：測量生成文本與參考文本之間的最長公共子序列，體現內容保留和結構相似度。範圍：0-1，數值越高表示序列匹配度越好。</li><li><strong>WER（詞錯誤率）</strong>（↓）：量化將生成文本轉換為參考文本所需的最小詞級編輯次數。數值越低表示所需修正越少。</li><li><strong>SUB（替換）</strong>（↓）：計算所需的詞替換次數。數值越低表示詞級準確度越高。</li><li><strong>INS（插入）</strong>（↓）：測量需要插入多少詞才能匹配參考文本。數值越低表示完整度越高。</li><li><strong>Levenshtein 距離</strong>（↓）：計算所需的最小字符級編輯次數。數值越低表示字符級準確度越高。</li><li><strong>Damerau-Levenshtein 距離</strong>（↓）：類似 Levenshtein 但也考慮字符換位。數值越低表示字符級匹配度越高。</li><li><strong>Jaro-Winkler 相似度</strong>（↑）：特別強調字符串開頭的匹配，對評估文檔結構保留特別有用。範圍：0-1，數值越高表示相似度越高。</li></ul><p>對於 HTML 轉 JSON 的任務，我們將其視為檢索任務，採用以下四個資訊檢索指標：</p><ul><li><strong>F1 分數</strong>（↑）：精確率和召回率的調和平均數，提供整體準確度。範圍：0-1。</li><li><strong>精確率</strong>（↑）：所有抽取資訊中正確抽取的比例。範圍：0-1。</li><li><strong>召回率</strong>（↑）：從所有可用資訊中正確抽取的比例。範圍：0-1。</li><li><strong>通過率</strong>（↑）：符合 JSON 格式和結構規範的輸出比例。範圍：0-1。</li></ul><h3 id=\"main-content-html-to-markdown-task\">主要內容 HTML 轉 Markdown 任務</h3>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th>Model</th>\n<th>ROUGE-L↑</th>\n<th>WER↓</th>\n<th>SUB↓</th>\n<th>INS↓</th>\n<th>Levenshtein↓</th>\n<th>Damerau↓</th>\n<th>Jaro-Winkler↑</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Gemini2-flash-expr</td>\n<td>0.69</td>\n<td>0.62</td>\n<td>131.06</td>\n<td>372.34</td>\n<td>0.40</td>\n<td>1341.14</td>\n<td>0.74</td>\n</tr>\n<tr>\n<td>gpt-4o-2024-08-06</td>\n<td>0.69</td>\n<td>0.41</td>\n<td><strong>88.66</strong></td>\n<td><strong>88.69</strong></td>\n<td>0.40</td>\n<td>1283.54</td>\n<td>0.75</td>\n</tr>\n<tr>\n<td>Qwen2.5-32B-Instruct</td>\n<td>0.71</td>\n<td>0.47</td>\n<td>158.26</td>\n<td>123.47</td>\n<td>0.41</td>\n<td>1354.33</td>\n<td>0.70</td>\n</tr>\n<tr>\n<td>reader-lm-1.5b</td>\n<td>0.72</td>\n<td>1.14</td>\n<td>260.29</td>\n<td>1182.97</td>\n<td>0.35</td>\n<td>1733.11</td>\n<td>0.70</td>\n</tr>\n<tr>\n<td>ReaderLM-v2</td>\n<td>0.84</td>\n<td>0.62</td>\n<td>135.28</td>\n<td>867.14</td>\n<td>0.22</td>\n<td>1262.75</td>\n<td>0.82</td>\n</tr>\n<tr>\n<td>ReaderLM-v2-pro</td>\n<td><strong>0.86</strong></td>\n<td><strong>0.39</strong></td>\n<td>162.92</td>\n<td>500.44</td>\n<td><strong>0.20</strong></td>\n<td><strong>928.15</strong></td>\n<td><strong>0.83</strong></td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<h3 id=\"instructed-html-to-markdown-task\">指令式 HTML 轉 Markdown 任務</h3>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th>Model</th>\n<th>ROUGE-L↑</th>\n<th>WER↓</th>\n<th>SUB↓</th>\n<th>INS↓</th>\n<th>Levenshtein↓</th>\n<th>Damerau↓</th>\n<th>Jaro-Winkler↑</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Gemini2-flash-expr</td>\n<td>0.64</td>\n<td>1.64</td>\n<td>122.64</td>\n<td>533.12</td>\n<td>0.45</td>\n<td>766.62</td>\n<td>0.70</td>\n</tr>\n<tr>\n<td>gpt-4o-2024-08-06</td>\n<td>0.69</td>\n<td><strong>0.82</strong></td>\n<td><strong>87.53</strong></td>\n<td><strong>180.61</strong></td>\n<td>0.42</td>\n<td><strong>451.10</strong></td>\n<td>0.69</td>\n</tr>\n<tr>\n<td>Qwen2.5-32B-Instruct</td>\n<td>0.68</td>\n<td>0.73</td>\n<td>98.72</td>\n<td>177.23</td>\n<td>0.43</td>\n<td>501.50</td>\n<td>0.69</td>\n</tr>\n<tr>\n<td>ReaderLM-v2</td>\n<td>0.70</td>\n<td>1.28</td>\n<td>75.10</td>\n<td>443.70</td>\n<td>0.38</td>\n<td>673.62</td>\n<td><strong>0.75</strong></td>\n</tr>\n<tr>\n<td>ReaderLM-v2-pro</td>\n<td><strong>0.72</strong></td>\n<td>1.48</td>\n<td><strong>70.16</strong></td>\n<td>570.38</td>\n<td><strong>0.37</strong></td>\n<td>748.10</td>\n<td><strong>0.75</strong></td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<h3 id=\"schema-based-html-to-json-task\">基於 Schema 的 HTML 轉 JSON 任務</h3>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th>Model</th>\n<th>F1↑</th>\n<th>Precision↑</th>\n<th>Recall↑</th>\n<th>Pass-Rate↑</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Gemini2-flash-expr</td>\n<td>0.81</td>\n<td>0.81</td>\n<td>0.82</td>\n<td>0.99</td>\n</tr>\n<tr>\n<td>gpt-4o-2024-08-06</td>\n<td><strong>0.83</strong></td>\n<td>0.84</td>\n<td><strong>0.83</strong></td>\n<td><strong>1.00</strong></td>\n</tr>\n<tr>\n<td>Qwen2.5-32B-Instruct</td>\n<td><strong>0.83</strong></td>\n<td><strong>0.85</strong></td>\n<td><strong>0.83</strong></td>\n<td><strong>1.00</strong></td>\n</tr>\n<tr>\n<td>ReaderLM-v2</td>\n<td>0.81</td>\n<td>0.82</td>\n<td>0.81</td>\n<td>0.98</td>\n</tr>\n<tr>\n<td>ReaderLM-v2-pro</td>\n<td>0.82</td>\n<td>0.83</td>\n<td>0.82</td>\n<td>0.99</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<p><code>ReaderLM-v2</code> 在所有任務中都展現出顯著進步。在主要內容抽取方面，<code>ReaderLM-v2-pro</code> 在七個指標中的五個達到最佳表現，包括 ROUGE-L（0.86）、WER（0.39）、Levenshtein（0.20）、Damerau（928.15）和 Jaro-Winkler（0.83）分數。這些結果展示了相較於其基礎版本和更大規模模型，在內容保留和結構準確度方面都有全面提升。</p><p>在指令式抽取方面，<code>ReaderLM-v2</code> 和 <code>ReaderLM-v2-pro</code> 在 ROUGE-L（0.72）、替換率（70.16）、Levenshtein 距離（0.37）以及 Jaro-Winkler 相似度（0.75，與基礎版本並列）方面領先。雖然 GPT-4o 在 WER 和 Damerau 距離方面具有優勢，但 <code>ReaderLM-v2-pro</code> 在整體內容結構和準確度方面維持更佳表現。在 JSON 抽取方面，該模型表現具有競爭力，F1 分數與更大規模模型的差距僅在 0.01-0.02 之間，同時保持高通過率（0.99）。</p><h2 id=\"qualitative-evaluation\">定性評估</h2><p>在我們的分析過程中在研究 <code>reader-lm-1.5b</code> 時，我們發現<a href=\"https://jina.ai/news/reader-lm-small-language-models-for-cleaning-and-converting-html-to-markdown/?ref=jina-ai-gmbh.ghost.io#qualitative-study\">單純依靠量化指標可能無法完全反映模型的效能</a>。數值評估有時無法反映感知品質——有些低分案例產生了視覺上令人滿意的 markdown，而高分案例卻產生次優結果。為了解決這個差異，我們對 10 個不同的 HTML 來源進行了系統性的質性評估，包括英文、日文和中文的新聞文章、部落格文章、產品頁面、電商網站和法律文件。測試語料強調了具有挑戰性的格式元素，如多列表格、動態版面、LaTeX 公式、鏈接表格和嵌套列表，這提供了對模型實際應用能力更全面的視角。</p><h3 id=\"evaluation-metrics-1\">評估指標</h3><p>我們的人工評估聚焦於三個關鍵維度，使用 1-5 分進行評分：</p><p><strong>內容完整性</strong> - 評估 HTML 轉 markdown 過程中語意資訊的保留，包括：</p><ul><li>文字內容的準確性和完整性</li><li>連結、圖片、程式碼區塊、公式和引用的保留</li><li>文字格式和連結/圖片 URL 的保留</li></ul><p><strong>結構準確性</strong> - 評估 HTML 結構元素轉換為 Markdown 的準確度：</p><ul><li>標題層級的保留</li><li>列表巢狀結構的準確性</li><li>表格結構的忠實度</li><li>程式碼區塊和引用的格式</li></ul><p><strong>格式合規性</strong> - 衡量對 Markdown 語法標準的遵循程度：</p><ul><li>標題（#）、列表（*、+、-）、表格、程式碼區塊（```）等的正確語法使用</li><li>無多餘空格或非標準語法的乾淨格式</li><li>一致且可讀的渲染輸出</li></ul><p>在我們手動評估超過 10 個 HTML 頁面時，每個評估標準的最高分為 50 分。<code>ReaderLM-v2</code> 在所有維度都展現出優異的表現：</p>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th>Metric</th>\n<th>Content Integrity</th>\n<th>Structural Accuracy</th>\n<th>Format Compliance</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>reader-lm-v2</td>\n<td>39</td>\n<td>35</td>\n<td>36</td>\n</tr>\n<tr>\n<td>reader-lm-v2-pro</td>\n<td>35</td>\n<td>37</td>\n<td>37</td>\n</tr>\n<tr>\n<td>reader-lm-v1</td>\n<td>35</td>\n<td>34</td>\n<td>31</td>\n</tr>\n<tr>\n<td>Claude 3.5 Sonnet</td>\n<td>26</td>\n<td>31</td>\n<td>33</td>\n</tr>\n<tr>\n<td>gemini-2.0-flash-expr</td>\n<td>35</td>\n<td>31</td>\n<td>28</td>\n</tr>\n<tr>\n<td>Qwen2.5-32B-Instruct</td>\n<td>32</td>\n<td>33</td>\n<td>34</td>\n</tr>\n<tr>\n<td>gpt-4o</td>\n<td>38</td>\n<td>41</td>\n<td>42</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<p>在內容完整性方面，它在複雜元素識別上表現出色，尤其是 LaTeX 公式、巢狀列表和程式碼區塊。在處理複雜內容結構時，本模型保持了高度忠實度，而競爭模型則經常出現丟失 H1 標題（<code>reader-lm-1.5b</code>）、截斷內容（Claude 3.5）或保留原始 HTML 標籤（Gemini-2.0-flash）等問題。</p><figure class=\"kg-card kg-gallery-card kg-width-wide kg-card-hascaption\"><div class=\"kg-gallery-container\"><div class=\"kg-gallery-row\"><div class=\"kg-gallery-image\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--92-.png\" width=\"2000\" height=\"1477\" loading=\"lazy\" alt=\"\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image--92-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image--92-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2025/01/image--92-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/size/w2400/2025/01/image--92-.png 2400w\" sizes=\"(min-width: 720px) 720px\"></div><div class=\"kg-gallery-image\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--93--1.png\" width=\"2000\" height=\"1765\" loading=\"lazy\" alt=\"\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image--93--1.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image--93--1.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2025/01/image--93--1.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--93--1.png 2268w\" sizes=\"(min-width: 720px) 720px\"></div></div></div><figcaption><p dir=\"ltr\"><a href=\"https://iclr-blogposts.github.io/2024/blog/bench-hvp/?ref=jina-ai-gmbh.ghost.io\"><span style=\"white-space: pre-wrap;\">一篇 ICLR 部落格文章</span></a><span style=\"white-space: pre-wrap;\">，其中包含嵌入在 markdown 中的複雜 LaTeX 方程式，右側面板顯示了源 HTML 代碼。</span></p></figcaption></figure><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--94--2.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"2000\" height=\"1033\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image--94--2.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image--94--2.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2025/01/image--94--2.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/size/w2400/2025/01/image--94--2.png 2400w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\">對比展示 ReaderLM-v2 的 Markdown 輸出及其渲染效果。</span></figcaption></figure><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"2000\" height=\"821\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2025/01/image.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/size/w2400/2025/01/image.png 2400w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\">在 ReaderLM-v2 處理後，我們可以通過簡單的後處理步驟完美還原原始內容，包括將 LaTeX 方程式從 HTML 格式轉換為 Markdown 格式。例如，將 </span><code spellcheck=\"false\" style=\"white-space: pre-wrap;\"><span>\\[...\\]</span></code><span style=\"white-space: pre-wrap;\">（及其 HTML 等效項）替換為 Markdown 標準分隔符，如行內方程式使用 </span><code spellcheck=\"false\" style=\"white-space: pre-wrap;\"><span>$...$</span></code><span style=\"white-space: pre-wrap;\"> ，顯示方程式使用 </span><code spellcheck=\"false\" style=\"white-space: pre-wrap;\"><span>$$...$$</span></code><span style=\"white-space: pre-wrap;\">。這有助於防止 Markdown 解釋時的語法衝突。</span></figcaption></figure><p>在結構準確性方面，ReaderLM-v2 針對常見的網頁結構展現出優化效果。例如，在 Hacker News 的案例中，它成功重建了完整的連結並優化了列表呈現。該模型處理了 ReaderLM-v1 難以應對的複雜非部落格 HTML 結構。</p><p>在格式合規性方面，ReaderLM-v2 在處理 Hacker News、部落格和 WeChat 文章等內容時表現特別強勢。雖然其他大型語言模型在處理類 markdown 來源時表現良好，但在需要更多解釋和重新格式化的傳統網站上則遇到困難。</p><p>我們的分析顯示，<code>gpt-4o</code> 在處理較短的網站時表現出色，相較於其他模型，展現出對網站結構和格式更優越的理解能力。然而，在處理較長內容時，<code>gpt-4o</code> 在完整性方面遇到困難，經常遺漏文本開頭和結尾的部分。我們以 Zillow 網站為例，提供了 <code>gpt-4o</code>、ReaderLM-v2 和 ReaderLM-v2-pro 輸出的比較分析。</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image-1.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"2000\" height=\"1382\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image-1.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image-1.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2025/01/image-1.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/image-1.png 2356w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\">原始 Zillow HTML 頁面</span></figcaption></figure><figure class=\"kg-card kg-gallery-card kg-width-wide kg-card-hascaption\"><div class=\"kg-gallery-container\"><div class=\"kg-gallery-row\"><div class=\"kg-gallery-image\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--95-.png\" width=\"1400\" height=\"1576\" loading=\"lazy\" alt=\"\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image--95-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image--95-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--95-.png 1400w\" sizes=\"(min-width: 720px) 720px\"></div><div class=\"kg-gallery-image\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--96-.png\" width=\"1550\" height=\"1578\" loading=\"lazy\" alt=\"\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image--96-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image--96-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--96-.png 1550w\" sizes=\"(min-width: 720px) 720px\"></div><div class=\"kg-gallery-image\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--97-.png\" width=\"1562\" height=\"1582\" loading=\"lazy\" alt=\"\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/image--97-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/image--97-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/image--97-.png 1562w\" sizes=\"(min-width: 720px) 720px\"></div></div></div><figcaption><p dir=\"ltr\"><span style=\"white-space: pre-wrap;\">比較 gpt-4o（左）、ReaderLM-v2（中）和 ReaderLM-v2-pro（右）渲染的 Markdown 輸出結果。</span></p></figcaption></figure><p>對於某些具有挑戰性的案例，如產品著陸頁面和政府文件，ReaderLM-v2 和 ReaderLM-v2-pro 的表現依然穩健，但仍有改進空間。對於 ICLR 部落格文章中的複雜數學公式和程式碼，雖然大多數模型都面臨挑戰，但 ReaderLM-v2 比基準 Reader API 處理得更好。</p><h2 id=\"how-we-trained-readerlm-v2\">我們如何訓練 ReaderLM v2</h2><p>ReaderLM-v2 是基於 <code><strong>Qwen2.5-1.5B-Instruction</strong></code> 建構的，這是一個以指令遵循和長文本處理效率著稱的精簡基礎模型。在本節中，我們將描述如何訓練 <code>ReaderLM-v2</code>，重點關注資料準備、訓練方法以及我們遇到的挑戰。</p>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th>Model Parameter</th>\n<th>ReaderLM-v2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Total Parameters</td>\n<td>1.54B</td>\n</tr>\n<tr>\n<td>Max Context Length (Input+Output)</td>\n<td>512K</td>\n</tr>\n<tr>\n<td>Hidden Size</td>\n<td>1536</td>\n</tr>\n<tr>\n<td>Number of Layers</td>\n<td>28</td>\n</tr>\n<tr>\n<td>Query Heads</td>\n<td>12</td>\n</tr>\n<tr>\n<td>KV Heads</td>\n<td>2</td>\n</tr>\n<tr>\n<td>Head Size</td>\n<td>128</td>\n</tr>\n<tr>\n<td>Intermediate Size</td>\n<td>8960</td>\n</tr>\n<tr>\n<td>Multilingual Support</td>\n<td>29 languages</td>\n</tr>\n<tr>\n<td>HuggingFace Repository</td>\n<td>Link</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<h3 id=\"data-preparation\">資料準備</h3><p>ReaderLM-v2 的成功很大程度上取決於其訓練資料的品質。我們創建了 <code>html-markdown-1m</code> 資料集，其中包含了從網際網路收集的一百萬份 HTML 文件。平均每份文件包含 56,000 個 token，反映了真實網路資料的長度和複雜性。在準備這個資料集時，我們清理了 HTML 文件，移除了不必要的元素（如 JavaScript 和 CSS），同時保留關鍵的結構和語義元素。清理後，我們使用 <a href=\"https://jina.ai/reader?ref=jina-ai-gmbh.ghost.io\">Jina Reader</a> 通過正則表達式模式和啟發式方法將 HTML 文件轉換為 Markdown。</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--76-.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"1200\" height=\"630\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/Heading--76-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/Heading--76-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--76-.png 1200w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\"><code>html-markdown-1m</code> 資料集中 HTML 文件的 token 長度直方圖</span></figcaption></figure><p>雖然這建立了一個可用的基礎資料集，但它突顯了一個關鍵限制：<strong>僅僅用這些直接轉換訓練的模型本質上只會學會模仿 Jina Reader 使用的正則表達式模式和啟發式方法。</strong>這一點在 <code>reader-lm-0.5b/1.5b</code> 中變得明顯，其性能上限受到這些基於規則的轉換品質的限制。</p><p>為了解決這些限制，我們開發了一個依賴 <code>Qwen2.5-32B-Instruction</code> 模型的三步驟流程，這對於建立高品質的合成資料集至關重要。</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--73-.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"1200\" height=\"630\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/Heading--73-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/Heading--73-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--73-.png 1200w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\">ReaderLM-v2 的合成資料生成流程，由 </span><code>Qwen2.5-32B-Instruction</code><span style=\"white-space: pre-wrap;\"> 驅動</span></figcaption></figure><ol><li><strong>起草</strong>：基於提供給模型的指令生成初始 Markdown 和 JSON 輸出。這些輸出雖然多樣化，但經常有噪音或不一致。</li><li><strong>優化</strong>：通過移除冗餘內容、強化結構一致性和對齊所需格式來改進生成的草稿。這一步驟確保資料乾淨且符合任務要求。</li><li><strong>評判</strong>：根據原始指令評估優化後的輸出。只有通過評估的資料才會被納入最終資料集。這種反覆的方法確保訓練資料達到結構化資料提取所需的品質標準。</li></ol><h3 id=\"training-process\">訓練過程</h3><p>我們的訓練過程包含多個階段，專門針對處理長文本文件的挑戰。</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--75-.png\" class=\"kg-image\" alt=\"\" loading=\"lazy\" width=\"1200\" height=\"630\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2025/01/Heading--75-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2025/01/Heading--75-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2025/01/Heading--75-.png 1200w\" sizes=\"(min-width: 720px) 720px\"><figcaption><span style=\"white-space: pre-wrap;\">ReaderLM v2 的訓練遵循一個反覆過程，結合三階段資料生成（起草-優化-評判）與自我對弈優化，實現持續改進。</span></figcaption></figure><p>我們首先進行<strong>長文本預訓練</strong>，使用 <code>html-markdown-1m</code> 資料集。我們使用了環狀鋸齒注意力（ring-zag attention）和旋轉位置編碼（RoPE）等技術，逐步將模型的文本長度從 32,768 個 token 擴展到 256,000 個 token。為了維持穩定性和效率，我們採用了漸進式訓練方法，從較短序列開始，逐步增加文本長度。</p><p>預訓練之後，我們進行了<strong>監督式微調（SFT）</strong>。這個階段使用了在資料準備過程中生成的優化資料集。這些資料集包含了 Markdown 和 JSON 提取任務的詳細指令，以及草稿優化的範例。每個資料集都經過精心設計，以幫助模型學習特定任務，如識別主要內容或遵循基於模式的 JSON 結構。</p><p>接著，我們應用了<strong>直接偏好優化（DPO）</strong>來使模型的輸出與高品質結果一致。在這個階段，模型基於草稿和優化後的回應對進行訓練。通過學習優先選擇優化後的輸出，模型內化了定義精煉和任務專門結果的細微區別。</p><p>最後，我們實施了<strong>自我對弈強化訓練</strong>，這是一個模型生成、優化和評估自己輸出的反覆過程。這個循環使模型能夠不需要額外外部監督就持續改進。通過利用自己的評判和優化，模型逐步提升了產生精確和結構化輸出的能力。</p><h2 id=\"conclusion\">結論</h2><p>在 2024 年 4 月，Jina Reader 成為第一個對 LLM 友好的 markdown API。它開創了新趨勢，贏得廣泛的社群採用，最重要的是，啟發我們建立用於資料清理和提取的小型語言模型。今天，我們再次提升標準，推出 ReaderLM-v2，實現了去年九月的承諾：更好的長文本處理、支援輸入指令，以及將特定網頁內容提取為 markdown 格式的能力。我們再次證明，通過細心的訓練和校準，小型語言模型可以達到超越大型模型的最先進性能。</p><p>在 ReaderLM-v2 的訓練過程中，我們發現了兩個見解。一個有效的策略是在針對特定任務定製的獨立資料集上訓練專門模型。這些任務專門模型後來通過線性參數插值進行<em>合併</em>。雖然這種方法需要額外的努力，但它有助於在最終統一系統中保留每個專門模型的獨特優勢。</p><p>反覆的資料合成過程對我們模型的成功至關重要。透過對合成資料的重複改進和評估，我們大幅提升了模型效能，超越了簡單的規則導向方法。這種反覆策略雖然在維持一致的評估標準和管理運算成本方面帶來挑戰，但對於突破使用 Jina Reader 正則表達式和啟發式訓練資料的限制來說是不可或缺的。這一點從高度依賴 Jina Reader 規則導向轉換的 <code>reader-lm-1.5b</code> 與受益於此反覆改進過程的 <code>ReaderLM-v2</code> 之間的效能差距可以清楚看出。</p><p>我們很期待聽到關於 ReaderLM-v2 如何改善您的資料品質的回饋。展望未來，我們計劃擴展多模態功能，特別是針對掃描文件，並進一步優化生成速度。如果您對針對特定領域客製化的 ReaderLM 版本感興趣，請隨時與我們聯繫。</p>",
  "comment_id": "6785bfd62defad0001fb5f22",
  "feature_image": "https://jina-ai-gmbh.ghost.io/content/images/2025/01/readerlm-v2.png",
  "featured": true,
  "visibility": "public",
  "created_at": "2025-01-14T02:37:26.000+01:00",
  "updated_at": "2025-01-15T11:35:18.000+01:00",
  "published_at": "2025-01-15T11:35:18.000+01:00",
  "custom_excerpt": "ReaderLM-v2 is a 1.5B small language model for HTML-to-Markdown conversion and HTML-to-JSON extraction with exceptional accuracy.",
  "codeinjection_head": null,
  "codeinjection_foot": null,
  "custom_template": null,
  "canonical_url": null,
  "authors": [
    {
      "id": "62e3d0ef9cd5ce003d5e49e2",
      "name": "Jina AI",
      "slug": "company",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/08/Jjqb-JeY_400x400.jpg",
      "cover_image": null,
      "bio": "Creator of neural search, contributor to open source.",
      "website": "https://www.jina.ai",
      "location": "Berlin",
      "facebook": null,
      "twitter": "@JinaAI_",
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/company/"
    }
  ],
  "tags": [
    {
      "id": "655b2782bb728c000101bed7",
      "name": "Press",
      "slug": "press",
      "description": null,
      "feature_image": null,
      "visibility": "public",
      "og_image": null,
      "og_title": null,
      "og_description": null,
      "twitter_image": null,
      "twitter_title": null,
      "twitter_description": null,
      "meta_title": null,
      "meta_description": null,
      "codeinjection_head": null,
      "codeinjection_foot": null,
      "canonical_url": null,
      "accent_color": null,
      "url": "https://jina-ai-gmbh.ghost.io/tag/press/"
    }
  ],
  "primary_author": {
    "id": "62e3d0ef9cd5ce003d5e49e2",
    "name": "Jina AI",
    "slug": "company",
    "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/08/Jjqb-JeY_400x400.jpg",
    "cover_image": null,
    "bio": "Creator of neural search, contributor to open source.",
    "website": "https://www.jina.ai",
    "location": "Berlin",
    "facebook": null,
    "twitter": "@JinaAI_",
    "meta_title": null,
    "meta_description": null,
    "url": "https://jina-ai-gmbh.ghost.io/author/company/"
  },
  "primary_tag": {
    "id": "655b2782bb728c000101bed7",
    "name": "Press",
    "slug": "press",
    "description": null,
    "feature_image": null,
    "visibility": "public",
    "og_image": null,
    "og_title": null,
    "og_description": null,
    "twitter_image": null,
    "twitter_title": null,
    "twitter_description": null,
    "meta_title": null,
    "meta_description": null,
    "codeinjection_head": null,
    "codeinjection_foot": null,
    "canonical_url": null,
    "accent_color": null,
    "url": "https://jina-ai-gmbh.ghost.io/tag/press/"
  },
  "url": "https://jina-ai-gmbh.ghost.io/podcast/readerlm-v2-frontier-small-language-model-for-html-to-markdown-and-json/",
  "excerpt": "ReaderLM-v2 是一個擁有 15 億參數的小型語言模型，專門用於 HTML 轉 Markdown 轉換和 HTML 轉 JSON 提取，具有卓越的準確性。",
  "reading_time": 16,
  "access": true,
  "comments": false,
  "og_image": null,
  "og_title": null,
  "og_description": null,
  "twitter_image": null,
  "twitter_title": null,
  "twitter_description": null,
  "meta_title": null,
  "meta_description": null,
  "email_subject": null,
  "frontmatter": null,
  "feature_image_alt": null,
  "feature_image_caption": null
}