{
  "slug": "having-it-both-ways-combining-bm25-with-ai-reranking",
  "id": "6628fe61da339c00015740b9",
  "uuid": "13ce7c1f-bcdf-4746-93dd-5095291a2ed8",
  "title": "BM25 と AI リランキングの併用：両方の良いとこ取り",
  "html": "<p>新しい情報検索技術に対応することは重要ですが、すでに実績があり、ビジネス価値を実証済みのコンポーネントを壊さないことも同様に重要です。</p><p><a href=\"https://jina.ai/news/maximizing-search-relevancy-and-rag-accuracy-with-jina-reranker?ref=jina-ai-gmbh.ghost.io\">AI 駆動のベクトル検索</a>が成長しているにもかかわらず、実際には多くの企業が従来の検索技術に依存しており、多くの場合 <a href=\"https://en.wikipedia.org/wiki/Okapi_BM25?ref=jina-ai-gmbh.ghost.io\">BM25 アルゴリズム</a>の変種を使用しています。これは信頼性が高く、実績のある技術です。完全に新しいシステムへの移行は大きなステップであるだけでなく、多くの場合、相当なリソースと運用の全面的な見直しを必要とするため、実用的ではありません。さらに、BM25 は Elasticsearch や Solr などの広く普及している検索エンジンプラットフォームで一般的に使用される字句検索エンジンの基礎となっています。多くのユースケースですでに強力な結果を提供しています。</p><p>そのため、AI ベースの検索が<a href=\"https://db-engines.com/en/ranking_trend?ref=jina-ai-gmbh.ghost.io\" rel=\"noreferrer\">ユーザー満足度と結果の品質を大幅に向上させる</a>という説得力のある証拠があるにもかかわらず、多くの企業はニューラル検索への完全な移行をためらっています。</p><h2 id=\"retrieval-agnostic-neural-reranking\">検索方式に依存しないニューラルリランキング</h2><p>Reranker は検索システムの画期的な追加機能です。<a href=\"https://www.elastic.co/elasticsearch?ref=jina-ai-gmbh.ghost.io\">Elasticsearch</a> などの既存の検索エンジンを強化するように設計されており、提供される検索品質を改善するアドオンのように機能する追加レイヤーとして機能します。接続されている検索技術の種類を知る必要はなく、単にマッチのリストを受け取り、より良い順序に並べ替えます。</p><p>Jina Reranker は従来の検索技術にさらに深い理解を加えます。BM25 のようなアルゴリズムは用語の頻度に基づいてドキュメントを検索する点では優れていますが、ユーザーの意図に照らして検索したテキストの意味を評価することは苦手です。これは AI が得意とする分野です：Reranker はユーザーが探しているものにより合致した結果を生み出すのに役立ちます。</p><p>したがって、AI モデルの強力な利点を検索フレームワークにもたらしたい企業にとって、Jina Reranker を追加することは賢明な選択であり、既存の検索インフラを置き換える負担を伴いません。これは検索結果を単に許容可能なものではなく、より関連性が高く正確な、優れたものにする改善です。</p><h2 id=\"why-jina-reranker\">なぜ Jina Reranker なのか？</h2><p>リランカーモデルの中で、<a href=\"https://jina.ai/reranker?ref=jina-ai-gmbh.ghost.io\">Jina Reranker モデル</a>は<a href=\"https://jina.ai/news/maximizing-search-relevancy-and-rag-accuracy-with-jina-reranker/?ref=jina-ai-gmbh.ghost.io\">最先端</a>として、<a href=\"https://jina.ai/news/smaller-faster-cheaper-jina-rerankers-turbo-and-tiny?ref=jina-ai-gmbh.ghost.io\">パフォーマンスベンチマーク</a>でトップクラスのスコアを記録しています。</p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://jina.ai/news/maximizing-search-relevancy-and-rag-accuracy-with-jina-reranker/?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">Maximizing Search Relevance and RAG Accuracy with Jina Reranker</div><div class=\"kg-bookmark-description\">Boost your search and RAG accuracy with Jina Reranker. Our new model improves the accuracy and relevance by 20% over simple vector search. Try it now for free!</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina.ai/icons/favicon-128x128.png\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/02/Reranker1.png\" alt=\"\"></div></a></figure><p>この記事では、e コマースプラットフォーム向けのレコメンデーションシステムの実装方法をご紹介します。まず、BM25 リトリーバー単体のパフォーマンスを分析します。次に、検索パイプラインに Jina Reranker を追加し、結果がより関連性が高く効果的になる様子を見ていきます。</p><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\"><a href=\"https://colab.research.google.com/github/jina-ai/workshops/blob/main/notebooks/embeddings/bm25/Retrieval_Reranker.ipynb?ref=jina-ai-gmbh.ghost.io\">Colab</a> で実践するか、<a href=\"https://raw.githubusercontent.com/jina-ai/workshops/main/notebooks/embeddings/bm25/Retrieval_Reranker.ipynb?ref=jina-ai-gmbh.ghost.io\">ノートブックをダウンロード</a>して試すことができます。</div></div><h2 id=\"add-jina-reranker-to-your-existing-workflow\">既存のワークフローに Jina Reranker を追加する：</h2><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/04/upload_ead786ce675a16e1d2b30dcaf479c9f0.png\" class=\"kg-image\" alt=\"Screenshot 2024-04-08 at 11.44.21\" loading=\"lazy\" width=\"2000\" height=\"468\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/04/upload_ead786ce675a16e1d2b30dcaf479c9f0.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/04/upload_ead786ce675a16e1d2b30dcaf479c9f0.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/04/upload_ead786ce675a16e1d2b30dcaf479c9f0.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/04/upload_ead786ce675a16e1d2b30dcaf479c9f0.png 2000w\" sizes=\"(min-width: 720px) 720px\"></figure><p>Jina Reranker を統合した更新されたワークフローの内訳は以下の通りです：</p><ul><li><strong>初期検索</strong>：クエリが入力されると、BM25 検索エンジンはクエリ用語とドキュメントのマッチングに基づいて関連ドキュメントを検索します。</li><li><strong>リランキング</strong>：<code>jina-reranker-v1-base-en</code> はこれらの初期結果を受け取り、最先端の AI を使用してユーザーのクエリに照らして各検索ドキュメントの関連性を評価します。</li><li><strong>結果の返却</strong>：Jina Reranker は検索結果を並べ替え、最も関連性の高いドキュメントが上位に表示されるようにします。</li></ul><p>私たちの<a href=\"https://jina.ai/reranker?ref=jina-ai-gmbh.ghost.io\">使いやすい API</a> と包括的なドキュメントが、システムへの最小限の変更だけで、プロセス全体をガイドします。</p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://jina.ai/reranker/?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">Reranker API</div><div class=\"kg-bookmark-description\">Maximize the search relevancy and RAG accuracy at ease</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina.ai/icons/favicon-128x128.png\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina.ai/banner-reranker-api.png\" alt=\"\"></div></a></figure><h2 id=\"see-it-in-action-enhancing-e-commerce-search-with-jina-reranker\">実際の動作：Jina Reranker を使用した e コマース検索の強化</h2><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/04/upload_25d8f98d26cab1a5375a4f3d8ffa9278-1.jpeg\" class=\"kg-image\" alt=\"BM25+Rerank dark (1)\" loading=\"lazy\" width=\"1600\" height=\"900\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/04/upload_25d8f98d26cab1a5375a4f3d8ffa9278-1.jpeg 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/04/upload_25d8f98d26cab1a5375a4f3d8ffa9278-1.jpeg 1000w, https://jina-ai-gmbh.ghost.io/content/images/2024/04/upload_25d8f98d26cab1a5375a4f3d8ffa9278-1.jpeg 1600w\" sizes=\"(min-width: 720px) 720px\"><figcaption><i><em class=\"italic\" style=\"white-space: pre-wrap;\">クエリが BM25 を通過し、検索されたドキュメントは Jina Reranker によって改善されます。</em></i></figcaption></figure><p>実際の応用例として、e コマースの例を通じて Jina Reranker の効果を実証してみましょう。ここでの目標は、ユーザーのクエリに基づいて商品リストを検索することです。</p><p>これを示すために、人気のある AI 検索・オーケストレーションフレームワークである <a href=\"https://haystack.deepset.ai/?ref=jina-ai-gmbh.ghost.io\">Haystack by deepset</a> を使用して 2 つの検索パイプラインを設定します。最初のパイプラインは BM25 単独で使用します。2 つ目は BM25 システムに <code>jina-reranker-v1-base-en</code> を統合します。既存の Elasticsearch クラスターがある場合は、Haystack の <code>InMemoryDocumentStore</code> コンポーネントを <code>ElasticsearchDocumentStore</code> に簡単に置き換えて同じ実験を行うことができます。</p><p>Kaggle の<a href=\"https://www.kaggle.com/datasets/kuchhbhi/fashion-ecommerce-data?ref=jina-ai-gmbh.ghost.io\">サンプルデータセット</a>を使用します。CSV は<a href=\"https://raw.githubusercontent.com/jina-ai/workshops/main/notebooks/embeddings/bm25/fashion_data.csv?ref=jina-ai-gmbh.ghost.io\">ここ</a>から直接ダウンロードできます。この比較は、検索ワークフローに Jina Reranker を組み込むことによる改善を示しています。</p><p>まず、必要なコンポーネントをすべてインストールします：</p><pre><code class=\"language-bash\">pip install --q haystack-ai jina-haystack\n</code></pre><p>Jina API キーを環境変数として設定します。<a href=\"https://jina.ai/reranker?ref=jina-ai-gmbh.ghost.io\">ここ</a>で生成できます。</p><pre><code class=\"language-Python\">import os\nimport getpass\n\nos.environ[\"JINA_API_KEY\"] = getpass.getpass()\n</code></pre><p>商品名に基づいて商品を検索します。例：</p><pre><code class=\"language-Python\">short_query = \"Nightwear for Women\"\n</code></pre><p>各 CSV の行を <code>Document</code> に変換します：</p><pre><code class=\"language-Python\">import csv\nfrom haystack import Document\n\ndocuments = []\nwith open(\"fashion_data.csv\") as f:\n    data = csv.reader(f, delimiter=\";\")\n    for row in data:\n      row_text = ''.join(row)\n      row_doc = Document(content=row_text, meta={\"prod_id\": row[0], \"prod_image\": row[1]})\n      documents.append(row_doc)\n</code></pre><h2 id=\"pipeline-1-bm25-only\">パイプライン #1：BM25 のみ</h2><pre><code class=\"language-Python\">from haystack import Pipeline\nfrom haystack.document_stores.types import DuplicatePolicy\nfrom haystack.document_stores.in_memory import InMemoryDocumentStore\nfrom haystack.components.retrievers.in_memory import InMemoryBM25Retriever\n\ndocument_store=InMemoryDocumentStore()\ndocument_store.write_documents(documents=documents, policy=DuplicatePolicy.OVERWRITE)\n\nretriever = InMemoryBM25Retriever(document_store=document_store)\n\nrag_pipeline = Pipeline()\nrag_pipeline.add_component(\"retriever\", retriever)\n</code></pre><pre><code class=\"language-Python\">result = rag_pipeline.run(\n            {\n                \"retriever\": {\"query\": query, \"top_k\": 50},\n            }\n        )\n\nfor doc in result[\"retriever\"][\"documents\"]:\n    print(\"Product ID:\", doc.meta[\"prod_id\"])\n    print(\"Product Image:\", doc.meta[\"prod_image\"])\n    print(\"Score:\", doc.score)\n    print(\"-\"*100)\n</code></pre><p>BM25 によって返された 50 件の結果のサムネイルです：<br></p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/04/upload_f2dc26e35fe66ac84c1d641a47bebbce.png\" class=\"kg-image\" alt=\"image\" loading=\"lazy\" width=\"446\" height=\"1088\"></figure><p>結果はナイトウェアに関連しており、クエリと部分的に一致していますが、最も関連性の高い一致（グリッド内の太字の画像）が BM25 によって取得された多数の製品の中に埋もれてしまっているようです。実際には、BM25 のみを使用すると、ユーザーはページの上部で主に関連性のない結果を受け取ることになります。</p><h2 id=\"pipeline-2-bm25-jina-reranker\">パイプライン #2：BM25 + Jina Reranker</h2><p>以下のスクリプトは、このパイプラインを段階的に構築する方法を示しています：</p><pre><code class=\"language-Python\">from haystack_integrations.components.rankers.jina import JinaRanker\n\nranker_retriever = InMemoryBM25Retriever(document_store=document_store)\n\nranker = JinaRanker()\n\nranker_pipeline = Pipeline()\nranker_pipeline.add_component(\"ranker_retriever\", ranker_retriever)\nranker_pipeline.add_component(\"ranker\", ranker)\n\nranker_pipeline.connect(\"ranker_retriever.documents\", \"ranker.documents\")\n</code></pre><pre><code class=\"language-Python\">result = ranker_pipeline.run(\n            {\n                \"ranker_retriever\": {\"query\": query, \"top_k\": 50},\n                \"ranker\": {\"query\": query, \"top_k\": 10},\n            }\n        )\n\nfor doc in result[\"ranker\"][\"documents\"]:\n    print(\"Product ID:\", doc.meta[\"prod_id\"])\n    print(\"Product Image:\", doc.meta[\"prod_image\"])\n    print(\"Score:\", doc.score)\n    print(\"-\"*100)\n</code></pre><p>Jina Reranker が返した上位 10 件の結果です：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/04/upload_05929b0008a1ced2bf724dd8b89d0ec5.png\" class=\"kg-image\" alt=\"image\" loading=\"lazy\" width=\"442\" height=\"218\"></figure><p>BM25 と比較して、Jina Reranker はより関連性の高い回答のコレクションを返します。私たちの e コマースの設定では、これはより良いユーザーエクスペリエンスと購入の可能性の向上につながります。</p><h2 id=\"impact-of-integrating-jina-reranker-with-bm25\">Jina Reranker と BM25 の統合の影響</h2><p>e コマース領域での事例研究を通じて、Jina Reranker と Elasticsearch などの従来の検索エンジンの統合が検索技術において大きな飛躍をもたらすことが明らかになりました。この統合が検索体験を改善する方法の概要は以下の通りです：</p><ul><li><strong>ヒット率の向上</strong>：Jina Reranker と従来の検索の融合により、関連性のある結果の頻度が著しく向上しました。これにより、検索プロセスの精度が高まり、ユーザーのクエリにより密接に適合するようになりました。</li><li><strong>ユーザーエクスペリエンスの向上</strong>：検索結果の品質に明確な改善が見られます。これは、Jina Reranker と BM25 の組み合わせた機能が、ユーザーの特定のニーズにより適合し、全体的な検索体験を向上させていることを示しています。</li><li><strong>複雑なクエリに対する高精度</strong>：難しい検索に関しては、この相乗効果によりクエリと関連コンテンツの両方をより詳細に理解できます。これにより、より鋭く正確な結果が得られます。</li></ul><h2 id=\"ready-to-elevate-your-search-experience\">検索体験を向上させる準備はできていますか？</h2><p>Jina Reranker は、検索結果の関連性を高めるための理想的なソリューションです。既存の検索システムとシームレスに統合でき、最小限のコーディングで迅速に実装できます。</p><p>ここまでお読みいただいて興味を持たれた方、Jina Reranker がどのような違いをもたらすか確認したい方は、ぜひお試しください。<a href=\"https://jina.ai/?ref=jina-ai-gmbh.ghost.io\">Jina AI の Search Foundation モデル</a>の変革力を、ご自身の環境で体験してみてください。</p>",
  "comment_id": "6628fe61da339c00015740b9",
  "feature_image": "https://jina-ai-gmbh.ghost.io/content/images/2024/04/upload_56e4debd659c41d7b40a33256ccdce6c.jpeg",
  "featured": false,
  "visibility": "public",
  "created_at": "2024-04-24T14:43:13.000+02:00",
  "updated_at": "2024-07-08T21:11:33.000+02:00",
  "published_at": "2024-04-24T15:38:08.000+02:00",
  "custom_excerpt": "Learn how to integrate Jina Reranker with lexical search engines to take advantage of superior semantic understanding while avoiding the downsides of migrating to a fully-fledged vector search infrastructure.",
  "codeinjection_head": null,
  "codeinjection_foot": null,
  "custom_template": null,
  "canonical_url": null,
  "authors": [
    {
      "id": "6620de1e7f510100015da95e",
      "name": "Yuting Zhang",
      "slug": "yuting",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2024/04/Yuting-Portrait-1.jpeg",
      "cover_image": null,
      "bio": null,
      "website": null,
      "location": null,
      "facebook": null,
      "twitter": null,
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/yuting/"
    },
    {
      "id": "65e85e35b22368000152a4bf",
      "name": "Francesco Kruk",
      "slug": "francesco",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2024/03/Portrait-Picture_Low.jpg",
      "cover_image": null,
      "bio": null,
      "website": null,
      "location": null,
      "facebook": null,
      "twitter": null,
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/francesco/"
    }
  ],
  "tags": [
    {
      "id": "634a1a8ccebfc1003d8ab706",
      "name": "Tech Blog",
      "slug": "tech-blog",
      "description": null,
      "feature_image": null,
      "visibility": "public",
      "og_image": null,
      "og_title": null,
      "og_description": null,
      "twitter_image": null,
      "twitter_title": null,
      "twitter_description": null,
      "meta_title": null,
      "meta_description": null,
      "codeinjection_head": null,
      "codeinjection_foot": null,
      "canonical_url": null,
      "accent_color": null,
      "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
    }
  ],
  "primary_author": {
    "id": "6620de1e7f510100015da95e",
    "name": "Yuting Zhang",
    "slug": "yuting",
    "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2024/04/Yuting-Portrait-1.jpeg",
    "cover_image": null,
    "bio": null,
    "website": null,
    "location": null,
    "facebook": null,
    "twitter": null,
    "meta_title": null,
    "meta_description": null,
    "url": "https://jina-ai-gmbh.ghost.io/author/yuting/"
  },
  "primary_tag": {
    "id": "634a1a8ccebfc1003d8ab706",
    "name": "Tech Blog",
    "slug": "tech-blog",
    "description": null,
    "feature_image": null,
    "visibility": "public",
    "og_image": null,
    "og_title": null,
    "og_description": null,
    "twitter_image": null,
    "twitter_title": null,
    "twitter_description": null,
    "meta_title": null,
    "meta_description": null,
    "codeinjection_head": null,
    "codeinjection_foot": null,
    "canonical_url": null,
    "accent_color": null,
    "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
  },
  "url": "https://jina-ai-gmbh.ghost.io/podcast/having-it-both-ways-combining-bm25-with-ai-reranking/",
  "excerpt": "レキシカル検索エンジンを完全なベクトル検索インフラに移行するデメリットを避けながら、優れた意味理解の利点を活かすために、Jina Reranker をレキシカル検索エンジンと統合する方法を学びましょう。",
  "reading_time": 6,
  "access": true,
  "comments": false,
  "og_image": null,
  "og_title": null,
  "og_description": null,
  "twitter_image": null,
  "twitter_title": null,
  "twitter_description": null,
  "meta_title": null,
  "meta_description": null,
  "email_subject": null,
  "frontmatter": null,
  "feature_image_alt": "Black background embellished with binary code, featuring a central tech-inspired emblem with multicolored dots, BM25 tag, con",
  "feature_image_caption": null
}