{
  "slug": "meta-prompt-for-better-jina-api-integration-and-codegen",
  "id": "67331de8a0c24200013a003c",
  "uuid": "3b3780d8-8e89-4d39-8bd4-61f29fd89564",
  "title": "Мета-промпт для улучшенной интеграции Jina API и CodeGen",
  "html": "<p>Недавно мы опубликовали <a href=\"https://docs.jina.ai/?ref=jina-ai-gmbh.ghost.io\">Meta-Prompt</a>, один текстовый файл, который описывает все наши спецификации API. Его можно рассматривать как документацию для LLM, и использовать для автоматической генерации интеграций наших API, включая Reader, Embeddings, Reranker и другие.</p><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/meta-prompt-square-VEED_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/meta-prompt-square-VEED.mp4\" poster=\"https://img.spacergif.org/v1/1080x1080/0a/spacer.png\" width=\"1080\" height=\"1080\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/meta-prompt-square-VEED_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Play video\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Play video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Pause video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">1:44</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Adjust playback speed\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Unmute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Mute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><p>Это так же просто, как скопировать и вставить наш промпт в ChatGPT/Claude, или передать его в команду <a href=\"https://github.com/simonw/llm?ref=jina-ai-gmbh.ghost.io\"><code>llm</code></a> как системный промпт, а затем добавить свой собственный промпт, чтобы указать, что вы хотите создать (что мы делаем ниже). Это отлично подходит, если вы хотите использовать LLM для быстрого создания приложений, которые парсят веб, работают с embeddings или даже полноценных RAG-систем. И всё это с минимальными галлюцинациями.</p><h2 id=\"why-would-i-even-need-a-meta-prompt\">Зачем мне вообще нужен Meta-Prompt?</h2><p>Допустим, вы хотите использовать LLM для генерации кода, использующего API Jina. Давайте попросим GPT-4 сделать именно это:</p><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/output_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/output.mp4\" poster=\"https://img.spacergif.org/v1/1558x1030/0a/spacer.png\" width=\"1558\" height=\"1030\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/output_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Play video\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Play video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Pause video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:27</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Adjust playback speed\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Unmute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Mute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><p>Выглядит хорошо, правда? Есть <code>from jina import Client</code> и всё остальное.</p><p>Одна небольшая проблема: пакет Jina находится в режиме поддержки, и это <em>не</em> тот способ, которым нужно обращаться к нашим API. Даже если вы <em>действительно</em> установите пакет Jina, сгенерированная программа упадёт при попытке запуска:</p><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/Screencast-from-2024-11-11-14-43-51_thumb.jpg\" data-kg-custom-thumbnail=\"\">Что из этого следует? Мы же можем просто попросить GPT поискать в интернете API Jina, верно? Вот что мы получаем:\n\nОднако, если посмотреть на код, он <em>не использует</em> все соответствующие API Jina. Он явно не обнаружил существование Reader, вместо этого предлагая установить <a href=\"https://pypi.org/project/beautifulsoup4/?ref=jina-ai-gmbh.ghost.io\">BeautifulSoup</a> для парсинга. И даже когда он (предположительно) мог выполнить парсинг с помощью BeautifulSoup, он неправильно обработал формат ответа для Jina Embeddings, что привело к сбою:<div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Воспроизвести видео\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Воспроизвести видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Приостановить видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:16</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Настроить скорость воспроизведения\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Включить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Отключить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><p>Тем не менее, даже если бы ChatGPT <em>мог</em> правильно это сделать с помощью поиска, многие другие LLM (например, Claude) в настоящее время не поддерживают веб-поиск, что серьезно ограничивает ваши возможности.</p><p>Вот где блистает Meta-Prompt. С помощью Meta-Prompt вы можете загрузить весь контекст и спецификации API Jina в LLM. Это означает, что LLM может генерировать код, который напрямую использует API Jina, без галлюцинаций или ненужных обходных путей, давая вам код, который работает <em>с первого раза</em>.</p><div class=\"kg-card kg-callout-card kg-callout-card-yellow\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\">Ладно, <i><em class=\"italic\" style=\"white-space: pre-wrap;\">обычно</em></i> с первого раза. LLM могут быть непредсказуемыми, но как вы можете видеть ниже, в наших экспериментах все прошло хорошо.</div></div><h2 id=\"experiments-with-meta-prompt\">Эксперименты с Meta-Prompt</h2><p>Чтобы проверить Meta-Prompt в действии, мы провели несколько экспериментов и оценили результаты. Если не указано иное, мы использовали <a href=\"https://www.anthropic.com/news/claude-3-5-sonnet?ref=jina-ai-gmbh.ghost.io\">Claude-3.5-Sonnet</a> в качестве LLM.</p><p>Для всех экспериментов мы указали соответствующие API-ключи (такие как <code>JINA_API_KEY</code> и <code>ANTHROPIC_API_KEY</code>) как переменные среды перед запуском сгенерированного кода.</p><h3 id=\"experiment-1-verifying-statements-using-meta-prompt-in-chatgpt\">Эксперимент 1: Проверка утверждений с помощью Meta-Prompt в ChatGPT</h3><p>Мы пишем это сразу после выборов в США, когда дезинформации было больше, чем когда-либо. Как нам отделить сигнал от шума в наших лентах и получить только хорошее без лжи?</p><p>Допустим, мы хотим проверить, точно ли сообщается о новом законе Великобритании на <a href=\"http://bbc.com/?ref=jina-ai-gmbh.ghost.io\">BBC.com</a>, в частности, утверждение:</p><blockquote>\"Правительство Великобритании объявило о новом законе, который будет требовать от компаний социальных сетей проверять возраст своих пользователей.\"</blockquote><p>Мы можем скопировать Meta-Prompt в ChatGPT, затем написать свой собственный промпт для генерации кода, например:</p><pre><code class=\"language-text\">Write the JavaScript code to check the validity\nof the following statement on bbc.com: \n\n\"The UK government has announced a new law \nthat will require social media companies to \nverify the age of their users.\"\n</code></pre><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/grounding-chatgpt_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/grounding-chatgpt.mp4\" poster=\"https://img.spacergif.org/v1/1562x1086/0a/spacer.png\" width=\"1562\" height=\"1086\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/grounding-chatgpt_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Воспроизвести видео\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Воспроизвести видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Приостановить видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:35</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Настроить скорость воспроизведения\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Включить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Отключить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92a1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><p>Затем мы можем запустить это с помощью</p><code>node grounding.js</code> (после установки всех необходимых пакетов, таких как <a href=\"https://www.npmjs.com/package/axios?ref=jina-ai-gmbh.ghost.io\">axios</a>). Мы получаем такой результат, показывающий, что утверждение верно, вместе с источниками:</p><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/grounding-run-1_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/grounding-run-1.mp4\" poster=\"https://img.spacergif.org/v1/1880x1074/0a/spacer.png\" width=\"1880\" height=\"1074\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/grounding-run-1_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Воспроизвести видео\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Воспроизвести видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Пауза\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:04</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Настроить скорость воспроизведения\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Включить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Выключить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><h3 id=\"experiment-2-visualizing-hacker-news-from-the-cli\">Эксперимент 2: Визуализация Hacker News из командной строки</h3><p>Если вы предпочитаете работать в командной строке, вы можете использовать Meta-Prompt через cURL. Сначала вам нужно установить пакет Python <code>llm</code>:</p><pre><code class=\"language-shell\">pip install llm\n</code></pre><p>А затем плагин Claude-3:</p><pre><code class=\"language-shell\">llm install llm-claude-3\n</code></pre><p>На последнем этапе настройки укажите ваш API ключ Anthropic:</p><pre><code class=\"language-shell\">export ANTHROPIC_API_KEY=<your key>\n</code></pre><p>Теперь давайте напишем промпт для визуализации каждого предложения с главной страницы Hacker News:</p><pre><code class=\"language-text\">grab every sentence from hackernews frontpage and \nvisualize them in a 2d umap using matplotlib\n</code></pre><p>Мы можем <a href=\"https://wizardzines.com/comics/bash-pipes/?ref=jina-ai-gmbh.ghost.io\">перенаправить</a> это в команду <code>llm</code> с помощью:</p><pre><code class=\"language-shell\">curl docs.jina.ai | llm -s \"grab every sentence from hackernews frontpage and visualize them in a 2d umap using matplotlib\" -m claude-3.5-sonnet\n</code></pre><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/Screencast-from-2024-11-11-11-23-03_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/Screencast-from-2024-11-11-11-23-03.mp4\" poster=\"https://img.spacergif.org/v1/1874x1074/0a/spacer.png\" width=\"1874\" height=\"1074\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/Screencast-from-2024-11-11-11-23-03_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Воспроизвести видео\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Воспроизвести видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Пауза\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:24</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Настроить скорость воспроизведения\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Включить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Выключить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><p>Если извлечь и запустить сгенерированный код, получится что-то вроде этого:</p><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/Screencast-from-2024-11-11-11-28-43_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/Screencast-from-2024-11-11-11-28-43.mp4\" poster=\"https://img.spacergif.org/v1/1874x1074/0a/spacer.png\" width=\"1874\" height=\"1074\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/Screencast-from-2024-11-11-11-28-43_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Play video\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Play video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Pause video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:38</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Adjust playback speed\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Unmute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Mute\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\">Одно текущее ограничение (хотя я уверен, что с дополнительным кодированием от пользователя это можно обойти) заключается в том, что вам нужно будет устанавливать требования вручную. Файл <code spellcheck=\"false\" style=\"white-space: pre-wrap;\">requirements.txt</code> не генерируется. В данном случае нам понадобились <a href=\"https://umap-learn.readthedocs.io/en/latest/?ref=jina-ai-gmbh.ghost.io\">UMAP</a> и <a href=\"https://matplotlib.org/?ref=jina-ai-gmbh.ghost.io\">Matplotlib</a>, хотя ваши потребности могут отличаться.</div></div><h3 id=\"experiment-3-building-a-simple-rag-system-with-json-storage\">Эксперимент 3: Создание простой системы RAG с хранением в JSON</h3><p>Чтобы продвинуться еще дальше, давайте создадим простую систему RAG. В свободное время я изучаю <a href=\"https://github.com/jeff-dh/SolidPython?ref=jina-ai-gmbh.ghost.io\">SolidPython</a>, поэтому мы будем использовать репозиторий и вики в качестве базы знаний. Для простоты мы не будем использовать базу данных, а просто будем хранить данные в JSON-файле.</p><p>Вот промпт, сохраненный в файле <code>prompt.txt</code>:</p><pre><code class=\"language-text\">Create a simple RAG system using pages from these sources:\n\n- repo: &lt;https://github.com/jeff-dh/SolidPython&gt;\n- wiki: &lt;https://github.com/jeff-dh/SolidPython/wiki&gt; (and all the subpages)\n\nScrape no other pages.\n\nInstead of using vector database, use JSON file\n\nYou can access an LLM with the CLI command: llm 'your prompt' -m claude-3.5-sonnet\n\nAfter segmenting and indexing all the pages, present a prompt for the user to ask a\nquestion. To answer the question, find the top three segments and pass them to the LLM\nwith the prompt:\n\n--- prompt start ---\nBased on these segments:\n\n- {segment 1}\n- {segment 2}\n- {segment 3}\n\nAnswer the question: {question}\n--- prompt end ---</code></pre><p>Как видите, мы можем предоставить LLM дополнительные инструменты, указав их в промпте. Без этого Claude часто придумывает менее оптимальный (или даже нерабочий) способ добавления LLM в систему RAG.</p><p>Поскольку это очень длинный промпт (с множеством знаков пунктуации, которые могут нарушить работу любого пайпа), мы будем использовать текст <code>$(cat prompt.txt)</code> вместо самого промпта при выполнении команды:</p><pre><code class=\"language-shell\">curl docs.jina.ai/v4 | llm -s \"$(cat prompt.txt)\" -m claude-3.5-sonnet\n</code></pre><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/docsqa-claude_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/docsqa-claude.mp4\" poster=\"https://img.spacergif.org/v1/1880x1074/0a/spacer.png\" width=\"1880\" height=\"1074\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/docsqa-claude_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Play video\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Play video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Pause video\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span><div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:34</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Настройка скорости воспроизведения\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Включить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Выключить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><p>Уф! Это много вывода. Но (как и в примере с Hacker News) извлечь и запустить код из этого большого текстового блока — настоящая головная боль. Конечно, нет такой проблемы, которую нельзя решить, просто добавив еще больше LLM, верно? Поэтому давайте добавим еще один промпт, чтобы \"разблокировать\" исходный вывод:</p><pre><code class=\"language-text\">leave just the code in this file, remove all surrounding explanatory text. \ndo not wrap code in backticks, just return \"pure code\"</code></pre><p>Теперь добавляем это в наш конвейер команд и запускаем:</p><pre><code class=\"language-shell\">curl docs.jina.ai/v4 | llm -s \"$(cat prompt.txt)\" -m claude-3.5-sonnet | llm -s 'leave just the code in this file, remove all surrounding explanatory text. do not wrap code in backticks, just return \"pure code\"' -m claude-3.5-sonnet > app.py\n</code></pre><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\">Поскольку мы используем <code spellcheck=\"false\" style=\"white-space: pre-wrap;\">> app.py</code> в конце нашей команды для направления всего вывода в файл, в видео нечего показывать.</div></div><p>Затем мы можем запустить это приложение с помощью <code>python app.py</code>, и мы получим нашу RAG-программу. Как видите, она может отвечать на вопросы и поддерживать рабочую память:</p><figure class=\"kg-card kg-video-card kg-width-regular\" data-kg-thumbnail=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/docsqa-run_thumb.jpg\" data-kg-custom-thumbnail=\"\">\n            <div class=\"kg-video-container\">\n                <video src=\"https://jina-ai-gmbh.ghost.io/content/media/2024/11/docsqa-run.mp4\" poster=\"https://img.spacergif.org/v1/1854x1078/0a/spacer.png\" width=\"1854\" height=\"1078\" playsinline=\"\" preload=\"metadata\" style=\"background: transparent url('https://jina-ai-gmbh.ghost.io/content/media/2024/11/docsqa-run_thumb.jpg') 50% 50% / cover no-repeat;\"></video>\n                <div class=\"kg-video-overlay\">\n                    <button class=\"kg-video-large-play-icon\" aria-label=\"Воспроизвести видео\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                            <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                        </svg>\n                    </button>\n                </div>\n                <div class=\"kg-video-player-container\">\n                    <div class=\"kg-video-player\">\n                        <button class=\"kg-video-play-icon\" aria-label=\"Воспроизвести видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M23.14 10.608 2.253.164A1.559 1.559 0 0 0 0 1.557v20.887a1.558 1.558 0 0 0 2.253 1.392L23.14 13.393a1.557 1.557 0 0 0 0-2.785Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-pause-icon kg-video-hide\" aria-label=\"Приостановить видео\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <rect x=\"3\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                                <rect x=\"14\" y=\"1\" width=\"7\" height=\"22\" rx=\"1.5\" ry=\"1.5\"></rect>\n                            </svg>\n                        </button>\n                        <span class=\"kg-video-current-time\">0:00</span>\n                        <div class=\"kg-video-time\">\n                            /<span class=\"kg-video-duration\">0:34</span>\n                        </div>\n                        <input type=\"range\" class=\"kg-video-seek-slider\" max=\"100\" value=\"0\">\n                        <button class=\"kg-video-playback-rate\" aria-label=\"Настройка скорости воспроизведения\">1×</button>\n                        <button class=\"kg-video-unmute-icon\" aria-label=\"Включить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M15.189 2.021a9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h1.794a.249.249 0 0 1 .221.133 9.73 9.73 0 0 0 7.924 4.85h.06a1 1 0 0 0 1-1V3.02a1 1 0 0 0-1.06-.998Z\"></path>\n                            </svg>\n                        </button>\n                        <button class=\"kg-video-mute-icon kg-video-hide\" aria-label=\"Выключить звук\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">\n                                <path d=\"M16.177 4.3a.248.248 0 0 0 .073-.176v-1.1a1 1 0 0 0-1.061-1 9.728 9.728 0 0 0-7.924 4.85.249.249 0 0 1-.221.133H5.25a3 3 0 0 0-3 3v2a3 3 0 0 0 3 3h.114a.251.251 0 0 0 .177-.073ZM23.707 1.706A1 1 0 0 0 22.293.292l-22 22a1 1 0 0 0 0 1.414l.009.009a1 1 0 0 0 1.405-.009l6.63-6.631A.251.251 0 0 1 8.515 17a.245.245 0 0 1 .177.075 10.081 10.081 0 0 0 6.5 2.92 1 1 0 0 0 1.061-1V9.266a.247.247 0 0 1 .073-.176Z\"></path>\n                            </svg>\n                        </button>\n                        <input type=\"range\" class=\"kg-video-volume-slider\" max=\"100\" value=\"100\">\n                    </div>\n                </div>\n            </div>\n            \n        </figure><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\">Первый запуск занял немного больше времени, так как нужно было сегментировать и закодировать все данные. Для последующих запусков эти данные загружались из JSON-файла, чтобы сэкономить время и затраты.</div></div><h3 id=\"experiment-4-building-an-app-factory-with-meta-prompt\">Эксперимент 4: Создание фабрики приложений с Meta-Prompt</h3><p>Теперь, когда мы можем генерировать скрипты и приложения неинтерактивно, мы можем легко автоматизировать \"фабрику приложений\" — скрипт, который перебирает промпты и создает Python-скрипты на выходе. Вы можете получить скрипт фабрики приложений в <a href=\"https://gist.github.com/alexcg1/4150f2e7dfe0d635260c71d59324172b?ref=jina-ai-gmbh.ghost.io\">GitHub gist</a>:</p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://gist.github.com/alexcg1/4150f2e7dfe0d635260c71d59324172b?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">App Factory with Jina AI Meta-Prompt</div><div class=\"kg-bookmark-description\">App Factory with Jina AI Meta-Prompt. GitHub Gist: instantly share code, notes, and snippets.</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/pinned-octocat-093da3e6fa40.svg\" alt=\"\"><span class=\"kg-bookmark-author\">Gist</span><span class=\"kg-bookmark-publisher\">262588213843476</span></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/gist-og-image-54fd7dc0713e.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><p>Если кратко, вот что он делает:</p><ul><li>Перебирает директорию <code>prompts</code>, которая содержит (как вы догадались) файлы с промптами.</li><li>Передает Meta-Prompt и каждый текст промпта Claude-3.5-Sonnet (через <code>llm</code>).</li><li>Берет вывод и снова передает его Claude, на этот раз с промптом, указывающим оставить только код.</li><li>Записывает это в файл в директории <code>apps</code>.</li></ul><p>Мы бы показали демонстрацию, но смотреть особо нечего. Он просто регистрирует, с каким файлом промпта работает, а в остальном работает молча без интересного вывода на экран.</p><div class=\"kg-card kg-callout-card kg-callout-card-yellow\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\"><i><em class=\"italic\" style=\"white-space: pre-wrap;\">Тестирование</em></i> приложений, которые он генерирует — это отдельный вопрос, на который у меня нет готового ответа. По нашему опыту, мы часто указываем данные, которые хотим использовать, в наших промптах, обычно передавая внешний URL для загрузки через Reader. Однако иногда LLM галлюцинирует тестовые данные, и скрипт запускается без очевидных проблем — он просто \"лжет\" о том, что делает.</div></div><p>Чтобы поднять фабрику приложений на следующий уровень, можно пойти по пути <a href=\"https://www.notion.so/Meta-Prompt-LLM-Generated-Code-without-The-Hallucinations-333ad1ddc735470e83f987d7dd6a644f?pvs=21&ref=jina-ai-gmbh.ghost.io\">Factorio</a> и написать <em>ещё один</em> скрипт для генерации идей приложений и на их основе создавать промпты для подачи в фабрику. Мы пока этого не сделали, но оставляем это как упражнение для вас, читателей.</p><h2 id=\"playing-with-meta-prompt-what-did-we-find-out\">Эксперименты с Meta-Prompt: Что мы узнали?</h2><p>Мы многому научились, используя Meta-Prompt, как в отношении того, что включать в наши промпты, так и в понимании того, как разные LLM генерируют различные выходные данные.</p><h3 id=\"general-observations\">Общие наблюдения</h3><ul><li><strong>Специализация API</strong>: Использование специализированных API для конкретных задач (например, <a href=\"https://developers.google.com/books?ref=jina-ai-gmbh.ghost.io\">Google Books</a> для запросов, связанных с книгами) обеспечивает более стабильные результаты, чем универсальные поисковые API, что может сократить использование токенов и повысить надёжность.</li><li><strong>Пользовательские промпты для повторного использования</strong>: Для неинтерактивных настроек сохранение промптов в файлы <code>.txt</code> и их передача в CLI позволяет эффективно получать только код без лишнего пояснительного текста.</li><li><strong>Структурированный вывод</strong>: Сохранение выходных данных (обычно в формате JSON) и их повторная загрузка при необходимости экономит токены и упрощает такие задачи, как генерация эмбеддингов, где использование токенов может быть дорогостоящим.</li></ul><h3 id=\"insights-from-using-different-llms\">Выводы из использования разных LLM</h3><p><strong>GPT</strong></p><ul><li><strong>Проблемы с сохранением промптов</strong>: GPT-4 иногда теряет детали при длинных инструкциях, что приводит к проблемам, когда он \"забывает\" ключевые элементы в процессе обсуждения. Это вызывает <em>много</em> разочарования, когда приходится напоминать ему о простых вещах.</li><li><strong>Проблемы интеграции API</strong>: В случаях, таких как интеграция <a href=\"https://milvus.io/docs/milvus_lite.md?ref=jina-ai-gmbh.ghost.io\">Milvus Lite</a> с <code>jina-embeddings-v3</code>, даже когда мы предоставляем инструкции по API Milvus Lite, GPT-4 полностью и неоднократно терпит неудачу, генерируя код, который создает базы данных без эмбеддингов, которые только что были сгенерированы, делая невозможным семантический поиск.</li></ul><p><strong>Claude</strong></p><ul><li><strong>Ограничения вывода кода</strong>: Claude-3.5 часто создает скрипты, которые кажутся полными, но содержат скрытые проблемы, такие как отсутствие обработки ошибок или неучет отсутствующих API-ключей. Кроме того, он иногда использует предустановленные примеры вместо генерации ответов, адаптированных под конкретные инструкции.</li><li><strong>Тихий вывод</strong>: С кодом, сгенерированным LLM, <em>действительно</em> помогает иметь логирование происходящего за кулисами при запуске программы, просто чтобы убедиться, что модель не напортачила. Если не указать явно, приложения, созданные с помощью Claude, часто работают молча, не давая понять, что происходит.</li><li><strong>Взаимодействие с CLI</strong>: Нужно четко указывать, что CLI-команды — это <em>CLI</em>-команды. Если сказать Claude, что он может использовать команду <code>llm</code>, часто он пытается вызвать функцию Python <code>llm()</code>, которая не существует.</li><li><strong>Claude 3.5-Sonnet — лучший выбор:</strong> Claude-3.5-Haiku тоже показал себя неплохо в начальных тестах, но Opus и Sonnet-3 просто суммируют инструкции Jina API, не учитывая пользовательский промпт.</li></ul><h2 id=\"conclusion\">Заключение</h2><p>Использование Meta-Prompt предоставляет новые способы интеграции API Jina с LLM, позволяя проводить эксперименты и создавать приложения, работающие с первой попытки. Больше никаких сбоев, пропущенных API-соединений или галлюцинированных функций — Meta-Prompt гарантирует, что сгенерированный код точен и функционален сразу после создания. Будь то верификация утверждений, генерация эмбеддингов, создание легкой RAG-системы или автоматизация создания приложений, Meta-Prompt преобразует инструкции на естественном языке в действенный, корректный код, минуя типичный диалог с LLM для получения рабочего результата.</p><p>Независимо от того, копируете ли вы Meta-Prompt в ChatGPT или используете его с пользовательской LLM-командой, он предлагает простой, надежный способ использования возможностей Jina. Наши эксперименты и выводы показывают, что Meta-Prompt является надежным инструментом для интеграции в ваши проекты.</p><p>Если вы готовы исследовать возможности Meta-Prompt, посетите <a href=\"http://docs.jina.ai/?ref=jina-ai-gmbh.ghost.io\">docs.jina.ai</a> для получения последней документации и ресурсов.</p>",
  "comment_id": "67331de8a0c24200013a003c",
  "feature_image": "https://jina-ai-gmbh.ghost.io/content/images/2024/11/Heading--58-.png",
  "featured": false,
  "visibility": "public",
  "created_at": "2024-11-12T10:20:40.000+01:00",
  "updated_at": "2024-11-19T23:03:02.000+01:00",
  "published_at": "2024-11-19T23:03:02.000+01:00",
  "custom_excerpt": "Is Meta-Prompt the new norm for API specs? Feed it to LLMs and generate integration code that reliably integrates Jina's APIs, saving you from the usual trial-and-error process.",
  "codeinjection_head": null,
  "codeinjection_foot": null,
  "custom_template": null,
  "canonical_url": null,
  "authors": [
    {
      "id": "632ade4a3e4e55003d525971",
      "name": "Alex C-G",
      "slug": "alexcg",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/09/alex.jpg",
      "cover_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/twitter_banner.jpg",
      "bio": "Open-source Evangelist @ Jina AI. Old, grim, and full of Vim",
      "website": null,
      "location": "Berlin, Germany",
      "facebook": null,
      "twitter": "@alexcg",
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/alexcg/"
    }
  ],
  "tags": [
    {
      "id": "634a1a8ccebfc1003d8ab706",
      "name": "Tech Blog",
      "slug": "tech-blog",
      "description": null,
      "feature_image": null,
      "visibility": "public",
      "og_image": null,
      "og_title": null,
      "og_description": null,
      "twitter_image": null,
      "twitter_title": null,
      "twitter_description": null,
      "meta_title": null,
      "meta_description": null,
      "codeinjection_head": null,
      "codeinjection_foot": null,
      "canonical_url": null,
      "accent_color": null,
      "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
    }
  ],
  "primary_author": {
    "id": "632ade4a3e4e55003d525971",
    "name": "Alex C-G",
    "slug": "alexcg",
    "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/09/alex.jpg",
    "cover_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/twitter_banner.jpg",
    "bio": "Open-source Evangelist @ Jina AI. Old, grim, and full of Vim",
    "website": null,
    "location": "Berlin, Germany",
    "facebook": null,
    "twitter": "@alexcg",
    "meta_title": null,
    "meta_description": null,
    "url": "https://jina-ai-gmbh.ghost.io/author/alexcg/"
  },
  "primary_tag": {
    "id": "634a1a8ccebfc1003d8ab706",
    "name": "Tech Blog",
    "slug": "tech-blog",
    "description": null,
    "feature_image": null,
    "visibility": "public",
    "og_image": null,
    "og_title": null,
    "og_description": null,
    "twitter_image": null,
    "twitter_title": null,
    "twitter_description": null,
    "meta_title": null,
    "meta_description": null,
    "codeinjection_head": null,
    "codeinjection_foot": null,
    "canonical_url": null,
    "accent_color": null,
    "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
  },
  "url": "https://jina-ai-gmbh.ghost.io/podcast/meta-prompt-for-better-jina-api-integration-and-codegen/",
  "excerpt": "Станет ли Meta-Prompt новым стандартом для API-спецификаций? Передайте его в LLM и сгенерируйте интеграционный код, который надежно интегрирует API от Jina, избавляя вас от обычного процесса проб и ошибок.",
  "reading_time": 9,
  "access": true,
  "comments": false,
  "og_image": null,
  "og_title": null,
  "og_description": null,
  "twitter_image": null,
  "twitter_title": null,
  "twitter_description": null,
  "meta_title": null,
  "meta_description": null,
  "email_subject": null,
  "frontmatter": null,
  "feature_image_alt": null,
  "feature_image_caption": null
}