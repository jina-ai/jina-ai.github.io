{
  "slug": "bridging-language-gaps-in-multilingual-embeddings-via-contrastive-learning",
  "id": "67066bd652567c0001d0f2cd",
  "uuid": "1130051f-f343-4eb2-9956-9b574c212704",
  "title": "通过对比学习构建多语言嵌入中的语言差异桥梁",
  "html": "<p>在多语言模型中，一个关键的挑战是\"<strong>语言差距</strong>\"——一种不同语言中具有相同含义的短语之间没有得到理想的紧密对齐或聚类的现象。理想情况下，一种语言的文本及其在另一种语言中的对应文本应具有相似的表示——即非常接近的 embeddings——从而使跨语言应用程序能够以相同的方式处理不同语言的文本。然而，模型往往会微妙地体现文本的语言特征，从而产生导致跨语言性能不理想的\"语言差距\"。</p><p>在本文中，我们将探讨这种语言差距以及它如何影响文本 embedding 模型的性能。我们使用 <code>jina-xlm-roberta</code> 模型和最新的 <code>jina-embeddings-v3</code> 进行了实验，评估了同一语言中的释义以及不同语言对之间的翻译的语义对齐情况。这些实验揭示了在不同训练条件下，具有相似或相同含义的短语如何聚集在一起。</p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://jina.ai/news/jina-embeddings-v3-a-frontier-multilingual-embedding-model/?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">Jina Embeddings v3: A Frontier Multilingual Embedding Model</div><div class=\"kg-bookmark-description\">jina-embeddings-v3 is a frontier multilingual text embedding model with 570M parameters and 8192 token-length, outperforming the latest proprietary embeddings from OpenAI and Cohere on MTEB.</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-128x128-6.png\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/v3banner-1.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><p>我们还尝试了改进跨语言语义对齐的训练技术，特别是在对比学习过程中引入<strong>并行多语言数据</strong>。在本文中，我们将分享我们的见解和结果。</p><h2 id=\"multilingual-model-training-creates-and-reduces-the-language-gap\"><strong>多语言模型训练既创造又减少语言差距</strong></h2><p>文本 embedding 模型的训练通常涉及两个主要部分的多阶段过程：</p><ol><li><a href=\"https://aclanthology.org/2023.acl-long.49/?ref=jina-ai-gmbh.ghost.io\"><strong>掩码语言建模</strong></a>（MLM）：预训练通常涉及大量文本，其中一些 token 被随机掩码。模型被训练来预测这些被掩码的 token。这个过程教会模型训练数据中的语言模式，包括可能源自语法、词汇语义和语用现实世界约束的 token 之间的选择依赖关系。</li><li><a href=\"https://paperswithcode.com/task/contrastive-learning?ref=jina-ai-gmbh.ghost.io\"><strong>对比学习</strong></a>：预训练之后，模型使用精心策划或半策划的数据进行进一步训练，以使语义相似的文本的 embeddings 更加接近，并（可选）将不相似的文本推得更远。这种训练可以使用已知或至少可靠估计其语义相似性的文本对、三元组甚至组。它可能有几个子阶段，这部分过程有多种训练策略，新的研究经常发表，目前尚未就最佳方法达成明确共识。</li></ol><p>要理解语言差距是如何产生的以及如何消除它，我们需要了解这两个阶段的作用。</p><h3 id=\"masked-language-pretraining\"><strong>掩码语言预训练</strong></h3><p>文本 embedding 模型的一些跨语言能力是在预训练期间获得的。</p><p>同源词和借用词使模型能够从大量文本数据中学习一些跨语言语义对齐。例如，英语单词 <em>banana</em> 和法语单词 <em>banane</em>（以及德语 <em>Banane</em>）在拼写上足够相似且使用频繁，使得 embedding 模型可以学习到跨语言中类似\"banan-\"的词具有相似的分布模式。它可以利用这些信息在一定程度上学习到其他在不同语言中看起来不同的词也具有相似的含义，甚至可以理解一些语法结构是如何翻译的。</p><p>然而，这种学习是在没有明确训练的情况下发生的。</p><p>我们测试了 <code>jina-xlm-roberta</code> 模型（<code>jina-embeddings-v3</code> 的预训练主干网络），看它如何从掩码语言预训练中学习跨语言等价性。我们绘制了一组英语句子翻译成德语、荷兰语、简体中文和日语的二维 <a href=\"https://pair-code.github.io/understanding-umap/?ref=jina-ai-gmbh.ghost.io\">UMAP 句子表示</a>。结果如下图所示：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_roberta_mlm_representation.png\" class=\"kg-image\" alt=\"Multilingual scatterplot showing word embeddings' alignment across five languages on UMAP dimensions.\" loading=\"lazy\" width=\"1000\" height=\"800\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/jina_xlm_roberta_mlm_representation.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_roberta_mlm_representation.png 1000w\" sizes=\"(min-width: 720px) 720px\"></figure><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\">英语句子及其德语、荷兰语、中文和日语翻译的二维 UMAP 投影。灰线连接非英语句子与它们翻译自的英语句子。<br><br>这些句子在 <code spellcheck=\"false\" style=\"white-space: pre-wrap;\">jina-xlm-roberta</code> embedding 空间中强烈倾向于形成特定语言的聚类，尽管在这个投影中可以看到一些离群点，这可能是二维投影的副作用。</div></div><p>可以看到，预训练已经将同一语言的句子的 embeddings 聚类得非常紧密。这是一个将高维空间的分布投影到二维空间的结果，所以仍然可能存在，例如，一个德语句子虽然是一个英语句子的好翻译，它的 embedding 可能仍然是最接近其英语源句的 embedding 的德语句子。但它确实表明，一个英语句子的 embedding 可能比起语义完全相同或几乎相同的德语句子，更接近另一个英语句子。</p><p>还要注意德语和荷兰语形成的聚类比其他语言对更接近。对于两种相对密切相关的语言来说，这并不令人惊讶。德语和荷兰语足够相似，以至于它们有时可以部分互通。</p><p>日语和中文也似乎比其他语言更接近。虽然它们的关系不同，但书面日语通常使用<em>汉字</em>（漢字），即中文的<em>汉字</em>。日语与中文共享大部分这些书写字符，两种语言都有许多使用一个或多个汉字写成的共同词汇。从 MLM 的角度来看，这与荷兰语和德语之间的可见相似性是一样的。</p><p>我们可以通过只看两种语言各两个句子的方式更简单地看到这种\"语言差距\"：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--8-.png\" class=\"kg-image\" alt=\"Graph illustrating linguistic relationships with color-coded lines, data points for English and German phrases, and an &quot;MLM P\" loading=\"lazy\" width=\"1815\" height=\"1014\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/image--8-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/image--8-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/image--8-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--8-.png 1815w\" sizes=\"(min-width: 720px) 720px\"></figure><p>由于 MLM 自然地按语言聚类文本，\"my dog is blue\" 和 \"my cat is red\" 被聚在一起，远离它们的德语对应句。与之前博文中讨论的\"<a href=\"https://jina.ai/news/the-what-and-why-of-text-image-modality-gap-in-clip-models/?ref=jina-ai-gmbh.ghost.io\">模态差距</a>\"不同，我们认为这源于语言之间的表面相似性和差异性：相似的拼写、印刷中相同字符序列的使用，以及可能存在的形态和句法结构的相似性——常见的词序和构词方式。</p><p>简而言之，无论模型在 MLM 预训练中学习跨语言等价性的程度如何，这都不足以克服按语言聚类的强烈倾向。这留下了一个很大的语言差距。</p><h3 id=\"contrastive-learning\"><strong>对比学习</strong></h3><p>理想情况下，我们希望 embedding 模型对语言无感，在其 embeddings 中只编码一般含义。在这样的模型中，我们将看不到按语言聚类，也不会有语言差距。一种语言中的句子应该非常接近其良好的翻译，而远离表达其他含义的句子，即使是同一语言中的句子，如下图所示：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-10---1-.png\" class=\"kg-image\" alt=\"Graph displays &quot;Clustering by Meaning&quot; with multilingual labels, emphasizing abstract concepts on a dark backdrop.\" loading=\"lazy\" width=\"1815\" height=\"1014\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-10---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-10---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-10---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-10---1-.png 1815w\" sizes=\"(min-width: 720px) 720px\"></figure><p>MLM 预训练无法实现这一点，因此我们使用额外的<em>对比学习</em>技术来改进 embeddings 中的语义表示。</p><p>对比学习涉及使用已知在含义上相似或不同的文本对，以及已知一对比另一对更相似的三元组。在训练过程中，权重会被调整以反映文本对和三元组之间的这种已知关系。</p><p>我们的对比学习数据集中包含 30 种语言，但 97% 的对和三元组都在同一语言中，只有 3% 涉及跨语言对或三元组。但这 3% 就足以产生戏剧性的结果：Embeddings 几乎不显示语言聚类，而语义相似的文本无论使用什么语言都会产生接近的 embeddings，正如从 <code>jina-embeddings-v3</code> 的 UMAP 投影所示。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_contrastive_representation.png\" class=\"kg-image\" alt=\"Scatter plot on black background showing language distribution post-contrastive training with UMAP dimensions.\" loading=\"lazy\" width=\"1000\" height=\"800\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/jina_xlm_contrastive_representation.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/jina_xlm_contrastive_representation.png 1000w\" sizes=\"(min-width: 720px) 720px\"></figure><p>为了验证这一点，我们测量了 <code>jina-xlm-roberta</code> 和 <code>jina-embeddings-v3</code> 在 STS17 数据集上生成的表征的 Spearman 相关性。</p><div class=\"kg-card kg-callout-card kg-callout-card-blue\"><div class=\"kg-callout-emoji\">💡</div><div class=\"kg-callout-text\"><a href=\"https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient?ref=jina-ai-gmbh.ghost.io\"><b><strong style=\"white-space: pre-wrap;\">Spearman 相关性</strong></b></a>测量的是排序相关性，即两个有序列表的相似程度。这是比较嵌入模型之间以及与人类评分之间关系的良好机制，因为实际分数远不如哪些项目排在其他项目之上或之下重要。</div></div><p>下表显示了不同语言翻译文本的语义相似性排名之间的 Spearman 相关性。我们取一组英语句子，然后测量它们的嵌入与特定参考句子嵌入的相似度，并按照从最相似到最不相似的顺序排序。然后我们将所有这些句子翻译成另一种语言并重复排序过程。在理想的跨语言嵌入模型中，这两个有序列表应该是相同的，Spearman 相关性应该是 1.0。</p><p>下面的图表和表格显示了我们使用 <code>jina-xlm-roberta</code> 和 <code>jina-embeddings-v3</code> 比较 STS17 基准测试中的英语和其他六种语言的结果。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-4---1-.png\" class=\"kg-image\" alt=\"Bar chart comparing Spearman Correlation for English paired with AR, DE, ES, FR, IT, NL, colored in red and blue by alphabet \" loading=\"lazy\" width=\"2000\" height=\"1056\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-4---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-4---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-4---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-4---1-.png 2085w\" sizes=\"(min-width: 720px) 720px\"></figure>\n\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Task</strong></th>\n<th><strong><code>jina-xlm-roberta</code></strong></th>\n<th><strong><code>jina-embeddings-v3</code></strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>English ↔ Arabic</td>\n<td>0.1581</td>\n<td><strong>0.7977</strong></td>\n</tr>\n<tr>\n<td>English ↔ German</td>\n<td>0.2136</td>\n<td><strong>0.8366</strong></td>\n</tr>\n<tr>\n<td>English ↔ Spanish</td>\n<td>0.1049</td>\n<td><strong>0.8509</strong></td>\n</tr>\n<tr>\n<td>English ↔ French</td>\n<td>0.1659</td>\n<td><strong>0.8378</strong></td>\n</tr>\n<tr>\n<td>English ↔ Italian</td>\n<td>0.2293</td>\n<td><strong>0.8674</strong></td>\n</tr>\n<tr>\n<td>English ↔ Dutch</td>\n<td>0.2387</td>\n<td><strong>0.8398</strong></td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n\n<p>你可以在这里看到对比学习与原始预训练相比带来的巨大差异。尽管在训练数据中只有 3% 的跨语言数据，<code>jina-embeddings-v3</code> 模型已经学习到足够的跨语言语义，几乎消除了在预训练中产生的语言差距。</p><h2 id=\"english-vs-the-world-can-other-languages-keep-up-in-alignment\">英语对抗世界：其他语言能在对齐中保持竞争力吗？</h2><p>我们在 89 种语言上训练了 <code>jina-embeddings-v3</code>，特别关注 30 种使用广泛的书面语言。尽管我们努力构建大规模的多语言训练语料库，英语仍然占我们在对比训练中使用的数据的近一半。其他语言，包括那些有大量文本材料可用的广泛使用的全球语言，相比训练集中庞大的英语数据量，仍然相对代表性不足。</p><p>考虑到英语的这种主导地位，英语表征是否比其他语言的表征更加对齐？为了探索这一点，我们进行了一项后续实验。</p><p>我们构建了一个数据集 <a href=\"https://huggingface.co/datasets/jinaai/parallel-sentences?ref=jina-ai-gmbh.ghost.io\"><code>parallel-sentences</code></a>，包含 1,000 对英语文本，一个\"锚点\"和一个\"正例\"，其中正例文本在逻辑上被锚点文本蕴含。</p><figure class=\"kg-card kg-bookmark-card\"><a class=\"kg-bookmark-container\" href=\"https://huggingface.co/datasets/jinaai/parallel-sentences?ref=jina-ai-gmbh.ghost.io\"><div class=\"kg-bookmark-content\"><div class=\"kg-bookmark-title\">jinaai/parallel-sentences · Datasets at Hugging Face</div><div class=\"kg-bookmark-description\">We're on a journey to advance and democratize artificial intelligence through open source and open science.</div><div class=\"kg-bookmark-metadata\"><img class=\"kg-bookmark-icon\" src=\"https://jina-ai-gmbh.ghost.io/content/images/icon/favicon-3.ico\" alt=\"\"></div></div><div class=\"kg-bookmark-thumbnail\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/thumbnail/parallel-sentences.png\" alt=\"\" onerror=\"this.style.display = 'none'\"></div></a></figure><p>例如，下表中的第一行。这些句子的含义并不完全相同，但它们具有兼容的含义。它们都在信息性地描述同一种情况。</p><p>然后，我们使用 GPT-4 将这些句对翻译成五种语言：德语、荷兰语、简体中文、繁体中文和日语。最后，我们手动检查以确保质量。</p>\n\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Language</strong></th>\n<th><strong>Anchor</strong></th>\n<th><strong>Positive</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>English</td>\n<td>Two young girls are playing outside in a non-urban environment.</td>\n<td>Two girls are playing outside.</td>\n</tr>\n<tr>\n<td>German</td>\n<td>Zwei junge Mädchen spielen draußen in einer nicht urbanen Umgebung.</td>\n<td>Zwei Mädchen spielen draußen.</td>\n</tr>\n<tr>\n<td>Dutch</td>\n<td>Twee jonge meisjes spelen buiten in een niet-stedelijke omgeving.</td>\n<td>Twee meisjes spelen buiten.</td>\n</tr>\n<tr>\n<td>Chinese (Simplified)</td>\n<td>两个年轻女孩在非城市环境中玩耍。</td>\n<td>两个女孩在外面玩。</td>\n</tr>\n<tr>\n<td>Chinese (Traditional)</td>\n<td>兩個年輕女孩在非城市環境中玩耍。</td>\n<td>兩個女孩在外面玩。</td>\n</tr>\n<tr>\n<td>Japanese</td>\n<td>2人の若い女の子が都市環境ではない場所で遊んでいます。</td>\n<td>二人の少女が外で遊んでいます。</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n\n<p>然后，我们使用 <code>jina-embeddings-v3</code> 对每对文本进行编码，并计算它们之间的余弦相似度。下图和表格显示了每种语言的余弦相似度分数分布和平均相似度：</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/1_monolingual_distribution_triplets.png\" class=\"kg-image\" alt=\"Graph showing cosine similarity distributions for textual pairs in English, German, Dutch, Chinese, and Japanese against dens\" loading=\"lazy\" width=\"1060\" height=\"590\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/1_monolingual_distribution_triplets.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/1_monolingual_distribution_triplets.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/1_monolingual_distribution_triplets.png 1060w\" sizes=\"(min-width: 720px) 720px\"></figure>\n\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Language</strong></th>\n<th><strong>Average Cosine Similarity</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>English</td>\n<td>0.9078</td>\n</tr>\n<tr>\n<td>German</td>\n<td>0.8949</td>\n</tr>\n<tr>\n<td>Dutch</td>\n<td>0.8844</td>\n</tr>\n<tr>\n<td>Chinese (Simplified)</td>\n<td>0.8876</td>\n</tr>\n<tr>\n<td>Chinese (Traditional)</td>\n<td>0.8933</td>\n</tr>\n<tr>\n<td>Japanese</td>\n<td>0.8895</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n\n<p>尽管英语在训练数据中占主导地位，<code>jina-embeddings-v3</code> 在识别德语、荷兰语、日语和两种形式的中文的语义相似性方面的表现与英语相差无几。</p><h2 id=\"breaking-language-barriers-cross-lingual-alignment-beyond-english\"><strong>打破语言障碍：超越英语的跨语言对齐</strong></h2><p>跨语言表征对齐的研究通常研究包含英语的语言对。从理论上讲，这种关注可能会掩盖真实情况。模型可能只是优化了将所有内容尽可能地表示为接近其英语等效项，而没有检查其他语言对是否得到了适当的支持。</p><p>为了探索这一点，我们使用 <code>parallel-sentences</code> 数据集进行了一些实验，重点关注超出仅英语双语对的跨语言对齐。</p><p>下表显示了不同语言对之间等效文本的余弦相似度分布 — 这些文本是来自同一英语源文的翻译。理想情况下，所有对都应该有一个余弦值为 1 — 即完全相同的语义嵌入。在实践中，这不可能发生，但我们期望一个好的模型对于翻译对来说具有非常高的余弦值。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--9-.png\" class=\"kg-image\" alt=\"Density graph charting cross-lingual cosine similarities for language pairs using jina-embeddings-v3 model.\" loading=\"lazy\" width=\"978\" height=\"584\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/image--9-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--9-.png 978w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table>\n<thead>\n<tr>\n<th><strong>Language Pair</strong></th>\n<th><strong>Average Cosine Similarity</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>German ↔ Dutch</td>\n<td>0.8779</td>\n</tr>\n<tr>\n<td>German ↔ Japanese</td>\n<td>0.8664</td>\n</tr>\n<tr>\n<td>Chinese (Simplified) ↔ Japanese</td>\n<td>0.8534</td>\n</tr>\n<tr>\n<td>Dutch ↔ Chinese (Simplified)</td>\n<td>0.8479</td>\n</tr>\n<tr>\n<td>Chinese (Simplified) ↔ Chinese (Traditional)</td>\n<td>0.8758</td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: html-->\n<p>虽然不同语言之间的相似度分数比同一语言中兼容文本的分数略低，但它们仍然非常高。荷兰语/德语翻译之间的余弦相似度几乎与德语中兼容文本之间的余弦相似度一样高。</p><p>这可能并不令人惊讶，因为德语和荷兰语是非常相似的语言。同样，这里测试的两种中文变体实际上不是两种不同的语言，只是同一种语言的风格略有不同的形式。但你可以看到，即使是像荷兰语和中文或德语和日语这样非常不相似的语言对之间，语义等效文本之间仍然显示出很强的相似性。</p><p>我们考虑到这些非常高的相似值可能是使用 ChatGPT 作为翻译器的副作用。为了测试这一点，我们下载了 <a href=\"https://help.ted.com/hc/en-us/articles/360018572954-How-do-I-find-transcripts-for-TED-and-TEDx-talks?ref=jina-ai-gmbh.ghost.io\">TED Talks 的英语和德语人工翻译文本</a>，并检查对齐的翻译句子是否具有相同的高相关性。</p><p>结果比我们的机器翻译数据更强，从下图可以看出。</p><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--10-.png\" class=\"kg-image\" alt=\"Graph of cross-lingual alignment density EN-DE with peak around cosine similarity 1.0, titled &quot;jina-embeddings-v3: Cross-ling\" loading=\"lazy\" width=\"988\" height=\"590\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/image--10-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/image--10-.png 988w\" sizes=\"(min-width: 720px) 720px\"></figure><h2 id=\"how-much-does-cross-language-data-contribute-to-cross-language-alignment\">跨语言数据对跨语言对齐的贡献有多大？</h2><p>消失的语言差距和高水平的跨语言性能似乎与明确的跨语言训练数据的很小部分不成比例。只有 3% 的对比训练数据专门教导模型如何在语言之间进行对齐。</p><p>因此，我们进行了一个测试，看看跨语言是否真的有任何贡献。</p><p>完全不使用任何跨语言数据重新训练 <code>jina-embeddings-v3</code> 对于一个小实验来说代价太大了，所以我们从 Hugging Face 下载了 <a href=\"https://huggingface.co/FacebookAI/xlm-roberta-base?ref=jina-ai-gmbh.ghost.io\"><code>xlm-roberta-base</code> 模型</a>，并使用我们训练 <code>jina-embeddings-v3</code> 时使用的部分数据进行对比学习进一步训练。我们专门调整了跨语言数据的数量来测试两种情况：一种是没有跨语言数据，另一种是 20% 的对是跨语言的。你可以在下表中看到训练的元参数：</p>\n<!--kg-card-begin: html-->\n<table id=\"e30425bb-015e-4956-8872-b1b64cdd7ad0\" class=\"simple-table\"><tbody><tr id=\"daa3cfcc-9012-411b-8da3-05c7c6f4b371\"><td id=\"<j<o\" class=\"\" style=\"width:187.9375px\"><strong>Backbone</strong></td><td id=\"DU<d\" class=\"\"><strong>% Cross-Language</strong></td><td id=\"@Feo\" class=\"\"><strong>Learning Rate</strong></td><td id=\"fZNx\" class=\"\"><strong>Loss Function</strong></td><td id=\"Rv}\\\" class=\"\"><strong>Temperature</strong></td></tr><tr id=\"f3a2d068-d902-4fc1-8c89-269a5ebbb135\"><td id=\"<j<o\" class=\"\" style=\"width:187.9375px\"><code>xlm-roberta-base </code><strong>without</strong> X-language data</td><td id=\"DU<d\" class=\"\">0%</td><td id=\"@Feo\" class=\"\">5e-4</td><td id=\"fZNx\" class=\"\">InfoNCE</td><td id=\"Rv}\\\" class=\"\">0.05</td></tr><tr id=\"52887e22-326c-46cd-b79c-d6dcd110c1d2\"><td id=\"<j<o\" class=\"\" style=\"width:187.9375px\"><code>xlm-roberta-base</code><strong> with </strong>X-language data</td><td id=\"DU<d\" class=\"\">20%</td><td id=\"@Feo\" class=\"\">5e-4</td><td id=\"fZNx\" class=\"\">InfoNCE</td><td id=\"Rv}\\\" class=\"\">0.05</td></tr></tbody></table>\n<!--kg-card-end: html-->\n<p>然后，我们使用来自 MTEB 的 <a href=\"https://github.com/embeddings-benchmark/mteb?ref=jina-ai-gmbh.ghost.io\">STS17 和 STS22 基准测试</a>和 Spearman 相关性评估了两个模型的跨语言性能。我们在下面展示结果：</p><h3 id=\"sts17\"><strong>STS17</strong></h3><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-6---1-.png\" class=\"kg-image\" alt=\"Bar graph showing Spearman correlation for language pairs on STS17 with and without parallel corpus.\" loading=\"lazy\" width=\"2000\" height=\"1032\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-6---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-6---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-6---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-6---1-.png 2133w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table id=\"de30bf7f-d1a9-43f4-8e5f-15bf65c59674\" class=\"simple-table\"><tbody><tr id=\"5c6440a6-eba9-404a-a5f1-88099bc6702d\"><td id=\"{N[x\" class=\"\"><strong>Language Pair</strong></td><td id=\"jGmJ\" class=\"\"><strong>With parallel corpora</strong></td><td id=\"p<ZH\" class=\"\"><strong>Without parallel corpora</strong></td></tr><tr id=\"33f08461-58aa-43f3-9ed1-577f8676e99d\"><td id=\"{N[x\" class=\"\">English ↔ Arabic</td><td id=\"jGmJ\" class=\"\"><strong>0.6418</strong></td><td id=\"p<ZH\" class=\"\">0.5875</td></tr><tr id=\"9875386d-2043-4d9d-8252-e53ec525ec29\"><td id=\"{N[x\" class=\"\">English ↔ German</td><td id=\"jGmJ\" class=\"\">0.7364</td><td id=\"p<ZH\" class=\"\"><strong>0.7390</strong></td></tr><tr id=\"15d28a12-3a80-4176-9984-69b5d8a7d8ff\"><td id=\"{N[x\" class=\"\">English ↔ Spanish</td><td id=\"jGmJ\" class=\"\"><strong>0.6968</strong></td><td id=\"p<ZH\" class=\"\">0.6799</td></tr><tr id=\"21821558-c8b9-4c34-8ec5-9db3ca7d9328\"><td id=\"{N[x\" class=\"\">English ↔ French</td><td id=\"jGmJ\" class=\"\"><strong>0.7066</strong></td><td id=\"p<ZH\" class=\"\">0.6944</td></tr><tr id=\"a2e3b5e5-8e4a-4270-abff-5d059ff6be72\"><td id=\"{N[x\" class=\"\">English ↔ Italian</td><td id=\"jGmJ\" class=\"\"><strong>0.7232</strong></td><td id=\"p<ZH\" class=\"\">0.7070</td></tr><tr id=\"95daf20f-2a82-4431-8581-a4ce24d81462\"><td id=\"{N[x\" class=\"\">English ↔ Dutch</td><td id=\"jGmJ\" class=\"\"><strong>0.7597</strong></td><td id=\"p<ZH\" class=\"\">0.7468</td></tr><tr id=\"4fd4c45a-a69e-4e33-b057-9c5f10b99fdb\"><td id=\"{N[x\" class=\"\">English ↔ Turkish</td><td id=\"jGmJ\" class=\"\"><strong>0.6933</strong></td><td id=\"p<ZH\" class=\"\">0.6050</td></tr></tbody></table>\n<!--kg-card-end: html-->\n<h3 id=\"sts22\"><strong>STS22</strong></h3><figure class=\"kg-card kg-image-card\"><img src=\"https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-7---1-.png\" class=\"kg-image\" alt=\"Chart comparing models of language alignment, showing Spearman correlation scores for eight language pairs with and without p\" loading=\"lazy\" width=\"2000\" height=\"1032\" srcset=\"https://jina-ai-gmbh.ghost.io/content/images/size/w600/2024/10/output-7---1-.png 600w, https://jina-ai-gmbh.ghost.io/content/images/size/w1000/2024/10/output-7---1-.png 1000w, https://jina-ai-gmbh.ghost.io/content/images/size/w1600/2024/10/output-7---1-.png 1600w, https://jina-ai-gmbh.ghost.io/content/images/2024/10/output-7---1-.png 2133w\" sizes=\"(min-width: 720px) 720px\"></figure>\n<!--kg-card-begin: html-->\n<table id=\"e53757df-8a0e-42ec-ba05-715baa3c77cd\" class=\"simple-table\"><tbody><tr id=\"45c43b8c-b1b7-4ac0-91b0-1e07025f1b92\"><td id=\"OF=p\" class=\"\"><strong>语言对</strong></td><td id=\"P<\\i\" class=\"\"><strong>使用平行语料库</strong></td><td id=\"LAtp\" class=\"\"><strong>不使用平行语料库</strong></td></tr><tr id=\"696ebe11-3eda-49ef-8dfe-608f9b71430b\"><td id=\"OF=p\" class=\"\">英语 ↔ 西班牙语</td><td id=\"P<\\i\" class=\"\"><strong>0.7710</strong></td><td id=\"LAtp\" class=\"\">0.7675</td></tr><tr id=\"eb4c1d81-7d98-453d-af3f-95b2adccfb55\"><td id=\"OF=p\" class=\"\">简体中文 ↔ 英语</td><td id=\"P<\\i\" class=\"\"><strong>0.6885</strong></td><td id=\"LAtp\" class=\"\">0.6860</td></tr><tr id=\"533cefd3-b30e-4d6a-9350-8f5d28b17ba6\"><td id=\"OF=p\" class=\"\">西班牙语 ↔ 意大利语</td><td id=\"P<\\i\" class=\"\"><strong>0.6829</strong></td><td id=\"LAtp\" class=\"\">0.6814</td></tr><tr id=\"d3ecdd71-44bb-4a3b-9ac2-8cc90a785d5f\"><td id=\"OF=p\" class=\"\">德语 ↔ 法语</td><td id=\"P<\\i\" class=\"\"><strong>0.5763</strong></td><td id=\"LAtp\" class=\"\">0.5496</td></tr><tr id=\"c6242853-4da7-4369-b1f1-1a27262a487a\"><td id=\"OF=p\" class=\"\">德语 ↔ 英语</td><td id=\"P<\\i\" class=\"\">0.5439</td><td id=\"LAtp\" class=\"\"><strong>0.5566</strong></td></tr><tr id=\"31a4a5ba-199c-4904-b926-ff0561aac1b5\"><td id=\"OF=p\" class=\"\">波兰语 ↔ 英语</td><td id=\"P<\\i\" class=\"\">0.6966</td><td id=\"LAtp\" class=\"\"><strong>0.7156</strong></td></tr><tr id=\"4f529d81-e8c9-4e5d-a705-36e357abebc3\"><td id=\"OF=p\" class=\"\">德语 ↔ 英语</td><td id=\"P<\\i\" class=\"\"><strong>0.5832</strong></td><td id=\"LAtp\" class=\"\">0.5478</td></tr><tr id=\"cd1429f7-c810-4a0e-9dca-88e2c83157bc\"><td id=\"OF=p\" class=\"\">法语 ↔ 波兰语</td><td id=\"P<\\i\" class=\"\">0.8451</td><td id=\"LAtp\" class=\"\">0.8451</td></tr></tbody></table>\n<!--kg-card-end: html-->\n<p>令我们惊讶的是，对于我们测试的大多数语言对，跨语言训练数据几乎没有带来任何改进。虽然很难确定这个结论对于使用更大数据集的完整训练模型是否仍然成立，但这确实证明了显式的跨语言训练并没有带来太多益处。</p><p>然而，需要注意的是，STS17 包含了英语/阿拉伯语和英语/土耳其语这两个语言对。这两种语言在我们的训练数据中的代表性都相对较低。我们使用的 XML-RoBERTa 模型在预训练数据中，阿拉伯语占 2.25%，土耳其语占 2.32%，远低于我们测试的其他语言。在这个实验中使用的小型对比学习数据集中，阿拉伯语仅占 1.7%，土耳其语仅占 1.8%。</p><p>这两个语言对是测试中唯一显示出跨语言数据训练能带来明显差异的语言对。我们认为，对于在训练数据中代表性较低的语言来说，显式的跨语言数据可能更有效，但在得出结论之前还需要进行更多探索。跨语言数据在对比训练中的作用和效果是 Jina AI 正在积极研究的领域。</p><h2 id=\"conclusion\">结论</h2><p>传统的语言预训练方法，如掩码语言建模，会留下一个\"语言差距\"，导致不同语言中语义相似的文本无法像预期那样紧密对齐。我们已经证明，Jina Embeddings 的对比学习方法在减少甚至消除这个差距方面非常有效。</p><p>这种方法有效的原因尚不完全清楚。我们在对比训练中确实使用了显式的跨语言文本对，但数量很小，而且它们在确保高质量跨语言结果方面实际发挥了多大作用还不清楚。我们尝试在更受控的条件下展示明确的效果，但并未得到明确的结果。</p><p>然而，<strong>很明显 <code>jina-embeddings-v3</code> 已经克服了预训练中的语言差距，成为了多语言应用的强大工具。</strong>它已经可以用于任何需要在多种语言中实现相同强大性能的任务。</p><p>您可以通过我们的 <a href=\"https://jina.ai/embeddings?ref=jina-ai-gmbh.ghost.io\">Embeddings API</a>（提供一百万个免费令牌）或通过 AWS 或 Azure 使用 <code>jina-embeddings-v3</code>。如果您想在这些平台之外或在公司内部使用它，请记住它是在 CC BY-NC 4.0 许可下发布的。如果您对商业使用感兴趣，请<a href=\"https://jina.ai/contact-sales?ref=jina-ai-gmbh.ghost.io\">联系我们</a>。</p>",
  "comment_id": "67066bd652567c0001d0f2cd",
  "feature_image": "https://jina-ai-gmbh.ghost.io/content/images/2024/10/gap-blog-1.jpg",
  "featured": false,
  "visibility": "public",
  "created_at": "2024-10-09T13:41:10.000+02:00",
  "updated_at": "2024-10-10T20:15:26.000+02:00",
  "published_at": "2024-10-09T14:42:22.000+02:00",
  "custom_excerpt": "Multilingual models often face a \"language gap,\" where similar phrases in different languages don't align. We show how contrastive learning can bridge this gap, enhancing cross-language performance.",
  "codeinjection_head": null,
  "codeinjection_foot": null,
  "custom_template": null,
  "canonical_url": null,
  "authors": [
    {
      "id": "6360e7e05e0f6e004d70bd99",
      "name": "Bo Wang",
      "slug": "bo",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/4B483B29-E306-402B-8635-64866C458406.jpeg",
      "cover_image": null,
      "bio": "Developer @Jina, Contributor to open source ",
      "website": "https://bwanglzu.github.io/",
      "location": "Berlin",
      "facebook": null,
      "twitter": "@bo_wangbo",
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/bo/"
    },
    {
      "id": "632ae7353e4e55003d52598e",
      "name": "Scott Martens",
      "slug": "scott",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/photo-of-me-cropped.jpg",
      "cover_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/shanshui-ernie-crop.png",
      "bio": "A rogue AI created by Canada's Weapon X program.\n\nContent Creator @ Jina AI",
      "website": "https://jina.ai",
      "location": "Berlin",
      "facebook": null,
      "twitter": null,
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/scott/"
    },
    {
      "id": "632ade4a3e4e55003d525971",
      "name": "Alex C-G",
      "slug": "alexcg",
      "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/09/alex.jpg",
      "cover_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/twitter_banner.jpg",
      "bio": "Open-source Evangelist @ Jina AI. Old, grim, and full of Vim",
      "website": null,
      "location": "Berlin, Germany",
      "facebook": null,
      "twitter": "@alexcg",
      "meta_title": null,
      "meta_description": null,
      "url": "https://jina-ai-gmbh.ghost.io/author/alexcg/"
    }
  ],
  "tags": [
    {
      "id": "634a1a8ccebfc1003d8ab706",
      "name": "Tech Blog",
      "slug": "tech-blog",
      "description": null,
      "feature_image": null,
      "visibility": "public",
      "og_image": null,
      "og_title": null,
      "og_description": null,
      "twitter_image": null,
      "twitter_title": null,
      "twitter_description": null,
      "meta_title": null,
      "meta_description": null,
      "codeinjection_head": null,
      "codeinjection_foot": null,
      "canonical_url": null,
      "accent_color": null,
      "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
    }
  ],
  "primary_author": {
    "id": "6360e7e05e0f6e004d70bd99",
    "name": "Bo Wang",
    "slug": "bo",
    "profile_image": "https://jina-ai-gmbh.ghost.io/content/images/2022/11/4B483B29-E306-402B-8635-64866C458406.jpeg",
    "cover_image": null,
    "bio": "Developer @Jina, Contributor to open source ",
    "website": "https://bwanglzu.github.io/",
    "location": "Berlin",
    "facebook": null,
    "twitter": "@bo_wangbo",
    "meta_title": null,
    "meta_description": null,
    "url": "https://jina-ai-gmbh.ghost.io/author/bo/"
  },
  "primary_tag": {
    "id": "634a1a8ccebfc1003d8ab706",
    "name": "Tech Blog",
    "slug": "tech-blog",
    "description": null,
    "feature_image": null,
    "visibility": "public",
    "og_image": null,
    "og_title": null,
    "og_description": null,
    "twitter_image": null,
    "twitter_title": null,
    "twitter_description": null,
    "meta_title": null,
    "meta_description": null,
    "codeinjection_head": null,
    "codeinjection_foot": null,
    "canonical_url": null,
    "accent_color": null,
    "url": "https://jina-ai-gmbh.ghost.io/tag/tech-blog/"
  },
  "url": "https://jina-ai-gmbh.ghost.io/podcast/bridging-language-gaps-in-multilingual-embeddings-via-contrastive-learning/",
  "excerpt": "多语言模型经常面临\"语言差距\"问题，即不同语言中相似的短语无法对齐。我们展示了对比学习如何能够弥合这一差距，提升跨语言性能。",
  "reading_time": 13,
  "access": true,
  "comments": false,
  "og_image": null,
  "og_title": null,
  "og_description": null,
  "twitter_image": null,
  "twitter_title": null,
  "twitter_description": null,
  "meta_title": null,
  "meta_description": null,
  "email_subject": null,
  "frontmatter": null,
  "feature_image_alt": "Neon green squares form intricate patterns on a black digital background, creating a dynamic, abstract design.",
  "feature_image_caption": null
}