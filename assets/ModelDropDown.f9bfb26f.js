import{bU as _e,aW as ye,bV as ve,bW as we,H as ke,P as L,W as Me,bA as ze,e as $e,ae as Ae,ay as J,ax as Ie,f as q,h as Z,w as qe,K as Se,J as Ee,ad as je,ag as k,ah as r,an as d,ai as M,am as l,bF as Ke,bE as xe,av as X,a4 as Y,al as ee,ap as f,aq as g,ao as ae,at as A,as as Fe,bn as te,b5 as Te,aC as De,bo as Ce}from"./index.bb319656.js";import{a as S,b as _}from"./plugin-vue_export-helper.9a38ce6f.js";import{Q as y}from"./QTooltip.5708199b.js";import{a as Le}from"./QLinearProgress.3a4dc673.js";import{c as Pe}from"./copy-to-clipboard.b5bacc57.js";const v="https://embeddings-dashboard-api.jina.ai",C="https://api.jina.ai";var Be=(e=>(e.CONSUME="consume",e.PURCHASE="purchase",e.TRIAL="trial",e))(Be||{}),Re=(e=>(e.IN_PROGRESS="in-progress",e.FAILED="failed",e.COMPLETED="completed",e))(Re||{});const Oe=["price_1PqrlqEoTOtb5eZvFh1Vhdm6","price_1PqrnpEoTOtb5eZv3woXVYU1"],Ve=_e("embedding",{state:()=>({apiKey:"",apiKeyInfo:void 0,isApiKeyLoading:!1,isApiKeyInfoLoading:!1,models:[],products:[],testData:[],userDocuments:"",userSearchDocs:"",userVisualizeDocs:""}),persist:{paths:["apiKey","testData","apiKeyInfo"]},getters:{baseEnModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-en"),jinaRerankerV1:e=>e.models.find(a=>a.name==="jina-reranker-v1-base-en"),jinaRerankerMultilingual:e=>e.models.find(a=>a.name==="jina-reranker-v2-base-multilingual"),clipV1:e=>e.models.find(a=>a.name==="jina-clip-v1"),baseZhModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-zh"),baseDeModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-de"),newModels:e=>e.models.filter(a=>new Date().getTime()-new Date(a.created_at).getTime()<1e3*60*60*24*30).map(a=>a.name),apiKeyTokens:e=>{var a,t;return(t=(a=e.apiKeyInfo)==null?void 0:a.wallet.total_balance)!=null?t:0},isPaidUser:e=>{var a;return!!((a=e.apiKeyInfo)!=null&&a.email)},isAutoCharge:e=>{var a,t;return!!((a=e.apiKeyInfo)!=null&&a.email)||((t=e.apiKeyInfo)==null?void 0:t.metadata.auto_recharge)}},actions:{setApiKeyInfo(e){!e||(this.apiKeyInfo=JSON.parse(JSON.stringify(e)))},async getReplicas(e,a){try{const t=await fetch(`${v}/api/v1/models/slug/${a}`,{method:"GET"});if(!t.ok)throw new Error(`getReplicas error! Status: ${t.status}`);return(await t.json()).num_replicas}catch(t){console.error("getReplicas error:",t)}},async generateApiKey(e){this.isApiKeyLoading=!0;const a=new FormData;a.set("cf-turnstile-response",e);try{const t=await fetch(`${v}/api/v1/api_key`,{method:"POST",body:a});if(!t.ok)throw new Error(`getApiKey error! Status: ${t.status}`);const s=await t.json();return this.apiKey=s.api_key,!0}catch(t){return console.error("getApiKey error:",t),!1}finally{this.isApiKeyLoading=!1}},async getCurrentKeyInfo(){this.isApiKeyInfoLoading=!0;try{const e=await fetch(`${v}/api/v1/api_key/user?api_key=${this.apiKey}`);if(e.ok){this.apiKeyInfo=await e.json();return}this.apiKeyInfo=void 0,console.error(`getTokens error! Status: ${e.status}`)}catch(e){this.apiKeyInfo=void 0,console.error("getTokens error:",e)}finally{this.isApiKeyInfoLoading=!1}},async getKeyInfo(e){if(!!e){this.isApiKeyInfoLoading=!0;try{const a=await fetch(`${v}/api/v1/api_key/user?api_key=${e}`);return a.ok?await a.json():void 0}catch{return}finally{this.isApiKeyInfoLoading=!1}}},async getModels(){try{const e=await fetch(`${v}/api/v1/models`);if(!e.ok)throw new Error(`getModels error! Status: ${e.status}`);const a=await e.json();this.models=a,console.log("getModels data:",a)}catch(e){console.error("getModels error:",e)}},async getProducts(){try{const e=await fetch(`${v}/api/v1/product`);if(!e.ok)throw new Error(`getProducts error! Status: ${e.status}`);let a=await e.json();a=a.filter(t=>Oe.includes(t.price_id)),a.unshift({id:"0",product_id:"0",product_name:"1M tokens",product_description:"A pack of 1 million tokens",price:0,price_id:"0",currency:"USD",token_quantity:1e6}),console.log("getProducts data:",a),this.products=a}catch(e){console.error("getProducts error:",e)}},async getUsage(e){try{const a=await fetch(`${v}/api/v1/billing/transaction`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)throw new Error(`getUsage error! Status: ${a.status}`);return await a.json()}catch(a){console.error("getUsage error:",a)}},async checkoutWithStripe(e,a){try{const t=await fetch(`${v}/api/v1/checkout_session`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a),mode:"cors",credentials:"include"});if(!t.ok)throw new Error(`checkoutWithStripe error! Status: ${t.status}`);return await t.json()}catch(t){console.error("checkoutWithStripe error:",t)}},async bulkEmbedding(e,a){var z,$;const t={accept:"application/json",Authorization:`Bearer ${e}`},s=new FormData;s.append("model",a.model),s.append("email",(z=a.email)!=null?z:""),s.append("file",a.file);const i=await fetch(`${C}/v1/bulk-embeddings`,{method:"POST",headers:t,body:s});if(i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText||(($=await i.json())==null?void 0:$.detail)}`)},async checkBulk(e,a){var i;const t={accept:"application/json",Authorization:`Bearer ${e}`},s=await fetch(`${C}/v1/bulk-embeddings/${a}`,{method:"GET",headers:t});if(s.ok)return await s.json();throw new Error(`${s.status}: ${s.statusText||((i=await s.json())==null?void 0:i.detail)}`)},async getBulkResult(e,a){var i;const t={accept:"application/json",Authorization:`Bearer ${e}`},s=await fetch(`${C}/v1/bulk-embeddings/${a}/download-result`,{method:"POST",headers:t});if(s.ok){const{download_url:z}=await s.json();return z}else throw new Error(`${s.status}: ${s.statusText||((i=await s.json())==null?void 0:i.detail)}`)},async cancelAutoRecharge(e){const a=await fetch(`${v}/api/v1/cancel_auto_recharge`,{method:"POST",headers:{accept:"application/json",Authorization:`Bearer ${e}`}});if(a.ok)return!0;throw new Error(`Disable auto-recharge error! Status: ${a.status}`)}}});function ne(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}var Ue=ye({name:"close-popup",beforeMount(e,{value:a}){const t={depth:ne(a),handler(s){t.depth!==0&&setTimeout(()=>{const i=ve(e);i!==void 0&&we(i,s,t.depth)})},handlerKey(s){ke(s,13)===!0&&t.handler(s)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:a,oldValue:t}){a!==t&&(e.__qclosepopup.depth=ne(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}});function Ne(e){const a=Object.assign({noopener:!0},e),t=[];for(const s in a){const i=a[s];i===!0?t.push(s):(ze(i)||typeof i=="string"&&i!=="")&&t.push(s+"="+i)}return t.join(",")}function oe(e,a,t){let s=window.open;if(L.is.cordova===!0){if(cordova!==void 0&&cordova.InAppBrowser!==void 0&&cordova.InAppBrowser.open!==void 0)s=cordova.InAppBrowser.open;else if(navigator!==void 0&&navigator.app!==void 0)return navigator.app.loadUrl(e,{openExternal:!0})}const i=s(e,"_blank",Ne(t));if(i)return L.is.desktop&&i.focus(),i;a&&a()}var We=(e,a,t)=>{if(L.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(s=>{s?window.SafariViewController.show({url:e},Me,a):oe(e,a,t)});return}return oe(e,a,t)};const se=[{name:"bge-small-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-small-en",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-m3",meta_data:{token_length:1024,output_dim:2048,size:"1.3B",language:"multilingual"},request_path:["embedding"]}],Ye=$e({__name:"ModelDropDown",props:{currentModel:{},indicator:{type:Boolean,default:!0},category:{default:"embedding"},allowNone:{type:Boolean,default:!1},allowBAAI:{type:Boolean,default:!1},spaceSaving:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["chooseModel","modelsLoaded","switchToRerankerTab","switchToEmbeddingTab"],setup(e,{emit:a}){const{t}=Ae({useScope:"global"}),s=Ve(),{models:i,baseDeModel:z,baseEnModel:$,baseZhModel:re,clipV1:ie,jinaRerankerMultilingual:le}=J(s),de=Ie(),{language:E}=J(de),F=q(null);let p=null;const j=q(!1),w=e,b=a,h=Z({get:()=>w.currentModel,set:n=>{b("chooseModel",n)}}),P=()=>{var n;b("chooseModel",(n=re.value)!=null?n:$.value)},B=()=>{var n;b("chooseModel",(n=z.value)!=null?n:$.value)};qe(E,n=>{w.category==="multi-embeddings"&&(n&&["zh-CN","zh-TW"].includes(n)?P():n==="de"&&B())});const ue=()=>{var u;const n=((u=F.value)==null?void 0:u.$el)||F.value;n instanceof HTMLElement?(p=new IntersectionObserver(async c=>{if(c[0].isIntersecting){p==null||p.unobserve(n);try{await me(),p==null||p.disconnect()}catch(m){console.error("Failed to load models:",m),p==null||p.observe(n)}}},{root:null,threshold:.1}),p.observe(n)):console.error("Element is not an HTMLElement:",n)};Se(()=>{Ee(()=>{setTimeout(()=>{ue()},100)})}),je(()=>{p&&p.disconnect()});const R=Z(()=>{const n=i.value.filter(u=>{const c=w.category==="multi-embeddings",o=u.request_path,m=c?["multi-embeddings","embedding"]:[w.category];return Array.isArray(o)?o.some(x=>m.includes(x)):m.includes(o)}).sort((u,c)=>new Date(c.release_date).getTime()-new Date(u.release_date).getTime());if(n.length>1){const[u,c,...o]=n;return[c,u,...o]}return n}),I=q([]),K=q([]),ce=()=>{w.allowBAAI?I.value=se:I.value=R.value,K.value=I.value},pe=(n,u)=>{u(()=>{n?K.value=I.value.filter(c=>c.name.toLowerCase().includes(n.toLowerCase())):K.value=I.value})},me=async()=>{var o;j.value=!0,(o=i.value)!=null&&o.length||await s.getModels(),j.value=!1,ce();const n=new URL(window.location.href),u=n.searchParams.get("model"),c=u&&i.value.find(m=>m.name===u);if(c)b("chooseModel",c),n.searchParams.delete("model"),window.history.pushState({},"",n);else switch(w.category){case"embedding":case"multi-embeddings":case"fine-tuning":if(i.value.length>0)if(E.value&&["zh-CN","zh-TW"].includes(E.value))P();else if(E.value==="de")B();else if(w.allowBAAI)b("chooseModel",se[0]);else{const m=w.category==="fine-tuning"?$.value:ie.value;b("chooseModel",m)}break;case"rank":b("chooseModel",le.value);break}for(const m of R.value)m.replicas=await s.getReplicas(s.apiKey,m.name);b("modelsLoaded")},ge=n=>{fe("event","embedding_view_model_detail",{location:be.location.href,model:n}),We(`https://huggingface.co/jinaai/${n}`)},T=q(""),he=n=>{Pe(n).then(()=>{T.value=n}),setTimeout(()=>{T.value=""},1800)},fe=window.gtag,be=window.document,O=n=>n==="en"?"\u{1F1FA}\u{1F1F8}":n==="zh"?"\u{1F1E8}\u{1F1F3}\u{1F1FA}\u{1F1F8}":n==="de"?"\u{1F1E9}\u{1F1EA}\u{1F1FA}\u{1F1F8}":n==="es"?"\u{1F1EA}\u{1F1F8}\u{1F1FA}\u{1F1F8}":"\u{1F30D}";return(n,u)=>{var c;return M(),k(Le,{borderless:"",ref_key:"componentRef",ref:F,class:"cursor-pointer","use-input":"","fill-input":"",filled:"",square:"","hide-selected":"","input-debounce":"0",modelValue:h.value,"onUpdate:modelValue":u[1]||(u[1]=o=>h.value=o),"display-value":(c=h.value)==null?void 0:c.name,options:K.value,"option-label":o=>o.name,"option-value":o=>o.name,loading:j.value,disable:j.value||n.disabled,"label-color":"grey-5",label:n.category==="rank"?d(t)("embedding.select_rerank_model"):d(t)("embedding.select_embedding_model"),onFilter:pe},{prepend:r(()=>[l(X,{name:n.spaceSaving?void 0:"img:"+(n.category==="rank"?d(Ke):d(xe))},null,8,["name"])]),"no-option":r(()=>[n.allowNone?Y((M(),k(ee,{key:0,clickable:"",active:!n.currentModel,onClick:u[0]||(u[0]=o=>b("chooseModel",null)),class:"q-pa-md"},{default:r(()=>[l(ae,null,{default:r(()=>[l(S,{overline:"",caption:""},{default:r(()=>[f(g(d(t)("embedding.none")),1)]),_:1}),l(S,{class:"text-weight-bold"},{default:r(()=>[f(g(d(t)(`embedding.${n.category}_none_description`)),1)]),_:1})]),_:1})]),_:1},8,["active"])),[[Ce],[Ue]]):A("",!0)]),option:r(({opt:o,itemProps:m})=>{var x;return[l(ee,De(m,{active:o.name===((x=h.value)==null?void 0:x.name),class:"q-pa-md"}),{default:r(()=>[l(ae,null,{default:r(()=>[l(S,{class:"text-weight-bold"},{default:r(()=>[Fe("code",null,g(o.name),1),l(X,{class:"q-ml-sm cursor-pointer",name:T.value===o.name?"done":"content_copy",onClick:te(D=>he(o.name),["stop"])},null,8,["name","onClick"])]),_:2},1024),l(S,{overline:"",caption:""},{default:r(()=>[f(g(d(t)(`embedding.${o.name.replace(".","_")}_description`)),1)]),_:2},1024),l(S,{caption:"",class:"row"},{default:r(()=>{var D,V,U,N,W,Q,G,H;return[n.allowBAAI?A("",!0):(M(),k(_,{key:0,label:o.replicas>0?d(t)("embedding.running"):d(t)("embedding.sleeping"),square:"",size:"xs",outline:"",icon:o.replicas>0?"play_circle_filled":"mdi-sleep",color:o.replicas>0?"positive":"warning",style:{"border-radius":"0"}},{default:r(()=>[l(y,{"max-width":"300px"},{default:r(()=>[f(g(d(t)("embedding.status_explain")),1)]),_:1})]),_:2},1032,["label","icon","color"])),o.tags&&o.tags.includes("multimodal")?(M(),k(_,{key:1,square:"",size:"xs",outline:"",color:o.name!==((D=h.value)==null?void 0:D.name)?"grey-5":"",style:{"border-radius":"0"},label:d(t)("embedding.multimodal"),icon:"mms"},{default:r(()=>[l(y,null,{default:r(()=>[f(g(d(t)("embedding.multimodal_explain")),1)]),_:1})]),_:2},1032,["color","label"])):A("",!0),o.request_path.includes("multi-embeddings")&&n.category.includes("embedding")?(M(),k(_,{key:2,color:o.name!==((V=h.value)==null?void 0:V.name)?"grey-5":"",style:{"border-radius":"0"},icon:"grid_4x4",label:d(t)("embedding.multi_embedding"),square:"",size:"xs",outline:""},{default:r(()=>[l(y,null,{default:r(()=>[f(g(d(t)("embedding.multi_embedding_explain")),1)]),_:1})]),_:2},1032,["color","label"])):A("",!0),l(_,{label:o.meta_data.token_length,square:"",color:o.name!==((U=h.value)==null?void 0:U.name)?"grey-5":"",size:"xs",outline:"",icon:"notes",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[f(g(d(t)("embedding.token_length_explain",{_tokenLength:o.meta_data.token_length})),1)]),_:2},1024)]),_:2},1032,["label","color"]),o.request_path.includes("embedding")?(M(),k(_,{key:3,label:o.meta_data.output_dim,square:"",color:o.name!==((N=h.value)==null?void 0:N.name)?"grey-5":"",size:"xs",outline:"",icon:"mdi-axis-arrow",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[f(g(d(t)("embedding.output_dim_explain",{_outputDim:o.meta_data.output_dim})),1)]),_:2},1024)]),_:2},1032,["label","color"])):A("",!0),l(_,{label:o.meta_data.size,square:"",size:"xs",color:o.name!==((W=h.value)==null?void 0:W.name)?"grey-5":"",outline:"",icon:"mdi-matrix",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[f(g(d(t)("embedding.size_explain",{_size:o.meta_data.size})),1)]),_:2},1024)]),_:2},1032,["label","color"]),l(_,{label:O(o.meta_data.language),square:"",color:o.name!==((Q=h.value)==null?void 0:Q.name)?"grey-5":"",size:"xs",outline:"",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[f(g(d(t)("embedding.language_explain",{_language:O(o.meta_data.language)})),1)]),_:2},1024)]),_:2},1032,["label","color"]),Y(l(_,{icon:"img:/huggingface_logo.svg",square:"",size:"xs",outline:"",color:o.name!==((G=h.value)==null?void 0:G.name)?"grey-5":"",style:{"border-radius":"0"},onClick:te(Qe=>ge(o.name),["stop"]),clickable:""},{default:r(()=>[l(y,null,{default:r(()=>[f(g(d(t)("embedding.opensource_explain")),1)]),_:1})]),_:2},1032,["color","onClick"]),[[Te,o.name!=="jina-reranker-v1-base-en"]]),o.release_date?(M(),k(_,{key:4,square:"",size:"xs",outline:"",color:o.name!==((H=h.value)==null?void 0:H.name)?"grey-5":"",style:{"border-radius":"0"},label:o.release_date,icon:"calendar_month"},{default:r(()=>[l(y,{"max-width":"300px"},{default:r(()=>[f(g(d(t)("embedding.add_time_explain")),1)]),_:1})]),_:2},1032,["color","label"])):A("",!0)]}),_:2},1024)]),_:2},1024)]),_:2},1040,["active"])]}),_:1},8,["modelValue","display-value","options","option-label","option-value","loading","disable","label"])}}});export{Re as B,Ue as C,Be as T,Ye as _,Ve as u};
