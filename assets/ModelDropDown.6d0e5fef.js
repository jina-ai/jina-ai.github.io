import{bS as ce,aW as pe,bT as me,bU as ge,H as he,P as L,W as fe,bz as be,e as _e,ae as ye,ay as ve,f as I,h as W,K as we,J as ke,ad as Me,ag as k,ah as r,an as u,ai as M,am as l,bF as ze,bE as $e,av as H,a4 as J,al as G,ap as h,aq as m,ao as Z,at as z,as as Ae,bn as X,b5 as Ie,aC as qe,bo as Ee}from"./index.f2133274.js";import{a as q,b}from"./plugin-vue_export-helper.0bfb9584.js";import{Q as _}from"./QTooltip.352afa44.js";import{a as Se}from"./QLinearProgress.c2d7504b.js";import{c as je}from"./copy-to-clipboard.f2c1f7d6.js";const y="https://embeddings-dashboard-api.jina.ai",D="https://api.jina.ai";var Ke=(e=>(e.CONSUME="consume",e.PURCHASE="purchase",e.TRIAL="trial",e))(Ke||{}),Fe=(e=>(e.IN_PROGRESS="in-progress",e.FAILED="failed",e.COMPLETED="completed",e))(Fe||{});const xe=["price_1PqrlqEoTOtb5eZvFh1Vhdm6","price_1PqrnpEoTOtb5eZv3woXVYU1"],Te=ce("embedding",{state:()=>({apiKey:"",apiKeyInfo:void 0,isApiKeyLoading:!1,isApiKeyInfoLoading:!1,models:[],products:[],testData:[],userDocuments:"",userSearchDocs:"",userVisualizeDocs:""}),persist:{paths:["apiKey","testData","apiKeyInfo"]},getters:{baseEnModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-en"),jinaRerankerV1:e=>e.models.find(a=>a.name==="jina-reranker-v1-base-en"),jinaRerankerMultilingual:e=>e.models.find(a=>a.name==="jina-reranker-v2-base-multilingual"),clipV1:e=>e.models.find(a=>a.name==="jina-clip-v1"),baseZhModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-zh"),baseDeModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-de"),embeddingsV3:e=>e.models.find(a=>a.name==="jina-embeddings-v3"),newModels:e=>e.models.filter(a=>new Date().getTime()-new Date(a.created_at).getTime()<1e3*60*60*24*30).map(a=>a.name),apiKeyTokens:e=>{var a,t;return(t=(a=e.apiKeyInfo)==null?void 0:a.wallet.total_balance)!=null?t:0},isPaidUser:e=>{var a;return!!((a=e.apiKeyInfo)!=null&&a.email)},isAutoCharge:e=>{var a,t;return!!((a=e.apiKeyInfo)!=null&&a.email)||((t=e.apiKeyInfo)==null?void 0:t.metadata.auto_recharge)}},actions:{setApiKeyInfo(e){!e||(this.apiKeyInfo=JSON.parse(JSON.stringify(e)))},async getReplicas(e,a){try{const t=await fetch(`${y}/api/v1/models/slug/${a}`,{method:"GET"});if(!t.ok)throw new Error(`getReplicas error! Status: ${t.status}`);return(await t.json()).num_replicas}catch(t){console.error("getReplicas error:",t)}},async generateApiKey(e){this.isApiKeyLoading=!0;const a=new FormData;a.set("cf-turnstile-response",e);try{const t=await fetch(`${y}/api/v1/api_key`,{method:"POST",body:a});if(!t.ok)throw new Error(`getApiKey error! Status: ${t.status}`);const o=await t.json();return this.apiKey=o.api_key,!0}catch(t){return console.error("getApiKey error:",t),!1}finally{this.isApiKeyLoading=!1}},async getCurrentKeyInfo(){this.isApiKeyInfoLoading=!0;try{const e=await fetch(`${y}/api/v1/api_key/user?api_key=${this.apiKey}`);if(e.ok){this.apiKeyInfo=await e.json();return}this.apiKeyInfo=void 0,console.error(`getTokens error! Status: ${e.status}`)}catch(e){this.apiKeyInfo=void 0,console.error("getTokens error:",e)}finally{this.isApiKeyInfoLoading=!1}},async getKeyInfo(e){if(!!e){this.isApiKeyInfoLoading=!0;try{const a=await fetch(`${y}/api/v1/api_key/user?api_key=${e}`);return a.ok?await a.json():void 0}catch{return}finally{this.isApiKeyInfoLoading=!1}}},async getModels(){try{const e=await fetch(`${y}/api/v1/models`);if(!e.ok)throw new Error(`getModels error! Status: ${e.status}`);const a=await e.json();this.models=a,console.log("getModels data:",a)}catch(e){console.error("getModels error:",e)}},async getProducts(){try{const e=await fetch(`${y}/api/v1/product`);if(!e.ok)throw new Error(`getProducts error! Status: ${e.status}`);let a=await e.json();a=a.filter(t=>xe.includes(t.price_id)),a.unshift({id:"0",product_id:"0",product_name:"1M tokens",product_description:"A pack of 1 million tokens",price:0,price_id:"0",currency:"USD",token_quantity:1e6}),console.log("getProducts data:",a),this.products=a}catch(e){console.error("getProducts error:",e)}},async getUsage(e){try{const a=await fetch(`${y}/api/v1/billing/transaction`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)throw new Error(`getUsage error! Status: ${a.status}`);return await a.json()}catch(a){console.error("getUsage error:",a)}},async checkoutWithStripe(e,a){try{const t=await fetch(`${y}/api/v1/checkout_session`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a),mode:"cors",credentials:"include"});if(!t.ok)throw new Error(`checkoutWithStripe error! Status: ${t.status}`);return await t.json()}catch(t){console.error("checkoutWithStripe error:",t)}},async bulkEmbedding(e,a){var $,E;const t={accept:"application/json",Authorization:`Bearer ${e}`},o=new FormData;o.append("model",a.model),o.append("email",($=a.email)!=null?$:""),o.append("file",a.file);const i=await fetch(`${D}/v1/bulk-embeddings`,{method:"POST",headers:t,body:o});if(i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText||((E=await i.json())==null?void 0:E.detail)}`)},async checkBulk(e,a){var i;const t={accept:"application/json",Authorization:`Bearer ${e}`},o=await fetch(`${D}/v1/bulk-embeddings/${a}`,{method:"GET",headers:t});if(o.ok)return await o.json();throw new Error(`${o.status}: ${o.statusText||((i=await o.json())==null?void 0:i.detail)}`)},async getBulkResult(e,a){var i;const t={accept:"application/json",Authorization:`Bearer ${e}`},o=await fetch(`${D}/v1/bulk-embeddings/${a}/download-result`,{method:"POST",headers:t});if(o.ok){const{download_url:$}=await o.json();return $}else throw new Error(`${o.status}: ${o.statusText||((i=await o.json())==null?void 0:i.detail)}`)},async cancelAutoRecharge(e){const a=await fetch(`${y}/api/v1/cancel_auto_recharge`,{method:"POST",headers:{accept:"application/json",Authorization:`Bearer ${e}`}});if(a.ok)return!0;throw new Error(`Disable auto-recharge error! Status: ${a.status}`)}}});function Y(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}var De=pe({name:"close-popup",beforeMount(e,{value:a}){const t={depth:Y(a),handler(o){t.depth!==0&&setTimeout(()=>{const i=me(e);i!==void 0&&ge(i,o,t.depth)})},handlerKey(o){he(o,13)===!0&&t.handler(o)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:a,oldValue:t}){a!==t&&(e.__qclosepopup.depth=Y(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}});function Le(e){const a=Object.assign({noopener:!0},e),t=[];for(const o in a){const i=a[o];i===!0?t.push(o):(be(i)||typeof i=="string"&&i!=="")&&t.push(o+"="+i)}return t.join(",")}function ee(e,a,t){let o=window.open;if(L.is.cordova===!0){if(cordova!==void 0&&cordova.InAppBrowser!==void 0&&cordova.InAppBrowser.open!==void 0)o=cordova.InAppBrowser.open;else if(navigator!==void 0&&navigator.app!==void 0)return navigator.app.loadUrl(e,{openExternal:!0})}const i=o(e,"_blank",Le(t));if(i)return L.is.desktop&&i.focus(),i;a&&a()}var Pe=(e,a,t)=>{if(L.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(o=>{o?window.SafariViewController.show({url:e},fe,a):ee(e,a,t)});return}return ee(e,a,t)};const ae=[{name:"bge-small-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-small-en",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-m3",meta_data:{token_length:1024,output_dim:2048,size:"1.3B",language:"multilingual"},request_path:["embedding"]}],Ne=_e({__name:"ModelDropDown",props:{currentModel:{},indicator:{type:Boolean,default:!0},category:{default:"embedding"},allowNone:{type:Boolean,default:!1},allowBAAI:{type:Boolean,default:!1},spaceSaving:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["chooseModel","modelsLoaded","switchToRerankerTab","switchToEmbeddingTab"],setup(e,{emit:a}){const{t}=ye({useScope:"global"}),o=Te(),{models:i,baseEnModel:$,embeddingsV3:E,jinaRerankerMultilingual:te}=ve(o),F=I(null);let p=null;const S=I(!1),v=e,w=a,g=W({get:()=>v.currentModel,set:s=>{w("chooseModel",s)}}),ne=()=>{var d;const s=((d=F.value)==null?void 0:d.$el)||F.value;s instanceof HTMLElement?(p=new IntersectionObserver(async c=>{if(c[0].isIntersecting){p==null||p.unobserve(s);try{await re(),p==null||p.disconnect()}catch(f){console.error("Failed to load models:",f),p==null||p.observe(s)}}},{root:null,threshold:.1}),p.observe(s)):console.error("Element is not an HTMLElement:",s)};we(()=>{ke(()=>{setTimeout(()=>{ne()},100)})}),Me(()=>{p&&p.disconnect()});const P=W(()=>i.value.filter(d=>{const c=v.category==="multi-embeddings",n=d.request_path,f=c?["multi-embeddings","embedding"]:[v.category];return Array.isArray(n)?n.some(K=>f.includes(K)):f.includes(n)}).sort((d,c)=>new Date(c.release_date).getTime()-new Date(d.release_date).getTime())),A=I([]),j=I([]),oe=()=>{v.allowBAAI?A.value=ae:A.value=P.value,j.value=A.value},se=(s,d)=>{d(()=>{s?j.value=A.value.filter(c=>c.name.toLowerCase().includes(s.toLowerCase())):j.value=A.value})},re=async()=>{var n;S.value=!0,(n=i.value)!=null&&n.length||await o.getModels(),S.value=!1,oe();const s=new URL(window.location.href),d=s.searchParams.get("model"),c=d&&i.value.find(f=>f.name===d);if(c)w("chooseModel",c),s.searchParams.delete("model"),window.history.pushState({},"",s);else switch(v.category){case"embedding":case"multi-embeddings":case"fine-tuning":i.value.length>0&&(v.allowBAAI?w("chooseModel",ae[0]):w("chooseModel",E.value));break;case"rank":w("chooseModel",te.value);break}for(const f of P.value)f.replicas=await o.getReplicas(o.apiKey,f.name);w("modelsLoaded")},ie=s=>{de("event","embedding_view_model_detail",{location:ue.location.href,model:s}),Pe(`https://huggingface.co/jinaai/${s}`)},x=I(""),le=s=>{let d="";switch(v.category){case"embedding":case"multi-embeddings":d="embeddings";break;case"rank":d="reranker";break;case"fine-tuning":d="tuning";break}const c=`${window.location.origin}?sui=${d}&model=${s}`;je(c).then(()=>{x.value=s}),setTimeout(()=>{x.value=""},1800)},de=window.gtag,ue=window.document,C=s=>s==="en"?"\u{1F1FA}\u{1F1F8}":s==="zh"?"\u{1F1E8}\u{1F1F3}\u{1F1FA}\u{1F1F8}":s==="de"?"\u{1F1E9}\u{1F1EA}\u{1F1FA}\u{1F1F8}":s==="es"?"\u{1F1EA}\u{1F1F8}\u{1F1FA}\u{1F1F8}":"\u{1F30D}";return(s,d)=>{var c;return M(),k(Se,{borderless:"",ref_key:"componentRef",ref:F,class:"cursor-pointer","use-input":"","fill-input":"",filled:"",square:"","hide-selected":"","input-debounce":"0",modelValue:g.value,"onUpdate:modelValue":d[1]||(d[1]=n=>g.value=n),"display-value":(c=g.value)==null?void 0:c.name,options:j.value,"option-label":n=>n.name,"option-value":n=>n.name,loading:S.value,disable:S.value||s.disabled,"label-color":"grey-5",label:s.category==="rank"?u(t)("embedding.select_rerank_model"):u(t)("embedding.select_embedding_model"),onFilter:se},{prepend:r(()=>[l(H,{name:s.spaceSaving?void 0:"img:"+(s.category==="rank"?u(ze):u($e))},null,8,["name"])]),"no-option":r(()=>[s.allowNone?J((M(),k(G,{key:0,clickable:"",active:!s.currentModel,onClick:d[0]||(d[0]=n=>w("chooseModel",null)),class:"q-pa-md"},{default:r(()=>[l(Z,null,{default:r(()=>[l(q,{overline:"",caption:""},{default:r(()=>[h(m(u(t)("embedding.none")),1)]),_:1}),l(q,{class:"text-weight-bold"},{default:r(()=>[h(m(u(t)(`embedding.${s.category}_none_description`)),1)]),_:1})]),_:1})]),_:1},8,["active"])),[[Ee],[De]]):z("",!0)]),option:r(({opt:n,itemProps:f})=>{var K;return[l(G,qe(f,{active:n.name===((K=g.value)==null?void 0:K.name),class:"q-pa-md"}),{default:r(()=>[l(Z,null,{default:r(()=>[l(q,{class:"text-weight-bold"},{default:r(()=>[Ae("code",null,m(n.name),1),l(H,{class:"q-ml-sm cursor-pointer",name:x.value===n.name?"done":"content_copy",onClick:X(T=>le(n.name),["stop"])},null,8,["name","onClick"])]),_:2},1024),l(q,{overline:"",caption:""},{default:r(()=>[h(m(u(t)(`embedding.${n.name.replace(".","_")}_description`)),1)]),_:2},1024),l(q,{caption:"",class:"row"},{default:r(()=>{var T,B,R,O,V,U,N,Q;return[s.allowBAAI?z("",!0):(M(),k(b,{key:0,label:n.replicas>0?u(t)("embedding.running"):u(t)("embedding.sleeping"),square:"",size:"xs",outline:"",icon:n.replicas>0?"play_circle_filled":"mdi-sleep",color:n.replicas>0?"positive":"warning",style:{"border-radius":"0"}},{default:r(()=>[l(_,{"max-width":"300px"},{default:r(()=>[h(m(u(t)("embedding.status_explain")),1)]),_:1})]),_:2},1032,["label","icon","color"])),n.tags&&n.tags.includes("multimodal")?(M(),k(b,{key:1,square:"",size:"xs",outline:"",color:n.name!==((T=g.value)==null?void 0:T.name)?"grey-5":"",style:{"border-radius":"0"},label:u(t)("embedding.multimodal"),icon:"mms"},{default:r(()=>[l(_,null,{default:r(()=>[h(m(u(t)("embedding.multimodal_explain")),1)]),_:1})]),_:2},1032,["color","label"])):z("",!0),n.request_path.includes("multi-embeddings")&&s.category.includes("embedding")?(M(),k(b,{key:2,color:n.name!==((B=g.value)==null?void 0:B.name)?"grey-5":"",style:{"border-radius":"0"},icon:"grid_4x4",label:u(t)("embedding.multi_embedding"),square:"",size:"xs",outline:""},{default:r(()=>[l(_,null,{default:r(()=>[h(m(u(t)("embedding.multi_embedding_explain")),1)]),_:1})]),_:2},1032,["color","label"])):z("",!0),l(b,{label:n.meta_data.token_length,square:"",color:n.name!==((R=g.value)==null?void 0:R.name)?"grey-5":"",size:"xs",outline:"",icon:"notes",style:{"border-radius":"0"}},{default:r(()=>[l(_,null,{default:r(()=>[h(m(u(t)("embedding.token_length_explain",{_tokenLength:n.meta_data.token_length})),1)]),_:2},1024)]),_:2},1032,["label","color"]),n.request_path.includes("embedding")?(M(),k(b,{key:3,label:n.meta_data.output_dim,square:"",color:n.name!==((O=g.value)==null?void 0:O.name)?"grey-5":"",size:"xs",outline:"",icon:"mdi-axis-arrow",style:{"border-radius":"0"}},{default:r(()=>[l(_,null,{default:r(()=>[h(m(u(t)("embedding.output_dim_explain",{_outputDim:n.meta_data.output_dim})),1)]),_:2},1024)]),_:2},1032,["label","color"])):z("",!0),l(b,{label:n.meta_data.size,square:"",size:"xs",color:n.name!==((V=g.value)==null?void 0:V.name)?"grey-5":"",outline:"",icon:"mdi-matrix",style:{"border-radius":"0"}},{default:r(()=>[l(_,null,{default:r(()=>[h(m(u(t)("embedding.size_explain",{_size:n.meta_data.size})),1)]),_:2},1024)]),_:2},1032,["label","color"]),l(b,{label:C(n.meta_data.language),square:"",color:n.name!==((U=g.value)==null?void 0:U.name)?"grey-5":"",size:"xs",outline:"",style:{"border-radius":"0"}},{default:r(()=>[l(_,null,{default:r(()=>[h(m(u(t)("embedding.language_explain",{_language:C(n.meta_data.language)})),1)]),_:2},1024)]),_:2},1032,["label","color"]),J(l(b,{icon:"img:/huggingface_logo.svg",square:"",size:"xs",outline:"",color:n.name!==((N=g.value)==null?void 0:N.name)?"grey-5":"",style:{"border-radius":"0"},onClick:X(Ce=>ie(n.name),["stop"]),clickable:""},{default:r(()=>[l(_,null,{default:r(()=>[h(m(u(t)("embedding.opensource_explain")),1)]),_:1})]),_:2},1032,["color","onClick"]),[[Ie,n.name!=="jina-reranker-v1-base-en"]]),n.release_date?(M(),k(b,{key:4,square:"",size:"xs",outline:"",color:n.name!==((Q=g.value)==null?void 0:Q.name)?"grey-5":"",style:{"border-radius":"0"},label:n.release_date,icon:"calendar_month"},{default:r(()=>[l(_,{"max-width":"300px"},{default:r(()=>[h(m(u(t)("embedding.add_time_explain")),1)]),_:1})]),_:2},1032,["color","label"])):z("",!0)]}),_:2},1024)]),_:2},1024)]),_:2},1040,["active"])]}),_:1},8,["modelValue","display-value","options","option-label","option-value","loading","disable","label"])}}});export{Fe as B,De as C,Ke as T,Ne as _,Te as u};
