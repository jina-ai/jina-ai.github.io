import{Q as g,a as M}from"./plugin-vue_export-helper.4bfad710.js";import{c4 as q,bU as $,c5 as H,aJ as W,bn as T,e as R,ae as B,aj as P,an as n,ag as h,ah as t,b7 as C,al as L,at as k,ar as S,ai as d,am as s,ap as c,aq as u,ao as _,av as j,as as v,az as Y,aw as G,ay as z,h as U,aB as J,u as V,c6 as F,aA as E,ak as Q,bH as K,j as X}from"./index.0d4ce67f.js";import{Q as Z}from"./QImg.38310f06.js";import{Q as O}from"./QTooltip.07be2676.js";import{f as x,g as ee}from"./EmbeddingDialog.22acd1f7.js";import{c as ae}from"./QLinearProgress.143e7ce5.js";import{c as te}from"./copy-to-clipboard.ab055ab8.js";import{u as se}from"./blogs.e583e728.js";const ne=q.value.map(o=>({...o,type:"product"}));var b=(o=>(o.PRODUCT="product",o.NEWS="news",o.COMPANY="company",o.ELLIPSIS="ellipsis",o.HEADER="header",o.SEPARATOR="separator",o.ON_PAGE_RAG="onPageRAG",o.ASK_SOLUTION="askSolution",o))(b||{});const le=$("search",{state:()=>({answerChunks:[],isBusy:!1,isStreaming:!1,isComposing:!1}),getters:{},actions:{async composeResult(o){this.isComposing=!0;try{const y=se(),p=3;let i=ne;await y.getAllNews();const m=y.allBlogs.map(l=>({label:l.title,icon:l.featureImage,value:l.title,description:l.excerpt,time:H(l.publishedAt).format("MMMM DD, YYYY"),slug:l.slug,type:"news"}));let e=m,r=W.filter(l=>!l.external);o&&(i=i.filter(l=>this.t(l.label).toLowerCase().includes(o.toLowerCase())||this.t(l.description).toLowerCase().includes(o.toLowerCase())),e=m.filter(l=>l.label.toLowerCase().includes(o.toLowerCase())),e.length===0&&(e=m.filter(l=>l.description.toLowerCase().replaceAll("-"," ").includes(o.toLowerCase()))),r=r.filter(l=>this.t(l.label).toLowerCase().includes(o.toLowerCase())));let a=[{type:"onPageRAG",label:o},{type:"askSolution",label:o}];return i.length&&(a.length&&a.push({type:"separator"}),a.push({label:"header.products",number:i.length,type:"header"}),a=a.concat(i.slice(0,p)),i.length>p&&a.push({label:"header.see_all_products",type:"ellipsis",number:i.length-p})),r.length&&(a.length&&a.push({type:"separator"}),a.push({label:"header.company",number:r.length,type:"header"}),a=a.concat(r.slice(0,p)),r.length>p&&a.push({label:"header.see_all_company",type:"ellipsis",number:r.length-p})),e.length&&(a.length&&a.push({type:"separator"}),a.push({label:"header.news",number:e.length,type:"header"}),a=a.concat(e.slice(0,p)),e.length>p&&a.push({label:"header.see_all_news",type:"ellipsis",number:e.length-p})),a}finally{this.isComposing=!1}},async search(o,y){var e,r;this.answerChunks=[],this.isBusy=!0,this.isStreaming=!0;let p="";y==="onPageRAG"&&await fetch(`https://r.jina.ai/https://jina.ai${window.location.pathname}`).then(a=>a.text()).then(a=>{p=a});const i={parameters:{question:o,content:p}},m=y==="onPageRAG"?"https://api.promptperfect.jina.ai/BcHLFuKk3u9naJ4u4G1H":"https://api.promptperfect.jina.ai/EEBuotbLAugUDjr4mq1j";try{const a=await fetch(m,{headers:{"content-type":"application/json"},body:JSON.stringify(i),method:"POST"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);if((e=a.headers.get("content-type"))!=null&&e.includes("text/event-stream")){if(a.body){const l=a.body.getReader(),w=new TextDecoder;for(;;){const{done:A,value:f}=await l.read();if(A){this.isStreaming=!1;break}f&&(this.isBusy=!1,w.decode(f).split(`

`).forEach(D=>{const N=D.replace(/data: /g,"");N&&this.answerChunks.push(N)}))}}}else if((r=a.headers.get("content-type"))!=null&&r.includes("application/json")){const l=(await a.json()).data;this.answerChunks=[l]}else throw new Error("Unknown response type")}catch(a){T.create({color:"negative",message:this.t("landing_page.error",{message:a}),icon:"report_problem"})}finally{this.isBusy=!1}}}}),oe=["src"],we=R({__name:"SearchResult",props:{data:{},itemProps:{},showMoreNews:{type:Boolean},showOnPageRag:{type:Boolean,default:!0}},emits:["askQuestion"],setup(o,{emit:y}){const p=y,{t:i,te:m}=B({useScope:"global"});return(e,r)=>{var a,l,w;return d(),P(S,null,[e.data.type===n(b).ON_PAGE_RAG&&e.showOnPageRag?(d(),h(L,C({key:0},e.itemProps,{clickable:"",onClick:r[0]||(r[0]=A=>p("askQuestion"))}),{default:t(()=>[s(_,null,{default:t(()=>[s(g,{caption:""},{default:t(()=>[c(u(n(i)("searchbar.ask_on_current_page")),1)]),_:1}),s(g,{class:"text-italic"},{default:t(()=>[c(' "'+u(n(i)(e.data.label))+'" ',1)]),_:1})]),_:1})]),_:1},16)):k("",!0),e.data.type===n(b).HEADER?(d(),h(g,C({key:1},e.itemProps,{header:""}),{default:t(()=>[c(u(n(i)(e.data.label))+" ("+u(e.data.number)+") ",1)]),_:1},16)):k("",!0),e.data.type===n(b).ELLIPSIS?(d(),h(g,C({key:2},e.itemProps,{header:""}),{default:t(()=>[c(u(n(i)("searchbar.more_results",{_numMore:e.data.number})),1)]),_:1},16)):k("",!0),e.data.routerLink?(d(),h(L,C({key:3},e.itemProps,{clickable:"",to:e.data.routerLink.startsWith("/")?e.data.routerLink:void 0,href:e.data.routerLink.startsWith("http")?e.data.routerLink:void 0,target:e.data.routerLink.startsWith("http")?"_blank":void 0}),{default:t(()=>[s(_,{avatar:""},{default:t(()=>[s(j,{name:"img:/J.svg",loading:"lazy"})]),_:1}),s(_,null,{default:t(()=>[s(g,null,{default:t(()=>[c(u(n(m)(e.data.label)?n(i)(e.data.label):e.data.label),1)]),_:1}),s(g,{caption:"",lines:"1"},{default:t(()=>[v("code",null,u(n(i)(e.data.routerLink)),1)]),_:1})]),_:1})]),_:1},16,["to","href","target"])):k("",!0),e.data.type===n(b).PRODUCT?(d(),h(L,C({key:4},e.itemProps,{clickable:"",to:(a=e.data.link)!=null&&a.startsWith("/")?e.data.link:void 0,href:(l=e.data.link)!=null&&l.startsWith("http")?e.data.link:void 0,target:(w=e.data.link)!=null&&w.startsWith("http")?"_blank":void 0}),{default:t(()=>[s(_,{avatar:""},{default:t(()=>[s(Z,{src:e.data.icon,loading:"lazy"},null,8,["src"])]),_:1}),s(_,null,{default:t(()=>[s(g,null,{default:t(()=>[c(u(n(m)(e.data.label)?n(i)(e.data.label):e.data.label),1)]),_:1}),s(g,{caption:"",lines:"1"},{default:t(()=>[c(u(n(i)(e.data.description)),1)]),_:1})]),_:1}),s(_,{side:""},{default:t(()=>[s(g,{caption:""},{default:t(()=>[c(u(e.data.time),1)]),_:1})]),_:1})]),_:1},16,["to","href","target"])):k("",!0),e.data.type===n(b).SEPARATOR?(d(),h(G,{key:5})):k("",!0),e.data.type===n(b).NEWS?(d(),h(L,C({key:6},e.itemProps,{to:`/news/${e.data.slug}`,clickable:""}),{default:t(()=>[s(_,{avatar:""},{default:t(()=>[s(Y,null,{default:t(()=>[v("img",{src:e.data.icon,loading:"lazy"},null,8,oe)]),_:1})]),_:1}),s(_,null,{default:t(()=>[s(g,null,{default:t(()=>[c(u(e.data.label),1)]),_:1}),e.showMoreNews?(d(),h(g,{key:0,caption:"",lines:"3"},{default:t(()=>[c(u(e.data.description),1)]),_:1})):k("",!0),s(g,{caption:""},{default:t(()=>[c(u(e.data.time),1)]),_:1})]),_:1})]),_:1},16,["to"])):k("",!0)],64)}}}),re={class:"text-caption text-dim"},ie={class:"text-caption text-dim"},ke=R({__name:"SearchResultByModel",props:{type:{default:b.ON_PAGE_RAG}},setup(o){const y=le(),{isBusy:p,isStreaming:i,answerChunks:m}=z(y),e=V(),{t:r}=B({useScope:"global"});function a(){return te(m.value.join("")).then(()=>{e.notify({message:r("landing_page.copied_to_clipboard")}),window.gtag&&window.gtag("event","HOME_COPY_PP_SEARCH")})}const l=U(()=>F.value.filter(w=>m.value.join("").toLowerCase().includes(w.label.toLowerCase().replace("landing_page.",""))));return(w,A)=>(d(),h(J,null,{default:t(()=>[n(p)?(d(),h(E,{key:0},{default:t(()=>[s(j,{name:"img:https://promptperfect.jina.ai/PromptPerfect-dark.svg",class:"q-mr-sm"},{default:t(()=>[s(O,null,{default:t(()=>[c(u(n(r)("landing_page.powered_by_promptperfect")),1)]),_:1})]),_:1}),v("span",re,u(w.type===n(b).ON_PAGE_RAG?n(r)("searchbar.proposing_solution"):n(r)("landing_page.proposing_solution")),1),(d(),P(S,null,Q([0,1,2,3],f=>s(x,{key:f,class:"q-my-xs",width:f>0?"":"100px",type:"text"},null,8,["width"])),64))]),_:1})):(d(),P(S,{key:1},[l.value.length>0?(d(),P(S,{key:0},[s(E,null,{default:t(()=>[v("span",ie,u(n(r)("landing_page.mentioned_products")),1),(d(!0),P(S,null,Q(l.value,f=>(d(),h(M,{size:"sm",key:f,label:n(r)(f.label),icon:f.icon?`img:${f.icon}`:"widgets",onClick:I=>w.redirect(f.link),clickable:""},{default:t(()=>[s(O,null,{default:t(()=>[c(u(n(r)(f.description)),1)]),_:2},1024)]),_:2},1032,["label","icon","onClick"]))),128))]),_:1}),s(G)],64)):k("",!0),s(E,{class:"q-pa-lg"},{default:t(()=>[s(ee,{text:n(m),"speed-time":n(i)?50:0},null,8,["text","speed-time"])]),_:1}),n(i)?(d(),h(ae,{key:1,indeterminate:""})):(d(),h(K,{key:2,align:"center",class:"q-pa-none"},{default:t(()=>[s(X,{square:"",flat:"","no-caps":"",icon:"content_copy",onClick:a,label:n(r)("landing_page.copy"),class:"full-width"},null,8,["label"])]),_:1}))],64))]),_:1}))}});export{b as R,we as _,ke as a,le as u};
