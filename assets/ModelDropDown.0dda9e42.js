import{bU as fe,aW as be,bV as _e,bW as ye,H as ve,P as C,W as we,bA as ke,e as Me,ae as ze,ay as H,ax as $e,f as $,h as J,w as Ae,K as Ie,J as qe,ad as Se,ag as k,ah as r,an as d,ai as M,am as l,bF as Ee,bE as Ke,av as Z,a4 as X,al as Y,ap as h,aq as m,ao as ee,at as A,as as Fe,bn as ae,b5 as je,aC as xe,bo as Te}from"./index.55f00a3f.js";import{a as I,b as y}from"./plugin-vue_export-helper.32485760.js";import{Q as v}from"./QTooltip.065dbe1b.js";import{a as De}from"./QLinearProgress.343ffed2.js";import{c as Ce}from"./copy-to-clipboard.3cb394be.js";const _="https://embeddings-dashboard-api.jina.ai",D="https://api.jina.ai";var Le=(e=>(e.CONSUME="consume",e.PURCHASE="purchase",e.TRIAL="trial",e))(Le||{}),Pe=(e=>(e.IN_PROGRESS="in-progress",e.FAILED="failed",e.COMPLETED="completed",e))(Pe||{});const Be=["price_1PqrlqEoTOtb5eZvFh1Vhdm6","price_1PqrnpEoTOtb5eZv3woXVYU1"],Re=fe("embedding",{state:()=>({apiKey:"",apiKeyInfo:void 0,isApiKeyLoading:!1,isApiKeyInfoLoading:!1,models:[],products:[],testData:[],userDocuments:"",userSearchDocs:"",userVisualizeDocs:""}),persist:{paths:["apiKey","testData","apiKeyInfo"]},getters:{baseEnModel:e=>e.models.find(a=>a.name==="jina-clip-v1"),jinaRerankerV1:e=>e.models.find(a=>a.name==="jina-reranker-v1-base-en"),jinaRerankerMultilingual:e=>e.models.find(a=>a.name==="jina-reranker-v2-base-multilingual"),clipV1:e=>e.models.find(a=>a.name==="jina-clip-v1"),baseZhModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-zh"),baseDeModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-de"),newModels:e=>e.models.filter(a=>new Date().getTime()-new Date(a.created_at).getTime()<1e3*60*60*24*30).map(a=>a.name),apiKeyTokens:e=>{var a,t;return(t=(a=e.apiKeyInfo)==null?void 0:a.wallet.total_balance)!=null?t:0},isPaidUser:e=>{var a;return!!((a=e.apiKeyInfo)!=null&&a.email)},isAutoCharge:e=>{var a,t;return!!((a=e.apiKeyInfo)!=null&&a.email)||((t=e.apiKeyInfo)==null?void 0:t.metadata.auto_recharge)}},actions:{setApiKeyInfo(e){!e||(this.apiKeyInfo=JSON.parse(JSON.stringify(e)))},async getReplicas(e,a){try{const t=await fetch(`${_}/api/v1/models/slug/${a}`,{method:"GET"});if(!t.ok)throw new Error(`getReplicas error! Status: ${t.status}`);return(await t.json()).num_replicas}catch(t){console.error("getReplicas error:",t)}},async generateApiKey(e){this.isApiKeyLoading=!0;const a=new FormData;a.set("cf-turnstile-response",e);try{const t=await fetch(`${_}/api/v1/api_key`,{method:"POST",body:a});if(!t.ok)throw new Error(`getApiKey error! Status: ${t.status}`);const s=await t.json();return this.apiKey=s.api_key,!0}catch(t){return console.error("getApiKey error:",t),!1}finally{this.isApiKeyLoading=!1}},async getCurrentKeyInfo(){this.isApiKeyInfoLoading=!0;try{const e=await fetch(`${_}/api/v1/api_key/user?api_key=${this.apiKey}`);if(e.ok){this.apiKeyInfo=await e.json();return}this.apiKeyInfo=void 0,console.error(`getTokens error! Status: ${e.status}`)}catch(e){this.apiKeyInfo=void 0,console.error("getTokens error:",e)}finally{this.isApiKeyInfoLoading=!1}},async getKeyInfo(e){if(!!e){this.isApiKeyInfoLoading=!0;try{const a=await fetch(`${_}/api/v1/api_key/user?api_key=${e}`);return a.ok?await a.json():void 0}catch{return}finally{this.isApiKeyInfoLoading=!1}}},async getModels(){try{const e=await fetch(`${_}/api/v1/models`);if(!e.ok)throw new Error(`getModels error! Status: ${e.status}`);const a=await e.json();this.models=a,console.log("getModels data:",a)}catch(e){console.error("getModels error:",e)}},async getProducts(){try{const e=await fetch(`${_}/api/v1/product`);if(!e.ok)throw new Error(`getProducts error! Status: ${e.status}`);let a=await e.json();a=a.filter(t=>Be.includes(t.price_id)),a.unshift({id:"0",product_id:"0",product_name:"1M tokens",product_description:"A pack of 1 million tokens",price:0,price_id:"0",currency:"USD",token_quantity:1e6}),console.log("getProducts data:",a),this.products=a}catch(e){console.error("getProducts error:",e)}},async getUsage(e){try{const a=await fetch(`${_}/api/v1/billing/transaction`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)throw new Error(`getUsage error! Status: ${a.status}`);return await a.json()}catch(a){console.error("getUsage error:",a)}},async checkoutWithStripe(e,a){try{const t=await fetch(`${_}/api/v1/checkout_session`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a),mode:"cors",credentials:"include"});if(!t.ok)throw new Error(`checkoutWithStripe error! Status: ${t.status}`);return await t.json()}catch(t){console.error("checkoutWithStripe error:",t)}},async bulkEmbedding(e,a){var q;const t={accept:"application/json",Authorization:`Bearer ${e}`},s=new FormData;s.append("model",a.model),s.append("email",(q=a.email)!=null?q:""),s.append("file",a.file);const i=await fetch(`${D}/v1/bulk-embeddings`,{method:"POST",headers:t,body:s});if(i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText}`)},async checkBulk(e,a){const t={accept:"application/json",Authorization:`Bearer ${e}`},s=await fetch(`${D}/v1/bulk-embeddings/${a}`,{method:"GET",headers:t});if(s.ok)return await s.json();throw new Error(`${s.status}: ${s.statusText}`)},async getBulkResult(e,a){const t={accept:"application/json",Authorization:`Bearer ${e}`},s=await fetch(`${D}/v1/bulk-embeddings/${a}/download-result`,{method:"POST",headers:t});if(s.ok){const{download_url:i}=await s.json();return i}else throw new Error(`${s.status}: ${s.statusText}`)},async cancelAutoRecharge(e){const a=await fetch(`${_}/api/v1/cancel_auto_recharge`,{method:"POST",headers:{accept:"application/json",Authorization:`Bearer ${e}`}});if(a.ok)return!0;throw new Error(`Disable auto-recharge error! Status: ${a.status}`)}}});function te(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}var Oe=be({name:"close-popup",beforeMount(e,{value:a}){const t={depth:te(a),handler(s){t.depth!==0&&setTimeout(()=>{const i=_e(e);i!==void 0&&ye(i,s,t.depth)})},handlerKey(s){ve(s,13)===!0&&t.handler(s)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:a,oldValue:t}){a!==t&&(e.__qclosepopup.depth=te(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}});function Ve(e){const a=Object.assign({noopener:!0},e),t=[];for(const s in a){const i=a[s];i===!0?t.push(s):(ke(i)||typeof i=="string"&&i!=="")&&t.push(s+"="+i)}return t.join(",")}function ne(e,a,t){let s=window.open;if(C.is.cordova===!0){if(cordova!==void 0&&cordova.InAppBrowser!==void 0&&cordova.InAppBrowser.open!==void 0)s=cordova.InAppBrowser.open;else if(navigator!==void 0&&navigator.app!==void 0)return navigator.app.loadUrl(e,{openExternal:!0})}const i=s(e,"_blank",Ve(t));if(i)return C.is.desktop&&i.focus(),i;a&&a()}var Ue=(e,a,t)=>{if(C.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(s=>{s?window.SafariViewController.show({url:e},we,a):ne(e,a,t)});return}return ne(e,a,t)};const oe=[{name:"bge-small-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-small-en",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-m3",meta_data:{token_length:1024,output_dim:2048,size:"1.3B",language:"multilingual"},request_path:["embedding"]}],Ze=Me({__name:"ModelDropDown",props:{currentModel:{},indicator:{type:Boolean,default:!0},category:{default:"embedding"},allowNone:{type:Boolean,default:!1},allowBAAI:{type:Boolean,default:!1},demoOnly:{type:Boolean,default:!1},spaceSaving:{type:Boolean,default:!1}},emits:["chooseModel","modelsLoaded","switchToRerankerTab","switchToEmbeddingTab"],setup(e,{emit:a}){const{t}=ze({useScope:"global"}),s=Re(),{models:i,baseDeModel:q,baseEnModel:F,baseZhModel:se,jinaRerankerMultilingual:re}=H(s),ie=$e(),{language:S}=H(ie),j=$(null);let c=null;const E=$(!1),w=e,b=a,g=J({get:()=>w.currentModel,set:n=>{b("chooseModel",n)}}),L=()=>{var n;b("chooseModel",(n=se.value)!=null?n:F.value)},P=()=>{var n;b("chooseModel",(n=q.value)!=null?n:F.value)};Ae(S,n=>{w.category==="multi-embeddings"&&(n&&["zh-CN","zh-TW"].includes(n)?L():n==="de"&&P())});const le=()=>{var u;const n=((u=j.value)==null?void 0:u.$el)||j.value;n instanceof HTMLElement?(c=new IntersectionObserver(async p=>{if(p[0].isIntersecting){c==null||c.unobserve(n);try{await ce(),c==null||c.disconnect()}catch(f){console.error("Failed to load models:",f),c==null||c.observe(n)}}},{root:null,threshold:.1}),c.observe(n)):console.error("Element is not an HTMLElement:",n)};Ie(()=>{qe(()=>{setTimeout(()=>{le()},100)})}),Se(()=>{c&&c.disconnect()});const B=J(()=>i.value.filter(n=>{const u=w.category==="multi-embeddings",p=n.request_path,o=u?["multi-embeddings","embedding"]:[w.category];return Array.isArray(p)?p.some(f=>o.includes(f)):o.includes(p)}).sort((n,u)=>new Date(u.release_date).getTime()-new Date(n.release_date).getTime())),z=$([]),K=$([]),de=()=>{w.allowBAAI?z.value=oe:z.value=B.value,K.value=z.value},ue=(n,u)=>{u(()=>{n?K.value=z.value.filter(p=>p.name.toLowerCase().includes(n.toLowerCase())):K.value=z.value})},ce=async()=>{var o;E.value=!0,(o=i.value)!=null&&o.length||await s.getModels(),E.value=!1,de();const n=new URL(window.location.href),u=n.searchParams.get("model"),p=u&&i.value.find(f=>f.name===u);if(p)b("chooseModel",p),n.searchParams.delete("model"),window.history.pushState({},"",n);else switch(w.category){case"embedding":case"multi-embeddings":i.value.length>0&&(S.value&&["zh-CN","zh-TW"].includes(S.value)?L():S.value==="de"?P():w.allowBAAI?b("chooseModel",oe[0]):b("chooseModel",F.value));break;case"rank":b("chooseModel",re.value)}for(const f of B.value)f.replicas=await s.getReplicas(s.apiKey,f.name);b("modelsLoaded")},pe=n=>{ge("event","embedding_view_model_detail",{location:he.location.href,model:n}),Ue(`https://huggingface.co/jinaai/${n}`)},x=$(""),me=n=>{Ce(n).then(()=>{x.value=n}),setTimeout(()=>{x.value=""},1800)},ge=window.gtag,he=window.document,R=n=>n==="en"?"\u{1F1FA}\u{1F1F8}":n==="zh"?"\u{1F1E8}\u{1F1F3}\u{1F1FA}\u{1F1F8}":n==="de"?"\u{1F1E9}\u{1F1EA}\u{1F1FA}\u{1F1F8}":n==="es"?"\u{1F1EA}\u{1F1F8}\u{1F1FA}\u{1F1F8}":"\u{1F30D}";return(n,u)=>{var p;return M(),k(De,{borderless:"",ref_key:"componentRef",ref:j,class:"cursor-pointer","use-input":"","fill-input":"",filled:"",square:"","hide-selected":"","input-debounce":"0",modelValue:g.value,"onUpdate:modelValue":u[1]||(u[1]=o=>g.value=o),"display-value":(p=g.value)==null?void 0:p.name,options:K.value,"option-label":o=>o.name,"option-value":o=>o.name,loading:E.value,disable:E.value,"label-color":"grey-5",label:n.category==="rank"?d(t)("embedding.select_rerank_model"):d(t)("embedding.select_embedding_model"),onFilter:ue},{prepend:r(()=>[l(Z,{name:n.spaceSaving?void 0:"img:"+(n.category==="rank"?d(Ee):d(Ke))},null,8,["name"])]),"no-option":r(()=>[n.allowNone?X((M(),k(Y,{key:0,clickable:"",active:!n.currentModel,onClick:u[0]||(u[0]=o=>b("chooseModel",null)),class:"q-pa-md"},{default:r(()=>[l(ee,null,{default:r(()=>[l(I,{overline:"",caption:""},{default:r(()=>[h(m(d(t)("embedding.none")),1)]),_:1}),l(I,{class:"text-weight-bold"},{default:r(()=>[h(m(d(t)(`embedding.${n.category}_none_description`)),1)]),_:1})]),_:1})]),_:1},8,["active"])),[[Te],[Oe]]):A("",!0)]),option:r(({opt:o,itemProps:f})=>{var O;return[l(Y,xe(f,{active:o.name===((O=g.value)==null?void 0:O.name),class:"q-pa-md"}),{default:r(()=>[l(ee,null,{default:r(()=>[l(I,{class:"text-weight-bold"},{default:r(()=>[Fe("code",null,m(o.name),1),l(Z,{class:"q-ml-sm cursor-pointer",name:x.value===o.name?"done":"content_copy",onClick:ae(T=>me(o.name),["stop"])},null,8,["name","onClick"])]),_:2},1024),l(I,{overline:"",caption:""},{default:r(()=>[h(m(d(t)(`embedding.${o.name.replace(".","_")}_description`)),1)]),_:2},1024),l(I,{caption:"",class:"row"},{default:r(()=>{var T,V,U,N,W,Q,G;return[n.allowBAAI?A("",!0):(M(),k(y,{key:0,label:o.replicas>0?d(t)("embedding.running"):d(t)("embedding.sleeping"),square:"",size:"xs",outline:"",icon:o.replicas>0?"play_circle_filled":"mdi-sleep",color:o.replicas>0?"positive":"warning",style:{"border-radius":"0"}},{default:r(()=>[l(v,{"max-width":"300px"},{default:r(()=>[h(m(d(t)("embedding.status_explain")),1)]),_:1})]),_:2},1032,["label","icon","color"])),o.tags&&o.tags.includes("multimodal")?(M(),k(y,{key:1,square:"",size:"xs",outline:"",color:o.name!==((T=g.value)==null?void 0:T.name)?"grey-5":"",style:{"border-radius":"0"},label:d(t)("embedding.multimodal"),icon:"mms"},{default:r(()=>[l(v,null,{default:r(()=>[h(m(d(t)("embedding.multimodal_explain")),1)]),_:1})]),_:2},1032,["color","label"])):A("",!0),o.request_path.includes("multi-embeddings")&&n.category.includes("embedding")?(M(),k(y,{key:2,color:o.name!==((V=g.value)==null?void 0:V.name)?"grey-5":"",style:{"border-radius":"0"},icon:"grid_4x4",label:d(t)("embedding.multi_embedding"),square:"",size:"xs",outline:""},{default:r(()=>[l(v,null,{default:r(()=>[h(m(d(t)("embedding.multi_embedding_explain")),1)]),_:1})]),_:2},1032,["color","label"])):A("",!0),l(y,{label:o.meta_data.token_length,square:"",color:o.name!==((U=g.value)==null?void 0:U.name)?"grey-5":"",size:"xs",outline:"",icon:"notes",style:{"border-radius":"0"}},{default:r(()=>[l(v,null,{default:r(()=>[h(m(d(t)("embedding.token_length_explain",{_tokenLength:o.meta_data.token_length})),1)]),_:2},1024)]),_:2},1032,["label","color"]),o.request_path.includes("embedding")?(M(),k(y,{key:3,label:o.meta_data.output_dim,square:"",color:o.name!==((N=g.value)==null?void 0:N.name)?"grey-5":"",size:"xs",outline:"",icon:"mdi-axis-arrow",style:{"border-radius":"0"}},{default:r(()=>[l(v,null,{default:r(()=>[h(m(d(t)("embedding.output_dim_explain",{_outputDim:o.meta_data.output_dim})),1)]),_:2},1024)]),_:2},1032,["label","color"])):A("",!0),l(y,{label:o.meta_data.size,square:"",size:"xs",color:o.name!==((W=g.value)==null?void 0:W.name)?"grey-5":"",outline:"",icon:"mdi-matrix",style:{"border-radius":"0"}},{default:r(()=>[l(v,null,{default:r(()=>[h(m(d(t)("embedding.size_explain",{_size:o.meta_data.size})),1)]),_:2},1024)]),_:2},1032,["label","color"]),l(y,{label:R(o.meta_data.language),square:"",color:o.name!==((Q=g.value)==null?void 0:Q.name)?"grey-5":"",size:"xs",outline:"",style:{"border-radius":"0"}},{default:r(()=>[l(v,null,{default:r(()=>[h(m(d(t)("embedding.language_explain",{_language:R(o.meta_data.language)})),1)]),_:2},1024)]),_:2},1032,["label","color"]),X(l(y,{icon:"img:/huggingface_logo.svg",square:"",size:"xs",outline:"",color:o.name!==((G=g.value)==null?void 0:G.name)?"grey-5":"",style:{"border-radius":"0"},onClick:ae(Ne=>pe(o.name),["stop"]),clickable:"",label:d(t)("embedding.opensource")},{default:r(()=>[l(v,null,{default:r(()=>[h(m(d(t)("embedding.opensource_explain")),1)]),_:1})]),_:2},1032,["color","onClick","label"]),[[je,o.name!=="jina-reranker-v1-base-en"]])]}),_:2},1024)]),_:2},1024)]),_:2},1040,["active"])]}),_:1},8,["modelValue","display-value","options","option-label","option-value","loading","disable","label"])}}});export{Pe as B,Oe as C,Le as T,Ze as _,Re as u};
