import{bU as be,aW as _e,bV as ye,bW as ve,H as we,P as L,W as ke,bA as Me,e as ze,ae as $e,ay as J,ax as Ae,f as A,h as Z,w as Ie,K as qe,J as Se,ad as Ee,ag as k,ah as r,an as d,ai as M,am as l,bF as xe,bE as Ke,av as X,a4 as Y,al as ee,ap as h,aq as m,ao as ae,at as z,as as Fe,bn as te,b5 as je,aC as Te,bo as De}from"./index.c1a1879a.js";import{a as I,b as _}from"./plugin-vue_export-helper.fb7f0378.js";import{Q as y}from"./QTooltip.d5f412bb.js";import{a as Ce}from"./QLinearProgress.5cd138a5.js";import{c as Le}from"./copy-to-clipboard.c1fd32cf.js";const v="https://embeddings-dashboard-api.jina.ai",C="https://api.jina.ai";var Pe=(e=>(e.CONSUME="consume",e.PURCHASE="purchase",e.TRIAL="trial",e))(Pe||{}),Be=(e=>(e.IN_PROGRESS="in-progress",e.FAILED="failed",e.COMPLETED="completed",e))(Be||{});const Re=["price_1PqrlqEoTOtb5eZvFh1Vhdm6","price_1PqrnpEoTOtb5eZv3woXVYU1"],Oe=be("embedding",{state:()=>({apiKey:"",apiKeyInfo:void 0,isApiKeyLoading:!1,isApiKeyInfoLoading:!1,models:[],products:[],testData:[],userDocuments:"",userSearchDocs:"",userVisualizeDocs:""}),persist:{paths:["apiKey","testData","apiKeyInfo"]},getters:{baseEnModel:e=>e.models.find(a=>a.name==="jina-clip-v1"),jinaRerankerV1:e=>e.models.find(a=>a.name==="jina-reranker-v1-base-en"),jinaRerankerMultilingual:e=>e.models.find(a=>a.name==="jina-reranker-v2-base-multilingual"),clipV1:e=>e.models.find(a=>a.name==="jina-clip-v1"),baseZhModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-zh"),baseDeModel:e=>e.models.find(a=>a.name==="jina-embeddings-v2-base-de"),newModels:e=>e.models.filter(a=>new Date().getTime()-new Date(a.created_at).getTime()<1e3*60*60*24*30).map(a=>a.name),apiKeyTokens:e=>{var a,t;return(t=(a=e.apiKeyInfo)==null?void 0:a.wallet.total_balance)!=null?t:0},isPaidUser:e=>{var a;return!!((a=e.apiKeyInfo)!=null&&a.email)},isAutoCharge:e=>{var a,t;return!!((a=e.apiKeyInfo)!=null&&a.email)||((t=e.apiKeyInfo)==null?void 0:t.metadata.auto_recharge)}},actions:{setApiKeyInfo(e){!e||(this.apiKeyInfo=JSON.parse(JSON.stringify(e)))},async getReplicas(e,a){try{const t=await fetch(`${v}/api/v1/models/slug/${a}`,{method:"GET"});if(!t.ok)throw new Error(`getReplicas error! Status: ${t.status}`);return(await t.json()).num_replicas}catch(t){console.error("getReplicas error:",t)}},async generateApiKey(e){this.isApiKeyLoading=!0;const a=new FormData;a.set("cf-turnstile-response",e);try{const t=await fetch(`${v}/api/v1/api_key`,{method:"POST",body:a});if(!t.ok)throw new Error(`getApiKey error! Status: ${t.status}`);const s=await t.json();return this.apiKey=s.api_key,!0}catch(t){return console.error("getApiKey error:",t),!1}finally{this.isApiKeyLoading=!1}},async getCurrentKeyInfo(){this.isApiKeyInfoLoading=!0;try{const e=await fetch(`${v}/api/v1/api_key/user?api_key=${this.apiKey}`);if(e.ok){this.apiKeyInfo=await e.json();return}this.apiKeyInfo=void 0,console.error(`getTokens error! Status: ${e.status}`)}catch(e){this.apiKeyInfo=void 0,console.error("getTokens error:",e)}finally{this.isApiKeyInfoLoading=!1}},async getKeyInfo(e){if(!!e){this.isApiKeyInfoLoading=!0;try{const a=await fetch(`${v}/api/v1/api_key/user?api_key=${e}`);return a.ok?await a.json():void 0}catch{return}finally{this.isApiKeyInfoLoading=!1}}},async getModels(){try{const e=await fetch(`${v}/api/v1/models`);if(!e.ok)throw new Error(`getModels error! Status: ${e.status}`);const a=await e.json();this.models=a,console.log("getModels data:",a)}catch(e){console.error("getModels error:",e)}},async getProducts(){try{const e=await fetch(`${v}/api/v1/product`);if(!e.ok)throw new Error(`getProducts error! Status: ${e.status}`);let a=await e.json();a=a.filter(t=>Re.includes(t.price_id)),a.unshift({id:"0",product_id:"0",product_name:"1M tokens",product_description:"A pack of 1 million tokens",price:0,price_id:"0",currency:"USD",token_quantity:1e6}),console.log("getProducts data:",a),this.products=a}catch(e){console.error("getProducts error:",e)}},async getUsage(e){try{const a=await fetch(`${v}/api/v1/billing/transaction`,{headers:{Authorization:`Bearer ${e}`}});if(!a.ok)throw new Error(`getUsage error! Status: ${a.status}`);return await a.json()}catch(a){console.error("getUsage error:",a)}},async checkoutWithStripe(e,a){try{const t=await fetch(`${v}/api/v1/checkout_session`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify(a),mode:"cors",credentials:"include"});if(!t.ok)throw new Error(`checkoutWithStripe error! Status: ${t.status}`);return await t.json()}catch(t){console.error("checkoutWithStripe error:",t)}},async bulkEmbedding(e,a){var q;const t={accept:"application/json",Authorization:`Bearer ${e}`},s=new FormData;s.append("model",a.model),s.append("email",(q=a.email)!=null?q:""),s.append("file",a.file);const i=await fetch(`${C}/v1/bulk-embeddings`,{method:"POST",headers:t,body:s});if(i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText}`)},async checkBulk(e,a){const t={accept:"application/json",Authorization:`Bearer ${e}`},s=await fetch(`${C}/v1/bulk-embeddings/${a}`,{method:"GET",headers:t});if(s.ok)return await s.json();throw new Error(`${s.status}: ${s.statusText}`)},async getBulkResult(e,a){const t={accept:"application/json",Authorization:`Bearer ${e}`},s=await fetch(`${C}/v1/bulk-embeddings/${a}/download-result`,{method:"POST",headers:t});if(s.ok){const{download_url:i}=await s.json();return i}else throw new Error(`${s.status}: ${s.statusText}`)},async cancelAutoRecharge(e){const a=await fetch(`${v}/api/v1/cancel_auto_recharge`,{method:"POST",headers:{accept:"application/json",Authorization:`Bearer ${e}`}});if(a.ok)return!0;throw new Error(`Disable auto-recharge error! Status: ${a.status}`)}}});function ne(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}var Ve=_e({name:"close-popup",beforeMount(e,{value:a}){const t={depth:ne(a),handler(s){t.depth!==0&&setTimeout(()=>{const i=ye(e);i!==void 0&&ve(i,s,t.depth)})},handlerKey(s){we(s,13)===!0&&t.handler(s)}};e.__qclosepopup=t,e.addEventListener("click",t.handler),e.addEventListener("keyup",t.handlerKey)},updated(e,{value:a,oldValue:t}){a!==t&&(e.__qclosepopup.depth=ne(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}});function Ue(e){const a=Object.assign({noopener:!0},e),t=[];for(const s in a){const i=a[s];i===!0?t.push(s):(Me(i)||typeof i=="string"&&i!=="")&&t.push(s+"="+i)}return t.join(",")}function oe(e,a,t){let s=window.open;if(L.is.cordova===!0){if(cordova!==void 0&&cordova.InAppBrowser!==void 0&&cordova.InAppBrowser.open!==void 0)s=cordova.InAppBrowser.open;else if(navigator!==void 0&&navigator.app!==void 0)return navigator.app.loadUrl(e,{openExternal:!0})}const i=s(e,"_blank",Ue(t));if(i)return L.is.desktop&&i.focus(),i;a&&a()}var Ne=(e,a,t)=>{if(L.is.ios===!0&&window.SafariViewController!==void 0){window.SafariViewController.isAvailable(s=>{s?window.SafariViewController.show({url:e},ke,a):oe(e,a,t)});return}return oe(e,a,t)};const se=[{name:"bge-small-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh-v1.5",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh-v1.5",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-small-en",meta_data:{token_length:512,output_dim:768,size:"45M",language:"en"},request_path:["embedding"]},{name:"bge-base-en",meta_data:{token_length:512,output_dim:768,size:"110M",language:"en"},request_path:["embedding"]},{name:"bge-large-en",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"en"},request_path:["embedding"]},{name:"bge-small-zh",meta_data:{token_length:512,output_dim:768,size:"45M",language:"zh"},request_path:["embedding"]},{name:"bge-base-zh",meta_data:{token_length:512,output_dim:768,size:"110M",language:"zh"},request_path:["embedding"]},{name:"bge-large-zh",meta_data:{token_length:512,output_dim:1024,size:"340M",language:"zh"},request_path:["embedding"]},{name:"bge-m3",meta_data:{token_length:1024,output_dim:2048,size:"1.3B",language:"multilingual"},request_path:["embedding"]}],Xe=ze({__name:"ModelDropDown",props:{currentModel:{},indicator:{type:Boolean,default:!0},category:{default:"embedding"},allowNone:{type:Boolean,default:!1},allowBAAI:{type:Boolean,default:!1},demoOnly:{type:Boolean,default:!1},spaceSaving:{type:Boolean,default:!1}},emits:["chooseModel","modelsLoaded","switchToRerankerTab","switchToEmbeddingTab"],setup(e,{emit:a}){const{t}=$e({useScope:"global"}),s=Oe(),{models:i,baseDeModel:q,baseEnModel:F,baseZhModel:re,jinaRerankerMultilingual:ie}=J(s),le=Ae(),{language:S}=J(le),j=A(null);let p=null;const E=A(!1),w=e,b=a,g=Z({get:()=>w.currentModel,set:o=>{b("chooseModel",o)}}),P=()=>{var o;b("chooseModel",(o=re.value)!=null?o:F.value)},B=()=>{var o;b("chooseModel",(o=q.value)!=null?o:F.value)};Ie(S,o=>{w.category==="multi-embeddings"&&(o&&["zh-CN","zh-TW"].includes(o)?P():o==="de"&&B())});const de=()=>{var u;const o=((u=j.value)==null?void 0:u.$el)||j.value;o instanceof HTMLElement?(p=new IntersectionObserver(async c=>{if(c[0].isIntersecting){p==null||p.unobserve(o);try{await pe(),p==null||p.disconnect()}catch(f){console.error("Failed to load models:",f),p==null||p.observe(o)}}},{root:null,threshold:.1}),p.observe(o)):console.error("Element is not an HTMLElement:",o)};qe(()=>{Se(()=>{setTimeout(()=>{de()},100)})}),Ee(()=>{p&&p.disconnect()});const R=Z(()=>{const o=i.value.filter(u=>{const c=w.category==="multi-embeddings",n=u.request_path,f=c?["multi-embeddings","embedding"]:[w.category];return Array.isArray(n)?n.some(K=>f.includes(K)):f.includes(n)}).sort((u,c)=>new Date(c.release_date).getTime()-new Date(u.release_date).getTime());if(o.length>1){const[u,c,...n]=o;return[c,u,...n]}return o}),$=A([]),x=A([]),ue=()=>{w.allowBAAI?$.value=se:$.value=R.value,x.value=$.value},ce=(o,u)=>{u(()=>{o?x.value=$.value.filter(c=>c.name.toLowerCase().includes(o.toLowerCase())):x.value=$.value})},pe=async()=>{var n;E.value=!0,(n=i.value)!=null&&n.length||await s.getModels(),E.value=!1,ue();const o=new URL(window.location.href),u=o.searchParams.get("model"),c=u&&i.value.find(f=>f.name===u);if(c)b("chooseModel",c),o.searchParams.delete("model"),window.history.pushState({},"",o);else switch(w.category){case"embedding":case"multi-embeddings":i.value.length>0&&(S.value&&["zh-CN","zh-TW"].includes(S.value)?P():S.value==="de"?B():w.allowBAAI?b("chooseModel",se[0]):b("chooseModel",F.value));break;case"rank":b("chooseModel",ie.value)}for(const f of R.value)f.replicas=await s.getReplicas(s.apiKey,f.name);b("modelsLoaded")},me=o=>{he("event","embedding_view_model_detail",{location:fe.location.href,model:o}),Ne(`https://huggingface.co/jinaai/${o}`)},T=A(""),ge=o=>{Le(o).then(()=>{T.value=o}),setTimeout(()=>{T.value=""},1800)},he=window.gtag,fe=window.document,O=o=>o==="en"?"\u{1F1FA}\u{1F1F8}":o==="zh"?"\u{1F1E8}\u{1F1F3}\u{1F1FA}\u{1F1F8}":o==="de"?"\u{1F1E9}\u{1F1EA}\u{1F1FA}\u{1F1F8}":o==="es"?"\u{1F1EA}\u{1F1F8}\u{1F1FA}\u{1F1F8}":"\u{1F30D}";return(o,u)=>{var c;return M(),k(Ce,{borderless:"",ref_key:"componentRef",ref:j,class:"cursor-pointer","use-input":"","fill-input":"",filled:"",square:"","hide-selected":"","input-debounce":"0",modelValue:g.value,"onUpdate:modelValue":u[1]||(u[1]=n=>g.value=n),"display-value":(c=g.value)==null?void 0:c.name,options:x.value,"option-label":n=>n.name,"option-value":n=>n.name,loading:E.value,disable:E.value,"label-color":"grey-5",label:o.category==="rank"?d(t)("embedding.select_rerank_model"):d(t)("embedding.select_embedding_model"),onFilter:ce},{prepend:r(()=>[l(X,{name:o.spaceSaving?void 0:"img:"+(o.category==="rank"?d(xe):d(Ke))},null,8,["name"])]),"no-option":r(()=>[o.allowNone?Y((M(),k(ee,{key:0,clickable:"",active:!o.currentModel,onClick:u[0]||(u[0]=n=>b("chooseModel",null)),class:"q-pa-md"},{default:r(()=>[l(ae,null,{default:r(()=>[l(I,{overline:"",caption:""},{default:r(()=>[h(m(d(t)("embedding.none")),1)]),_:1}),l(I,{class:"text-weight-bold"},{default:r(()=>[h(m(d(t)(`embedding.${o.category}_none_description`)),1)]),_:1})]),_:1})]),_:1},8,["active"])),[[De],[Ve]]):z("",!0)]),option:r(({opt:n,itemProps:f})=>{var K;return[l(ee,Te(f,{active:n.name===((K=g.value)==null?void 0:K.name),class:"q-pa-md"}),{default:r(()=>[l(ae,null,{default:r(()=>[l(I,{class:"text-weight-bold"},{default:r(()=>[Fe("code",null,m(n.name),1),l(X,{class:"q-ml-sm cursor-pointer",name:T.value===n.name?"done":"content_copy",onClick:te(D=>ge(n.name),["stop"])},null,8,["name","onClick"])]),_:2},1024),l(I,{overline:"",caption:""},{default:r(()=>[h(m(d(t)(`embedding.${n.name.replace(".","_")}_description`)),1)]),_:2},1024),l(I,{caption:"",class:"row"},{default:r(()=>{var D,V,U,N,W,Q,G,H;return[o.allowBAAI?z("",!0):(M(),k(_,{key:0,label:n.replicas>0?d(t)("embedding.running"):d(t)("embedding.sleeping"),square:"",size:"xs",outline:"",icon:n.replicas>0?"play_circle_filled":"mdi-sleep",color:n.replicas>0?"positive":"warning",style:{"border-radius":"0"}},{default:r(()=>[l(y,{"max-width":"300px"},{default:r(()=>[h(m(d(t)("embedding.status_explain")),1)]),_:1})]),_:2},1032,["label","icon","color"])),n.tags&&n.tags.includes("multimodal")?(M(),k(_,{key:1,square:"",size:"xs",outline:"",color:n.name!==((D=g.value)==null?void 0:D.name)?"grey-5":"",style:{"border-radius":"0"},label:d(t)("embedding.multimodal"),icon:"mms"},{default:r(()=>[l(y,null,{default:r(()=>[h(m(d(t)("embedding.multimodal_explain")),1)]),_:1})]),_:2},1032,["color","label"])):z("",!0),n.request_path.includes("multi-embeddings")&&o.category.includes("embedding")?(M(),k(_,{key:2,color:n.name!==((V=g.value)==null?void 0:V.name)?"grey-5":"",style:{"border-radius":"0"},icon:"grid_4x4",label:d(t)("embedding.multi_embedding"),square:"",size:"xs",outline:""},{default:r(()=>[l(y,null,{default:r(()=>[h(m(d(t)("embedding.multi_embedding_explain")),1)]),_:1})]),_:2},1032,["color","label"])):z("",!0),l(_,{label:n.meta_data.token_length,square:"",color:n.name!==((U=g.value)==null?void 0:U.name)?"grey-5":"",size:"xs",outline:"",icon:"notes",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[h(m(d(t)("embedding.token_length_explain",{_tokenLength:n.meta_data.token_length})),1)]),_:2},1024)]),_:2},1032,["label","color"]),n.request_path.includes("embedding")?(M(),k(_,{key:3,label:n.meta_data.output_dim,square:"",color:n.name!==((N=g.value)==null?void 0:N.name)?"grey-5":"",size:"xs",outline:"",icon:"mdi-axis-arrow",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[h(m(d(t)("embedding.output_dim_explain",{_outputDim:n.meta_data.output_dim})),1)]),_:2},1024)]),_:2},1032,["label","color"])):z("",!0),l(_,{label:n.meta_data.size,square:"",size:"xs",color:n.name!==((W=g.value)==null?void 0:W.name)?"grey-5":"",outline:"",icon:"mdi-matrix",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[h(m(d(t)("embedding.size_explain",{_size:n.meta_data.size})),1)]),_:2},1024)]),_:2},1032,["label","color"]),l(_,{label:O(n.meta_data.language),square:"",color:n.name!==((Q=g.value)==null?void 0:Q.name)?"grey-5":"",size:"xs",outline:"",style:{"border-radius":"0"}},{default:r(()=>[l(y,null,{default:r(()=>[h(m(d(t)("embedding.language_explain",{_language:O(n.meta_data.language)})),1)]),_:2},1024)]),_:2},1032,["label","color"]),Y(l(_,{icon:"img:/huggingface_logo.svg",square:"",size:"xs",outline:"",color:n.name!==((G=g.value)==null?void 0:G.name)?"grey-5":"",style:{"border-radius":"0"},onClick:te(We=>me(n.name),["stop"]),clickable:""},{default:r(()=>[l(y,null,{default:r(()=>[h(m(d(t)("embedding.opensource_explain")),1)]),_:1})]),_:2},1032,["color","onClick"]),[[je,n.name!=="jina-reranker-v1-base-en"]]),n.release_date?(M(),k(_,{key:4,square:"",size:"xs",outline:"",color:n.name!==((H=g.value)==null?void 0:H.name)?"grey-5":"",style:{"border-radius":"0"},label:n.release_date,icon:"calendar_month"},{default:r(()=>[l(y,{"max-width":"300px"},{default:r(()=>[h(m(d(t)("embedding.add_time_explain")),1)]),_:1})]),_:2},1032,["color","label"])):z("",!0)]}),_:2},1024)]),_:2},1024)]),_:2},1040,["active"])]}),_:1},8,["modelValue","display-value","options","option-label","option-value","loading","disable","label"])}}});export{Be as B,Ve as C,Pe as T,Xe as _,Oe as u};
