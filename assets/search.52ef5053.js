import{c8 as m,bY as g,c9 as f,aN as w,bq as y}from"./index.1c75e1df.js";import{u as b}from"./blogs.3dfeed3d.js";const C=m.value.map(t=>({...t,type:"product"}));var S=(t=>(t.PRODUCT="product",t.NEWS="news",t.COMPANY="company",t.ELLIPSIS="ellipsis",t.HEADER="header",t.SEPARATOR="separator",t.ON_PAGE_RAG="onPageRAG",t.ASK_SOLUTION="askSolution",t))(S||{});const N=g("search",{state:()=>({answerChunks:[],isBusy:!1,isStreaming:!1,isComposing:!1,searchImmediate:!1}),getters:{},actions:{async composeResult(t){this.isComposing=!0;try{const i=b(),a=3;let o=C;i.allBlogs.length===0&&await i.getAllNews();const l=i.allBlogs.map(s=>({label:s.title,icon:s.featureImage,value:s.title,description:s.excerpt,time:f(s.publishedAt).format("MMMM DD, YYYY"),slug:s.slug,type:"news"}));let n=l,r=w.filter(s=>!s.external);t&&(o=o.filter(s=>this.t(s.label).toLowerCase().includes(t.toLowerCase())||this.t(s.description).toLowerCase().includes(t.toLowerCase())),n=l.filter(s=>s.label.toLowerCase().includes(t.toLowerCase())),n.length===0&&(n=l.filter(s=>s.description.toLowerCase().replaceAll("-"," ").includes(t.toLowerCase()))),r=r.filter(s=>this.t(s.label).toLowerCase().includes(t.toLowerCase())));let e=[{type:"onPageRAG",label:t},{type:"askSolution",label:t}];return o.length&&(e.length&&e.push({type:"separator"}),e.push({label:"header.products",number:o.length,type:"header"}),e=e.concat(o.slice(0,a)),o.length>a&&e.push({label:"header.see_all_products",type:"ellipsis",number:o.length-a})),r.length&&(e.length&&e.push({type:"separator"}),e.push({label:"header.company",number:r.length,type:"header"}),e=e.concat(r.slice(0,a)),r.length>a&&e.push({label:"header.see_all_company",type:"ellipsis",number:r.length-a})),n.length&&(e.length&&e.push({type:"separator"}),e.push({label:"header.news",number:n.length,type:"header"}),e=e.concat(n.slice(0,a)),n.length>a&&e.push({label:"header.see_all_news",type:"ellipsis",number:n.length-a})),e}finally{this.isComposing=!1}},async search(t,i){var n,r;this.answerChunks=[],this.isBusy=!0,this.isStreaming=!0;let a="";i==="onPageRAG"&&await fetch(`https://r.jina.ai/https://jina.ai${window.location.pathname}`).then(e=>e.text()).then(e=>{a=e});const o={parameters:{question:t,content:a}},l=i==="onPageRAG"?"https://api.promptperfect.jina.ai/BcHLFuKk3u9naJ4u4G1H":"https://api.promptperfect.jina.ai/EEBuotbLAugUDjr4mq1j";try{const e=await fetch(l,{headers:{"content-type":"application/json"},body:JSON.stringify(o),method:"POST"});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);if((n=e.headers.get("content-type"))!=null&&n.includes("text/event-stream")){if(e.body){const s=e.body.getReader(),p=new TextDecoder;for(;;){const{done:u,value:h}=await s.read();if(u){this.isStreaming=!1;break}h&&(this.isBusy=!1,p.decode(h).split(`

`).forEach(d=>{const c=d.replace(/data: /g,"");c&&this.answerChunks.push(c)}))}}}else if((r=e.headers.get("content-type"))!=null&&r.includes("application/json")){const s=(await e.json()).data;this.answerChunks=[s]}else throw new Error("Unknown response type")}catch(e){y.create({color:"negative",message:this.t("landing_page.error",{message:e}),icon:"report_problem"})}finally{this.isBusy=!1}}}});export{S as R,N as u};
