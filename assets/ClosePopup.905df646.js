import{bc as d,b5 as p,bd as u,be as l,H as h}from"./index.51cbf010.js";const s="https://embeddings-dashboard-api.jina.ai",n="https://api.jina.ai";var m=(e=>(e.CONSUME="consume",e.PURCHASE="purchase",e.TRIAL="trial",e))(m||{}),w=(e=>(e.IN_PROGRESS="in-progress",e.FAILED="failed",e.COMPLETED="completed",e))(w||{});const g=["price_1OPN9mEoTOtb5eZvzwg42kde","price_1OPNDjEoTOtb5eZvSaakR9th"],k=d("embedding",{state:()=>({apiKey:"",models:[],products:[],testData:[],userDocuments:"",userSearchDocs:"",userVisualizeDocs:""}),persist:{paths:["apiKey","testData"]},getters:{baseEnModel:e=>e.models.find(t=>t.name==="jina-clip-v1"),jinaRerankerV1:e=>e.models.find(t=>t.name==="jina-reranker-v1-base-en"),jinaRerankerMultilingual:e=>e.models.find(t=>t.name==="jina-reranker-v2-base-multilingual"),clipV1:e=>e.models.find(t=>t.name==="jina-clip-v1"),baseZhModel:e=>e.models.find(t=>t.name==="jina-embeddings-v2-base-zh"),baseDeModel:e=>e.models.find(t=>t.name==="jina-embeddings-v2-base-de"),newModels:e=>e.models.filter(t=>new Date().getTime()-new Date(t.created_at).getTime()<1e3*60*60*24*30).map(t=>t.name)},actions:{async getReplicas(e,t){try{const r=await fetch(`${s}/api/v1/models/slug/${t}`,{method:"GET"});if(!r.ok)throw new Error(`getReplicas error! Status: ${r.status}`);return(await r.json()).num_replicas}catch(r){console.error("getReplicas error:",r)}},async getApiKey(){try{const e=await fetch(`${s}/api/v1/api_key`,{method:"POST"});if(!e.ok)throw new Error(`getApiKey error! Status: ${e.status}`);const t=await e.json();return this.apiKey=t.api_key,!0}catch(e){return console.error("getApiKey error:",e),!1}},async getTokens(e){try{const t=await fetch(`${s}/api/v1/api_key/user?api_key=${e}`);if(!t.ok)throw new Error(`getTokens error! Status: ${t.status}`);return(await t.json()).wallet.total_balance}catch(t){console.error("getTokens error:",t)}},async getModels(e){try{const t=await fetch(`${s}/api/v1/models`);if(!t.ok)throw new Error(`getModels error! Status: ${t.status}`);const r=await t.json();this.models=r,console.log("getModels data:",r)}catch(t){console.error("getModels error:",t)}},async getProducts(){try{const e=await fetch(`${s}/api/v1/product`);if(!e.ok)throw new Error(`getProducts error! Status: ${e.status}`);let t=await e.json();t=t.filter(r=>g.includes(r.price_id)),t.unshift({id:"0",product_id:"0",product_name:"1M tokens",product_description:"A pack of 1 million tokens",price:0,price_id:"0",currency:"USD",token_quantity:1e6}),console.log("getProducts data:",t),this.products=t}catch(e){console.error("getProducts error:",e)}},async getUsage(e){try{const t=await fetch(`${s}/api/v1/billing/transaction`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error(`getUsage error! Status: ${t.status}`);return await t.json()}catch(t){console.error("getUsage error:",t)}},async checkoutWithStripe(e,t){try{const r=await fetch(`${s}/api/v1/checkout_session`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify(t),mode:"cors",credentials:"include"});if(!r.ok)throw new Error(`checkoutWithStripe error! Status: ${r.status}`);return await r.json()}catch(r){console.error("checkoutWithStripe error:",r)}},async bulkEmbedding(e,t){var i;const r={accept:"application/json",Authorization:`Bearer ${e}`},o=new FormData;o.append("model",t.model),o.append("email",(i=t.email)!=null?i:""),o.append("file",t.file);const a=await fetch(`${n}/v1/bulk-embeddings`,{method:"POST",headers:r,body:o});if(a.ok)return await a.json();throw new Error(`${a.status}: ${a.statusText}`)},async checkBulk(e,t){const r={accept:"application/json",Authorization:`Bearer ${e}`},o=await fetch(`${n}/v1/bulk-embeddings/${t}`,{method:"GET",headers:r});if(o.ok)return await o.json();throw new Error(`${o.status}: ${o.statusText}`)},async getBulkResult(e,t){const r={accept:"application/json",Authorization:`Bearer ${e}`},o=await fetch(`${n}/v1/bulk-embeddings/${t}/download-result`,{method:"POST",headers:r});if(o.ok){const{download_url:a}=await o.json();return a}else throw new Error(`${o.status}: ${o.statusText}`)}}});function c(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var y=p({name:"close-popup",beforeMount(e,{value:t}){const r={depth:c(t),handler(o){r.depth!==0&&setTimeout(()=>{const a=u(e);a!==void 0&&l(a,o,r.depth)})},handlerKey(o){h(o,13)===!0&&r.handler(o)}};e.__qclosepopup=r,e.addEventListener("click",r.handler),e.addEventListener("keyup",r.handlerKey)},updated(e,{value:t,oldValue:r}){t!==r&&(e.__qclosepopup.depth=c(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});export{w as B,y as C,m as T,k as u};
