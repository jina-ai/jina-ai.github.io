import{s as Ae,au as Ne,v as Fe,aw as Ve,C as ze,m as U,p as X,T as He,J as Ce,as as Ze,aB as Ye,e as W,aC as N,j as ae,a0 as te,k as A,a2 as ie,a3 as f,a4 as h,a5 as i,a6 as n,a7 as ue,ad as V,ae as S,aq as L,af as v,ag as u,aD as xe,q as z,ap as ye,a8 as q,aE as Ge,aF as le,aG as Je,aH as We,aI as Xe,aJ as oe,ao as $e,aK as ea,aa as Z,ab as M,aL as we,aM as ke,n as Le,am as me,aN as aa,aO as Pe,aP as ta,W as qe,aQ as ia,aR as na,aS as la,aj as D,aT as oa,ah as se,ai as re,ac as sa,a9 as de,aA as ra,aU as da,aV as ca,K as ua,at as ma,L as Ke,V as fa,aW as ya,aX as _a,aY as ga}from"./index-CYeUJ1yv.js";import{Q as B}from"./QItemLabel-BxGswg9A.js";import{Q as E}from"./QTooltip-Bs6xysO6.js";import{a as Re,Q as pa,b as Me}from"./QChip-DDMwlEVS.js";import{Q as Se}from"./QList-BvDRPka3.js";import{Q as ha}from"./QExpansionItem-Dn_pgGOf.js";import{c as ba}from"./copy-to-clipboard-CtfJb2eU.js";import{u as F,a as va,T as ce,Q as wa}from"./use-dialog-plugin-component-YgyTBDNM.js";import{d as ka,f as fe,Q as Be,a as O,b as Ie,c as Pa,e as Ka}from"./date-o9dPCliX.js";import{C as Sa}from"./ClosePopup-BAhsXjOY.js";import{Q as Ue}from"./QLinearProgress-CrNR4Iem.js";const Te=Ae({name:"QInnerLoading",props:{...Ne,...Fe,showing:Boolean,color:String,size:{type:[String,Number],default:"42px"},label:String,labelClass:String,labelStyle:[String,Array,Object]},setup(l,{slots:o}){const t=Ce(),e=Ve(l,t.proxy.$q),{transitionProps:m,transitionStyle:d}=ze(l),a=U(()=>"q-inner-loading q--avoid-card-border absolute-full column flex-center"+(e.value===!0?" q-inner-loading--dark":"")),_=U(()=>"q-inner-loading__label"+(l.labelClass!==void 0?` ${l.labelClass}`:""));function g(){const T=[X(Ze,{size:l.size,color:l.color})];return l.label!==void 0&&T.push(X("div",{class:_.value,style:l.labelStyle},[l.label])),T}function w(){return l.showing===!0?X("div",{class:a.value,style:d.value},o.default!==void 0?o.default():g()):null}return()=>X(He,m.value,w)}}),_e=Ye("apiKey",{state:()=>({keys:[],isLoading:!1,keysInfoCache:{},isBusyState:new Set,isChecking:!1}),getters:{primaryKey:l=>{var o;return(o=l.keys.find(t=>t.isPrimary))==null?void 0:o.key},primaryKeyInfo:l=>{var o;return l.keysInfoCache[((o=l.keys.find(t=>t.isPrimary))==null?void 0:o.key)||""]}},actions:{async addKey(l,o){var t;if(!(!((t=W.currentUser)!=null&&t.uid)||!l))try{const{data:e}=await N.request("apiKey","addKey",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await N.getIdToken()}`},body:JSON.stringify({key:l,metadata:o})});return e&&(this.keys.unshift(e),this.getKeyInfo(l)),e}catch(e){console.error(e)}},async setPrimaryKey(l){var o;if((o=W.currentUser)!=null&&o.uid){this.isBusyState.add(l);try{const{data:t}=await N.request("apiKey","setPrimaryKey",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await N.getIdToken()}`},body:JSON.stringify({key:l,isPrimary:!0})});return t&&(this.keys.forEach(e=>(e.key===l?e.isPrimary=!0:e.isPrimary=!1,e)),F().apiKey=l),t}catch(t){console.error(t)}finally{this.isBusyState.delete(l)}}},async checkPrimaryKey(){var l;if((l=W.currentUser)!=null&&l.uid&&!this.isChecking)try{this.isChecking=!0;const o=F();this.primaryKey&&this.primaryKey!==o.apiKey?o.isPaidUser?(this.keys.find(e=>e.key===o.apiKey)||await this.addKey(o.apiKey),await this.setPrimaryKey(o.apiKey)):o.apiKey=this.primaryKey:await this.getKeyInfo(o.apiKey)}finally{this.isChecking=!1}},async removeKey(l){var o;if((o=W.currentUser)!=null&&o.uid){this.isBusyState.add(l);try{const{data:t}=await N.request("apiKey","removeKey",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await N.getIdToken()}`},body:JSON.stringify({key:l})});t&&(this.keys.splice(this.keys.findIndex(e=>e.key===l),1),delete this.keysInfoCache[l])}catch(t){console.error(t)}finally{this.isBusyState.delete(l)}}},async fetchKeys(l=!0){var o;if(!(!((o=W.currentUser)!=null&&o.uid)||this.isLoading)){this.isLoading=!0;try{const{data:t}=await N.request("apiKey","keyList",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await N.getIdToken()}`}});if(this.keys=t,l)for(const e of this.keys)this.getKeyInfo(e.key)}catch(t){console.error(t)}finally{this.isLoading=!1}}},async getKeyInfo(l,o=!1){var t,e,m;if(l&&!this.isBusyState.has(l))try{this.isBusyState.add(l);const d=await F().getKeyInfo(l);if(l===F().apiKey&&(F().apiKeyInfo=d),o){this.keysInfoCache[l]={...d,usage:((t=this.keysInfoCache[l])==null?void 0:t.usage)||[],last_used_at:(e=this.keysInfoCache[l])==null?void 0:e.last_used_at};return}const a=await F().getUsage(l);this.keysInfoCache[l]={...d,usage:a,last_used_at:(m=a==null?void 0:a[0])==null?void 0:m.updated_at}}finally{this.isBusyState.delete(l)}},isFreeKey(l){var o,t;return l?!((t=(o=this.keysInfoCache[l])==null?void 0:o.metadata)!=null&&t.speed_level):!1},isPaidKey(l){var o,t;return l?((t=(o=this.keysInfoCache[l])==null?void 0:o.metadata)==null?void 0:t.speed_level)===1:!1},isPremiumPaidKey(l){var o,t;return l?((t=(o=this.keysInfoCache[l])==null?void 0:o.metadata)==null?void 0:t.speed_level)===2:!1}}}),Ia=ae({__name:"UsageHistoryDialog",props:{apiKey:{}},setup(l,{expose:o}){o();const t=l,{t:e}=te({useScope:"global"}),m=_e(),{dialogRef:d}=va(),a=()=>{var r;(r=T.value)==null||r.requestServerInteraction()},_=()=>{I.value=[]},g=r=>{var R,C;switch((R=r.request_path)==null?void 0:R.toLowerCase()){case"/encode":case"/checkfact":return w((C=r.metadata)==null?void 0:C.model_name);case"/embeddings":case"/rerank":case"/classify":case"/train":return`api.jina.ai/v1${r.request_path}`;case"/multi-embeddings":return"api.jina.ai/v1/multi-vector";case"/segment":return"segment.jina.ai";default:return r.request_path}},w=r=>{if(!r)return"";switch(r.toLowerCase()){case"reader-crawl":return"r.jina.ai";case"reader-search":return"s.jina.ai";case"grounding-checkfact":return"g.jina.ai";default:return r}},T=A(null),I=A([]),y=A([{name:"icon",label:"",field:"amount",sortable:!1,align:"right"},{name:"createdAt",label:e("embedding.usage_time"),field:"createdAt",sortable:!1,align:"left",format:r=>ka.formatDate(r,"YYYY-MM-DD")},{name:"amount",label:e("embedding.tokens"),field:"amount",sortable:!1,align:"right",format:r=>r>0?`+${r}`:`${r}`},{name:"reason",label:e("embedding.usage_reason"),field:"reason",sortable:!1,align:"left"},{name:"requestPath",label:e("embedding.request_path"),field:"request_path",sortable:!1,align:"left"},{name:"requestNumber",label:e("embedding.request_number"),field:"request_number",sortable:!1,align:"right",format:r=>r?fe(r):""}]),K={props:t,t:e,apiKeyStore:m,dialogRef:d,onUsageHistoryDialogShow:a,onUsageHistoryDialogHide:_,getEndpoint:g,formatModelName:w,usageTableRef:T,usageRows:I,usageColumns:y,getUsageHistory:async()=>{var R,C;await m.getKeyInfo(t.apiKey);const r=(C=(R=m.keysInfoCache)==null?void 0:R[t.apiKey])==null?void 0:C.usage;!r||r.length===0||(I.value=r.map(P=>{const c=new Date(P.updated_at);let k=P.quantity,b=e(`embedding.usage_reason_${P.type.replaceAll(" ","_")}`);return P.type===ce.CONSUME||P.type===ce.TRANSFER_OUT?(k=-k,P.metadata.model_name&&(b=b+": "+w(P.metadata.model_name))):(P.metadata.product_name&&(b=b+": "+P.metadata.product_name),P.metadata.order_quantity&&P.metadata.order_quantity>1&&(b=b+` (x ${P.metadata.order_quantity})`)),{createdAt:c,amount:k,reason:b,request_path:g(P),request_number:P.request_number,type:P.type}}))},get QTable(){return Be},get TRANSACTION_TYPE(){return ce},get formatNumber(){return fe}};return Object.defineProperty(K,"__isScriptSetup",{enumerable:!1,value:!0}),K}});function Ta(l,o,t,e,m,d){return f(),h(Ge,{ref:"dialogRef",onShow:e.onUsageHistoryDialogShow,onHide:e.onUsageHistoryDialogHide},{default:i(()=>[n(ue,{style:{width:"1000px","max-width":"80vw"}},{default:i(()=>[n(V,{class:"q-pa-md"},{default:i(()=>[n(S,{avatar:""},{default:i(()=>[n(L,{name:"history"})]),_:1}),n(S,null,{default:i(()=>[n(B,null,{default:i(()=>[v(u(e.t("embedding.usage_history")),1)]),_:1}),n(B,{caption:""},{default:i(()=>[v(u(e.t("embedding.usage_history_explain")),1)]),_:1})]),_:1}),n(S,{side:""},{default:i(()=>[xe(n(z,{icon:"close",flat:"",round:"",dense:""},null,512),[[Sa]])]),_:1})]),_:1}),n(ye),n(e.QTable,{ref:"usageTableRef",flat:"",class:"bg-transparent","row-key":"createdAt",rows:e.usageRows,columns:e.usageColumns,loading:e.apiKeyStore.isBusyState.has(e.props.apiKey),onRequest:e.getUsageHistory,pagination:{rowsPerPage:10}},{"body-cell-icon":i(a=>[n(O,{key:"icon",props:a},{default:i(()=>[a.row.amount>0||a.row.type===e.TRANSACTION_TYPE.TRANSFER_IN&&a.row.amount==0?(f(),h(L,{key:0,name:"o_add_circle_outline",color:"primary"})):(f(),h(L,{key:1,name:"o_remove_circle_outline",color:"negative"}))]),_:2},1032,["props"])]),"body-cell-amount":i(a=>[n(O,{key:"amount",props:a},{default:i(()=>[v(u((a.row.amount>0||a.row.type===e.TRANSACTION_TYPE.TRANSFER_IN&&a.row.amount==0?"+":"")+e.formatNumber(a.row.amount)),1)]),_:2},1032,["props"])]),"body-cell-requestPath":i(a=>[n(O,{key:"request_path",props:a},{default:i(()=>[q("code",null,u(a.row.request_path),1)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])]),_:1})]),_:1},512)}const Aa=ie(Ia,[["render",Ta],["__file","UsageHistoryDialog.vue"]]),Ca=ae({__name:"RateLimitComponent",props:{showActionButtons:Boolean},setup(l,{expose:o}){o();const{t}=te({useScope:"global"}),e=$e(),m=A([{icon:le,endpoint:"https://r.jina.ai",name:t("reader.title"),description:t("rate_limit.rjinaai"),requestType:"GET/POST",woAPIkey:"20 RPM",wAPIkey:"200 RPM",wPremium:"1000 RPM",tokenCounting:t("rate_limit.output_token_counting"),latency:"4.6s",weight:e.name==="reader"?100:18},{icon:le,endpoint:"https://s.jina.ai",name:t("reader.title"),description:t("rate_limit.sjinaai"),requestType:"GET/POST",woAPIkey:null,wAPIkey:"40 RPM",wPremium:"100 RPM",tokenCounting:t("rate_limit.output_token_counting"),latency:"8.7s",weight:e.name==="reader"?99:17},{icon:le,endpoint:"https://g.jina.ai",name:t("reader.title"),description:t("rate_limit.gjinaai"),requestType:"GET/POST",woAPIkey:null,wAPIkey:"10 RPM",wPremium:"30 RPM",tokenCounting:t("rate_limit.total_token_counting"),latency:"22.7s",weight:e.name==="reader"?99:17},{icon:Je,endpoint:"https://segment.jina.ai",name:t("tokenizer.title"),description:t("rate_limit.tokenizer"),requestType:"GET/POST",woAPIkey:"20 RPM",wAPIkey:"200 RPM",wPremium:"1,000 RPM",tokenCounting:t("rate_limit.no_token_counting"),latency:"0.3s",weight:e.name==="segmenter"?100:1},{icon:We,endpoint:"https://api.jina.ai/v1/embeddings",name:t("embedding.title"),description:t("rate_limit.embeddings"),requestType:"POST",woAPIkey:null,wAPIkey:"500 RPM & 1,000,000 TPM",wPremium:"2,000 RPM & 5,000,000 TPM",tokenCounting:t("rate_limit.input_token_counting"),latency:null,latencyDepends:t("rate_limit.depends"),latencyExplain:t("rate_limit.batch_explain"),weight:e.name==="embeddings"?100:20},{icon:Xe,endpoint:"https://api.jina.ai/v1/rerank",name:t("reranker.title"),description:t("rate_limit.tokenizer"),requestType:"POST",woAPIkey:null,wAPIkey:"500 RPM & 1,000,000 TPM",wPremium:"2,000 RPM & 5,000,000 TPM",tokenCounting:t("rate_limit.input_token_counting"),latency:null,latencyDepends:t("rate_limit.depends"),latencyExplain:t("rate_limit.batch_explain"),weight:e.name==="reranker"?100:19},{icon:oe,endpoint:"https://api.jina.ai/v1/classify",name:`${t("classifier.title")} (${t("classifier.compare_table.zero_shot")})`,description:t("rate_limit.classifier_zero_shot"),requestType:"POST",woAPIkey:null,wAPIkey:"200 RPM & 500,000 TPM",wPremium:"1,000 RPM & 3,000,000 TPM",tokenCounting:t("rate_limit.classifier_zero_shot_token_counting"),latency:null,latencyDepends:t("rate_limit.depends"),weight:e.name==="classifier"?100:15},{icon:oe,endpoint:"https://api.jina.ai/v1/classify",name:`${t("classifier.title")} (${t("classifier.compare_table.few_shot")})`,description:t("rate_limit.classifier_few_shot"),requestType:"POST",woAPIkey:null,wAPIkey:"20 RPM & 200,000 TPM",wPremium:"60 RPM & 1,000,000 TPM",tokenCounting:t("rate_limit.classifier_few_shot_token_counting"),latency:null,latencyDepends:t("rate_limit.depends"),weight:e.name==="classifier"?98:15},{icon:oe,endpoint:"https://api.jina.ai/v1/train",name:t("classifier.title"),description:t("rate_limit.classifier"),requestType:"POST",woAPIkey:null,wAPIkey:"20 RPM & 200,000 TPM",wPremium:"60 RPM & 1,000,000 TPM",tokenCounting:t("rate_limit.classifier_token_counting"),latency:null,latencyDepends:t("rate_limit.depends"),weight:e.name==="classifier"?99:15}]),d=A([{name:"icon",field:"icon",label:"",align:"left"},{name:"name",field:"name",label:t("rate_limit.product"),align:"left"},{name:"endpoint",field:"endpoint",label:t("rate_limit.endpoint"),align:"left"},{name:"description",field:"description",label:t("rate_limit.description"),align:"left",sortable:!0},{name:"woAPIkey",field:"woAPIkey",label:t("rate_limit.woAPIkey"),align:"right"},{name:"wAPIkey",field:"wAPIkey",label:t("rate_limit.wAPIkey"),align:"right"},{name:"wPremium",field:"wPremium",label:t("rate_limit.wPremium"),align:"right"},{name:"latency",field:"latency",label:t("rate_limit.latency"),align:"right"},{name:"tokenCounting",field:"tokenCounting",label:t("rate_limit.tokenCounting"),align:"left"},{name:"requestType",field:"requestType",label:t("rate_limit.requestType"),align:"left"}]),a=A(d.value.map(T=>T.name)),_=U(()=>m.value.sort((T,I)=>I.weight-T.weight)),g=A({rowsPerPage:10}),w={t,route:e,rows:m,columns:d,visibleColumns:a,sortedRows:_,initialPagination:g};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),xa=["innerHTML"],La={class:"text-bold silver-foil"},qa={class:"text-bold golden-foil"},Ra={class:"row q-pa-md justify-center full-width"},Ma={key:1},Ba={class:"silver-foil text-bold"},Ua={class:"golden-foil text-bold"},Da={key:1};function Ea(l,o,t,e,m,d){return f(),h(Be,{class:"my-sticky-column-table",flat:"",square:"","title-class":"q-pa-md",title:e.t("rate_limit.title"),rows:e.sortedRows,columns:e.columns,"row-key":"endpoint",pagination:e.initialPagination,"hide-pagination":"","visible-columns":e.visibleColumns},ea({top:i(()=>[n(V,{class:"full-width q-pa-lg"},{default:i(()=>[n(S,null,{default:i(()=>[n(B,{class:"text-weight-bold"},{default:i(()=>[v(u(e.t("rate_limit.title")),1)]),_:1}),n(B,{caption:""},{default:i(()=>[q("span",{innerHTML:e.t("rate_limit.explain")},null,8,xa)]),_:1})]),_:1}),n(wa),n(S,{side:""},{default:i(()=>[n(Ue,{modelValue:e.visibleColumns,"onUpdate:modelValue":o[0]||(o[0]=a=>e.visibleColumns=a),multiple:"",outlined:"",square:"",dense:"","options-dense":"","display-value":l.$q.lang.table.columns,"emit-value":"","map-options":"",options:e.columns,"option-value":"name","options-cover":"",style:{"min-width":"150px"}},null,8,["modelValue","display-value","options"])]),_:1})]),_:1})]),"header-cell-wAPIkey":i(a=>[n(Ie,{props:a},{default:i(()=>[q("span",La,u(a.col.label),1)]),_:2},1032,["props"])]),"header-cell-wPremium":i(a=>[n(Ie,{props:a},{default:i(()=>[q("span",qa,u(a.col.label),1)]),_:2},1032,["props"])]),"body-cell-icon":i(a=>[n(O,{props:a},{default:i(()=>[n(pa,{src:a.value,width:"36px"},null,8,["src"])]),_:2},1032,["props"])]),"body-cell-endpoint":i(a=>[n(O,{props:a},{default:i(()=>[q("code",null,u(a.value),1)]),_:2},1032,["props"])]),"body-cell-woAPIkey":i(a=>[n(O,{props:a},{default:i(()=>[a.value?(f(),Z("span",Ma,u(a.value),1)):(f(),h(L,{key:0,name:"block",color:"negative"}))]),_:2},1032,["props"])]),"body-cell-wAPIkey":i(a=>[n(O,{props:a},{default:i(()=>[q("span",Ba,u(a.value),1),String(a.value).includes("X")?(f(),h(L,{key:0,name:"keyboard_double_arrow_up",color:"primary",class:"cursor-pointer"},{default:i(()=>[n(E,{"max-width":"300px"},{default:i(()=>[v(u(e.t("rate_limit.batch_explain")),1)]),_:1})]),_:1})):M("",!0)]),_:2},1032,["props"])]),"body-cell-wPremium":i(a=>[n(O,{props:a},{default:i(()=>[q("span",Ua,u(a.value),1)]),_:2},1032,["props"])]),"body-cell-latency":i(a=>[n(O,{props:a},{default:i(()=>[a.value?(f(),Z("span",Da,u(a.value),1)):(f(),h(Me,{key:0,icon:"bolt",label:a.row.latencyDepends,size:"sm"},{default:i(()=>[v(u(a.value)+" ",1),a.row.latencyExplain?(f(),h(L,{key:0,name:"help",class:"cursor-pointer q-ml-sm"},{default:i(()=>[n(E,{"max-width":"300px"},{default:i(()=>[v(u(a.row.latencyExplain),1)]),_:2},1024)]),_:2},1024)):M("",!0)]),_:2},1032,["label"]))]),_:2},1032,["props"])]),_:2},[t.showActionButtons?{name:"bottom",fn:i(()=>[q("div",Ra,[n(Re,{outline:"",square:""},{default:i(()=>[n(z,{outline:"",label:e.t("get_new_key"),square:"",icon:"key",href:"/?sui=apikey",padding:"md",target:"_blank"},null,8,["label"]),n(ye),n(z,{outline:"",label:e.t("header.contact_us"),square:"",icon:"handshake",to:"/contact-sales",padding:"md"},null,8,["label"])]),_:1})])]),key:"0"}:void 0]),1032,["title","rows","columns","pagination","visible-columns"])}const Oa=ie(Ca,[["render",Ea],["__file","RateLimitComponent.vue"]]),Qa=ae({__name:"AutoRechargeItem",props:we({apiKey:{},disable:{type:Boolean},isAutoCharge:{type:Boolean},isPaidKey:{type:Boolean},navigateToPurchase:{type:Boolean}},{autoRecharge:{type:Boolean},autoRechargeModifiers:{},rechargeThreshold:{type:Number},rechargeThresholdModifiers:{}}),emits:we(["update"],["update:autoRecharge","update:rechargeThreshold"]),setup(l,{expose:o,emit:t}){o();const e=l,m=t,d=ke(l,"autoRecharge"),a=ke(l,"rechargeThreshold"),{t:_}=te({useScope:"global"}),g=Le(),w=F(),{products:T}=me(w),I=_e(),{isBusyState:y}=me(I),s=[{label:"10K",value:1e4},{label:"1M",value:1e6},{label:"1B",value:1e9}],K=A(!1),r=U(()=>T.value.filter(c=>c.price>0).map(c=>({label:`$${c.price} / `+_(`embedding.${c.product_name.replace(".","_")}`),value:c.price_id}))),P={props:e,emit:m,autoRecharge:d,rechargeThreshold:a,t:_,$q:g,embeddingStore:w,products:T,apiKeyStore:I,isBusyState:y,rechargeThresholdOptions:s,hideSelected:K,productOptions:r,updateAutoRecharge:async c=>{var k;!e.isAutoCharge&&c?g.dialog({title:_("embedding.auto_recharge_enable_title"),message:_("embedding.auto_recharge_enable_message2"),options:{type:"radio",model:r.value[0].value,items:r.value},cancel:(k=e.navigateToPurchase)!=null?k:!1}).onOk(async b=>{y.value.delete(e.apiKey);const x=new URL(window.location.href),Q=Date.now().toString();x.searchParams.set("price_id",b),x.searchParams.set("session_id",Q),x.searchParams.set("register_status","success"),x.searchParams.set("api_key",Pa(e.apiKey));const Y=x.toString();x.searchParams.set("register_status","cancel");const G=x.toString();if(a.value)try{y.value.add(e.apiKey);const J=await w.setAutoRecharge(e.apiKey,{successUrl:Y,cancelUrl:G,priceId:b,threshold:a.value});J&&(window.location.href=J)}finally{y.value.delete(e.apiKey)}}).onCancel(()=>{d.value=!1}):e.isAutoCharge&&!c&&g.dialog({title:_("embedding.auto_recharge_confirm_title"),message:_("embedding.auto_recharge_confirm_message"),cancel:!0}).onOk(async()=>{y.value.add(e.apiKey);try{await w.cancelAutoRecharge(e.apiKey)||(d.value=!0)}finally{y.value.delete(e.apiKey)}m("update")}).onCancel(()=>{d.value=!0})},updateThreshold:async c=>{const k=a.value;d.value&&e.isAutoCharge&&(K.value=!0,g.dialog({title:_("key_manager.recharge_threshold_confirm_title"),message:_("key_manager.recharge_threshold_confirm_message",{_threshold:Ka(c)}),cancel:!0}).onOk(async()=>{y.value.add(e.apiKey),K.value=!1;try{await w.updateAutoRecharge(e.apiKey,c)}finally{y.value.delete(e.apiKey)}}).onCancel(()=>{K.value=!1,a.value=k}))}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}});function ja(l,o,t,e,m,d){return f(),h(V,{tag:"label",onClick:o[3]||(o[3]=Pe(()=>{},["stop"]))},{default:i(()=>[e.$q.screen.gt.sm?(f(),h(S,{key:0,avatar:""},{default:i(()=>[n(L,{name:"currency_exchange"})]),_:1})):M("",!0),n(S,null,{default:i(()=>[n(B,{class:"text-bold"},{default:i(()=>[v(u(e.t("embedding.auto_recharge")),1)]),_:1}),n(B,{caption:"",lines:"2"},{default:i(()=>[v(u(t.isAutoCharge?e.t("embedding.auto_recharge_enable"):e.t("embedding.auto_recharge_description"))+" ",1),n(E,{"max-width":"40rem"},{default:i(()=>[v(u(t.isAutoCharge?e.t("embedding.auto_recharge_enable"):e.t("embedding.auto_recharge_description")),1)]),_:1})]),_:1})]),_:1}),n(S,{side:""},{default:i(()=>[n(aa,{modelValue:e.autoRecharge,"onUpdate:modelValue":[o[0]||(o[0]=a=>e.autoRecharge=a),e.updateAutoRecharge],color:"primary",disable:t.disable||e.isBusyState.has(t.apiKey),"checked-icon":"check","unchecked-icon":"close"},null,8,["modelValue","disable"])]),_:1}),n(S,{side:""},{default:i(()=>[n(Ue,{modelValue:e.rechargeThreshold,"onUpdate:modelValue":[o[1]||(o[1]=a=>e.rechargeThreshold=a),e.updateThreshold],options:e.rechargeThresholdOptions,"hide-selected":e.hideSelected,disable:e.isBusyState.has(t.apiKey),label:e.t("embedding.recharge_threshold"),style:{"min-width":"160px"},"option-label":a=>`< ${a.label} ${e.t("embedding.tokens")}`,onClick:o[2]||(o[2]=Pe(()=>{},["prevent"])),"emit-value":"","map-options":""},null,8,["modelValue","hide-selected","disable","label","option-label"])]),_:1})]),_:1})}const Na=ie(Qa,[["render",ja],["__file","AutoRechargeItem.vue"]]),Fa=ae({__name:"PurchaseComponent",props:{purchaseKey:{default:""},hideUsage:{type:Boolean,default:!1},hideKey:{type:Boolean,default:!1},hideStripeInfo:{type:Boolean,default:!1},hideFreePlan:{type:Boolean,default:!1},autoCharge:{type:Boolean},threshold:{}},setup(l,{expose:o}){o();const t=l,{t:e}=te({useScope:"global"}),m=Le(),d=_e(),a=F(),{apiKey:_,products:g,isApiKeyInfoLoading:w,isPremiumPaidUser:T,apiKeyInfo:I}=me(a),y=A(t.purchaseKey||_.value),s=A(I==null?void 0:I.value);ta(async()=>{s.value=await a.getKeyInfo(y.value),r.value=t.autoCharge||!x.value||Q.value,R.value=t.threshold||1e6});const K=A(0),r=A(!0),R=A(1e6),C=A(""),P=A(!0),c={"1M tokens":["paywall.no_commercial"],"1B tokens":["paywall.standard_key","paywall.full_commercial","paywall.key_manager"],"11B tokens":["paywall.premium_key","paywall.full_commercial","paywall.premium_key_manager","paywall.priority_support","paywall.free_hour_consult"]},k=U(()=>g.value.map(p=>({...p,isActive:()=>C.value===p.price_id,tag:()=>e(`embedding.${p.product_name}_targetUser`),title:()=>e(`embedding.${p.product_name.replace(".","_")}`),description:()=>e(`embedding.${p.product_name.replace(".","_")}_intuition1`),isFree:p.price===0,priceLabel:()=>p.price>0?`$${p.price}`:e("embedding.free"),priceDescription:()=>p.price>0?`${(p.price/p.token_quantity*1e6).toFixed(3)} ${e("embedding.per_m")}`:e("embedding.1M_free_description"),handler:()=>p.price>0?J(p.price_id):void 0}))),b=U(()=>{var p,j;return(j=(p=s.value)==null?void 0:p.wallet.total_balance)!=null?j:0}),x=U(()=>{var p;return!!((p=s.value)!=null&&p.email)}),Q=U(()=>{var p;return x.value&&!!((p=s.value)!=null&&p.metadata.auto_recharge)}),Y=U(()=>!!y.value&&(s==null?void 0:s.value)!==void 0),G=U(()=>!Y.value||w.value),J=async p=>{var ve;if(G.value||C.value)return;const j=g.value.find(ne=>ne.price_id===p),H=new URL(window.location.href),Oe=Date.now().toString();H.searchParams.set("price_id",p),H.searchParams.set("session_id",Oe),H.searchParams.set("purchase_status","cancel");const Qe=H.toString();H.searchParams.set("purchase_status","success");const je=H.toString();C.value=p;const ee={price_id:p,success_url:je,cancel_url:Qe},he=localStorage.getItem(na);he&&(ee.metadata={sales_key:he}),r.value&&(ee.metadata={...ee.metadata,auto_recharge:!0,threshold:R.value}),j&&gtag("event","begin_checkout",{currency:j.currency,value:j.price,items:[{id:j.product_id,name:j.product_name}]});const be=await a.checkoutWithStripe(y.value,ee);if(C.value="",!be)return;a.apiKey=y.value,((ve=d.keys)==null?void 0:ve.some(ne=>ne.key===y.value))||await d.addKey(y.value),await d.setPrimaryKey(a.apiKey),a.getCurrentKeyInfo(),window.location.href=be.url},ge=async()=>{s.value=await a.getKeyInfo(y.value),r.value=!x.value||Q.value,_.value===y.value&&a.setApiKeyInfo(s.value)},De=async()=>{Y.value&&y.value!==_.value&&m.dialog({title:e("embedding.api_key_update_title"),message:e("embedding.api_key_update_message"),cancel:!0}).onOk(async()=>{_.value=y.value,ge(),await d.addKey(y.value),d.setPrimaryKey(y.value)})},Ee=()=>{G.value||m.dialog({component:Aa,componentProps:{apiKey:y.value}})};qe(async()=>{await a.getProducts(),setInterval(()=>{K.value=(K.value+1)%ia.length},3e3)});const $=A(!1),pe={props:t,t:e,$q:m,apiKeyStore:d,embeddingStore:a,apiKey:_,products:g,isApiKeyInfoLoading:w,isPremiumPaidUser:T,apiKeyInfo:I,inputApiKey:y,inputApiKeyInfo:s,currentIndex:K,autoRecharge:r,rechargeThreshold:R,currentPriceID:C,isPwd:P,tierFeatures:c,productCards:k,apiKeyTokens:b,isPaidUser:x,isAutoCharge:Q,isInputApiKeyValid:Y,isInputApiKeyDisabled:G,checkoutProduct:J,getKeyInfo:ge,updateApiKey:De,openUsageHistoryDialog:Ee,isApiKeyCopyDone:$,copyApiKey:()=>{!_.value||$.value||(ba(_.value).then(()=>{m.notify({message:e("copy_to_clipboard_success"),icon:"done"}),$.value=!0,gtag==null||gtag("event","embedding_copy_api_key",{location:document.location.href})}),setTimeout(()=>{$.value=!1},1800))},get flatEnterprises(){return la},get formatNumber(){return fe},RateLimitComponent:Oa,AutoRechargeItem:Na};return Object.defineProperty(pe,"__isScriptSetup",{enumerable:!1,value:!0}),pe}}),Va=["innerHTML"],za=["innerHTML","data-text"],Ha={class:"row justify-center text-caption text-dim q-pt-md q-pb-sm"},Za={class:"row justify-center q-gutter-x-sm"};function Ya(l,o,t,e,m,d){return f(),h(Se,{class:"q-pa-md q-gutter-y-sm"},{default:i(()=>[!t.hideUsage&&e.isInputApiKeyValid?(f(),h(V,{key:0},{default:i(()=>[e.$q.screen.gt.sm?(f(),h(S,{key:0,avatar:""},{default:i(()=>[n(L,{name:"data_usage"})]),_:1})):M("",!0),n(S,null,{default:i(()=>[n(B,{class:"text-bold"},{default:i(()=>[v(u(e.t("embedding.remaining")),1)]),_:1}),n(B,{class:D({"text-negative":e.apiKeyTokens<0})},{default:i(()=>[q("span",{innerHTML:e.t("embedding.remaining_left",{_leftTokens:e.formatNumber(e.apiKeyTokens)})},null,8,Va)]),_:1},8,["class"])]),_:1}),n(S,{side:""},{default:i(()=>[n(Re,{square:"",outline:""},{default:i(()=>[n(z,{outline:"",square:"",icon:"refresh",disable:e.isInputApiKeyDisabled,onClick:e.getKeyInfo,loading:e.isApiKeyInfoLoading},{default:i(()=>[n(E,null,{default:i(()=>[v(u(e.t("embedding.refresh_token_count1")),1)]),_:1})]),_:1},8,["disable","loading"]),n(ye),n(z,{square:"",outline:"","no-caps":"",label:e.t("embedding.last_7_days"),disable:e.isInputApiKeyDisabled,onClick:e.openUsageHistoryDialog},null,8,["label","disable"])]),_:1})]),_:1})]),_:1})):M("",!0),t.hideKey?M("",!0):(f(),h(V,{key:1},{default:i(()=>[e.$q.screen.gt.sm?(f(),h(S,{key:0,avatar:""},{default:i(()=>[n(L,{name:"key",class:D({"golden-foil":e.isPremiumPaidUser,"silver-foil":e.isPaidUser})},null,8,["class"])]),_:1})):M("",!0),n(S,null,{default:i(()=>[n(oa,{"input-style":"font-family: monospace",modelValue:e.inputApiKey,"onUpdate:modelValue":o[1]||(o[1]=a=>e.inputApiKey=a),"hide-bottom-space":"",type:e.isPwd?"password":"text",hint:e.t("embedding.key_to_top_up"),filled:"",square:"",label:e.inputApiKey?`${e.t("embedding.key_warn_v2")}`:e.t("embedding.key_enter_placeholder_to_topup"),error:!e.isInputApiKeyValid,"error-message":e.inputApiKey?e.t("embedding.input_api_key_error1"):"","input-class":"ellipsis"},{append:i(()=>[n(L,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>e.isPwd=!e.isPwd)},null,8,["name"])]),prepend:i(()=>[n(z,{flat:"",square:"",icon:e.isApiKeyCopyDone?"done":"content_copy",color:e.isApiKeyCopyDone?"primary":"",onClick:e.copyApiKey,stretch:""},{default:i(()=>[n(E,null,{default:i(()=>[v(u(e.t("copy")),1)]),_:1})]),_:1},8,["icon","color"])]),after:i(()=>[e.isInputApiKeyValid&&e.inputApiKey!==e.apiKey?(f(),h(z,{key:0,icon:"save",onClick:e.updateApiKey,stretch:"",square:"",flat:""})):M("",!0)]),_:1},8,["modelValue","type","hint","label","error","error-message"])]),_:1})]),_:1})),t.hideStripeInfo?M("",!0):(f(),h(V,{key:2},{default:i(()=>[e.$q.screen.gt.sm?(f(),h(S,{key:0,avatar:"",side:"",class:"relative-position"},{default:i(()=>[n(L,{name:"fab fa-stripe"}),n(L,{name:"o_verified_user",size:"xs",class:"absolute-bottom-right q-mr-sm q-mb-xs text-positive"})]),_:1})):M("",!0),n(S,null,{default:i(()=>[n(B,{class:"text-bold"},{default:i(()=>[v(u(e.t("embedding.buy_more_quota")),1)]),_:1}),n(B,{caption:"",lines:"2"},{default:i(()=>[v(u(e.t("embedding.tax_may_apply")),1)]),_:1})]),_:1}),e.isPaidUser?(f(),h(S,{key:1,side:"",class:"q-pa-none"},{default:i(()=>[n(z,{outline:"","icon-right":"open_in_new",label:e.t("embedding.manage_billing"),stretch:"",href:"https://stripe.jina.ai",target:"_blank","no-caps":""},{default:i(()=>[n(E,null,{default:i(()=>[v(u(e.t("embedding.manage_billing_tip")),1)]),_:1})]),_:1},8,["label"])]),_:1})):M("",!0)]),_:1})),n(ue,{class:"row q-pa-md q-py-none bg-transparent",flat:""},{default:i(()=>[(f(!0),Z(se,null,re(e.productCards.filter(a=>!t.hideFreePlan||!a.isFree),(a,_)=>(f(),Z("div",{key:_,class:D(["col-12 col-sm-6 q-pa-sm cursor-pointer",{"col-lg-4":!t.hideFreePlan}])},[xe((f(),h(ue,{bordered:"",flat:"",class:D(["full-width full-height column justify-between",!e.isInputApiKeyDisabled&&!e.currentPriceID&&!a.isFree?"q-hoverable bg-mixed-200":"cursor-not-allowed"]),square:"",style:sa(a.isActive()?"cursor: wait !important;":""),onClick:a.handler},{default:i(()=>[o[5]||(o[5]=q("span",{class:"q-focus-helper"},null,-1)),n(de,{class:"column items-center non-selectable text-h2 q-pt-xl"},{default:i(()=>[n(Me,{label:a.tag(),outline:"",square:"",style:{"border-radius":"0"},size:"sm",class:D(["q-my-xl",{"silver-border":a.product_name==="1B tokens","gold-border":a.product_name==="11B tokens"}])},null,8,["label","class"]),q("span",{innerHTML:a.title(),"data-text":a.title(),class:D(["text-weight-bold",{"text-dim":a.product_name==="1M tokens","silver-foil":a.product_name==="1B tokens","golden-foil":a.product_name==="11B tokens"}])},null,10,za),q("div",Ha,[v(u(e.t("embedding.includes"))+" ",1),n(E,{"max-width":"300px"},{default:i(()=>[v(u(a.description()),1)]),_:2},1024)]),q("div",Za,[(f(!0),Z(se,null,re(e.flatEnterprises,g=>(f(),h(L,{key:g.label,name:`img:${g.icon}`,size:"sm"},{default:i(()=>[n(E,null,{default:i(()=>[q("b",null,u(e.t(g.label)),1),o[4]||(o[4]=q("br",null,null,-1)),v(" "+u(e.t(g.caption)),1)]),_:2},1024)]),_:2},1032,["name"]))),128))])]),_:2},1024),n(de,{class:"column items-center non-selectable"},{default:i(()=>[n(Se,{dense:""},{default:i(()=>[(f(!0),Z(se,null,re(e.tierFeatures[a.product_name],(g,w)=>(f(),h(V,{key:g},{default:i(()=>[n(S,null,{default:i(()=>[n(B,{caption:""},{default:i(()=>[a.product_name!=="1M tokens"?(f(),h(L,{key:0,name:w===0?"key":"task_alt",class:D({"golden-foil":a.product_name==="11B tokens","silver-foil":a.product_name==="1B tokens"})},null,8,["name","class"])):M("",!0),v(" "+u(e.t(g)),1)]),_:2},1024),n(E,{"max-width":"300px"},{default:i(()=>[v(u(e.t(`${g}_description`)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),n(de,{class:D({"bg-mixed-300":!a.isFree})},{default:i(()=>[n(V,null,{default:i(()=>[n(S,null,{default:i(()=>[n(B,{class:D({"text-bold":!a.isFree})},{default:i(()=>[v(u(a.priceLabel()),1)]),_:2},1032,["class"]),n(B,{caption:""},{default:i(()=>[v(u(a.priceDescription()),1)]),_:2},1024)]),_:2},1024),a.isFree?M("",!0):(f(),h(S,{key:0,side:""},{default:i(()=>[n(L,{name:"add_shopping_cart"})]),_:1}))]),_:2},1024)]),_:2},1032,["class"]),n(Te,{showing:e.currentPriceID===a.price_id,label:e.t("embedding.wait_stripe"),"label-style":"font-size: 0.8em",size:"sm",class:"non-selectable lock-blur"},null,8,["showing","label"])]),_:2},1032,["class","style","onClick"])),[[ra,!a.isFree&&!e.isInputApiKeyDisabled&&!e.currentPriceID]])],2))),128)),n(Te,{showing:!e.isInputApiKeyValid,class:"lock-blur",label:e.t("embedding.right_api_key_to_charge"),size:"0"},null,8,["showing","label"])]),_:1}),n(ha,{label:e.t("rate_limit.understanding"),icon:e.$q.screen.gt.sm?"speed":void 0,"header-class":"text-bold",caption:e.t("rate_limit.understanding_description")},{default:i(()=>[n(e.RateLimitComponent,{"show-action-buttons":!1})]),_:1},8,["label","icon","caption"]),n(e.AutoRechargeItem,{"api-key":e.inputApiKey,"api-key-info":e.inputApiKeyInfo,"is-paid-key":e.isPaidUser,"is-auto-charge":e.isAutoCharge,"auto-recharge":e.autoRecharge,"onUpdate:autoRecharge":o[2]||(o[2]=a=>e.autoRecharge=a),"recharge-threshold":e.rechargeThreshold,"onUpdate:rechargeThreshold":o[3]||(o[3]=a=>e.rechargeThreshold=a),disable:e.isInputApiKeyDisabled,onUpdate:e.getKeyInfo},null,8,["api-key","api-key-info","is-paid-key","is-auto-charge","auto-recharge","recharge-threshold","disable"])]),_:1})}const rt=ie(Fa,[["render",Ya],["__scopeId","data-v-9005bfaa"],["__file","PurchaseComponent.vue"]]),dt=Ae({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(l,{slots:o,emit:t}){const e=Ce(),m=A(null);let d=0;const a=[];function _(s){const K=typeof s=="boolean"?s:l.noErrorFocus!==!0,r=++d,R=(c,k)=>{t(`validation${c===!0?"Success":"Error"}`,k)},C=c=>{const k=c.validate();return typeof k.then=="function"?k.then(b=>({valid:b,comp:c}),b=>({valid:!1,comp:c,err:b})):Promise.resolve({valid:k,comp:c})};return(l.greedy===!0?Promise.all(a.map(C)).then(c=>c.filter(k=>k.valid!==!0)):a.reduce((c,k)=>c.then(()=>C(k).then(b=>{if(b.valid===!1)return Promise.reject(b)})),Promise.resolve()).catch(c=>[c])).then(c=>{if(c===void 0||c.length===0)return r===d&&R(!0),!0;if(r===d){const{comp:k,err:b}=c[0];if(b!==void 0&&console.error(b),R(!1,k),K===!0){const x=c.find(({comp:Q})=>typeof Q.focus=="function"&&ma(Q.$)===!1);x!==void 0&&x.comp.focus()}}return!1})}function g(){d++,a.forEach(s=>{typeof s.resetValidation=="function"&&s.resetValidation()})}function w(s){s!==void 0&&Ke(s);const K=d+1;_().then(r=>{K===d&&r===!0&&(l.onSubmit!==void 0?t("submit",s):s!==void 0&&s.target!==void 0&&typeof s.target.submit=="function"&&s.target.submit())})}function T(s){s!==void 0&&Ke(s),t("reset"),fa(()=>{g(),l.autofocus===!0&&l.noResetFocus!==!0&&I()})}function I(){ya(()=>{if(m.value===null)return;const s=m.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||m.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||m.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(m.value.querySelectorAll("[tabindex]"),K=>K.tabIndex!==-1);s!=null&&s.focus({preventScroll:!0})})}_a(ga,{bindComponent(s){a.push(s)},unbindComponent(s){const K=a.indexOf(s);K!==-1&&a.splice(K,1)}});let y=!1;return da(()=>{y=!0}),ca(()=>{y===!0&&l.autofocus===!0&&I()}),qe(()=>{l.autofocus===!0&&I()}),Object.assign(e.proxy,{validate:_,resetValidation:g,submit:w,reset:T,focus:I,getValidationComponents:()=>a}),()=>X("form",{class:"q-form",ref:m,onSubmit:w,onReset:T},ua(o.default))}}),ct="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='320'%20zoomAndPan='magnify'%20viewBox='0%200%20240%20239.999995'%20height='320'%20preserveAspectRatio='xMidYMid%20meet'%20version='1.0'%3e%3cpath%20fill='%23ffffff'%20d='M%20164.820312%2048%20L%20195%2048%20L%20195%2078.179688%20L%20164.820312%2078.179688%20Z%20M%20164.820312%2085.726562%20L%20195%2085.726562%20L%20195%20115.90625%20L%20164.820312%20115.90625%20Z%20M%20195%20123.449219%20L%20164.820312%20123.449219%20L%20164.820312%20153.632812%20L%20195%20153.632812%20Z%20M%20164.820312%20161.175781%20L%20195%20161.175781%20L%20195%20191.359375%20L%20164.820312%20191.359375%20Z%20M%2076.792969%2053.28125%20L%2067.707031%2063.375%20L%2077.796875%2072.460938%20L%2086.886719%2062.367188%20Z%20M%2067.707031%20101.101562%20L%2076.792969%2091.007812%20L%2086.886719%20100.09375%20L%2077.796875%20110.1875%20Z%20M%2076.792969%20128.734375%20L%2067.707031%20138.824219%20L%2077.796875%20147.914062%20L%2086.886719%20137.820312%20Z%20M%2067.707031%20176.550781%20L%2076.792969%20166.460938%20L%2086.886719%20175.546875%20L%2077.796875%20185.640625%20Z%20M%2048.96875%2057.054688%20L%2045%2065.191406%20L%2053.136719%2069.160156%20L%2057.105469%2061.023438%20Z%20M%2045%20102.917969%20L%2048.96875%2094.78125%20L%2057.105469%2098.75%20L%2053.136719%20106.886719%20Z%20M%2048.96875%20132.507812%20L%2045%20140.644531%20L%2053.136719%20144.613281%20L%2057.105469%20136.476562%20Z%20M%2045%20178.371094%20L%2048.96875%20170.230469%20L%2057.105469%20174.199219%20L%2053.136719%20182.339844%20Z%20M%20113.113281%2050.261719%20L%2097.757812%2059.859375%20L%20107.355469%2075.214844%20L%20122.710938%2065.621094%20Z%20M%2097.757812%2097.585938%20L%20113.113281%2087.988281%20L%20122.710938%20103.347656%20L%20107.355469%20112.941406%20Z%20M%20113.113281%20125.714844%20L%2097.757812%20135.3125%20L%20107.355469%20150.667969%20L%20122.710938%20141.070312%20Z%20M%2097.757812%20173.035156%20L%20113.113281%20163.441406%20L%20122.710938%20178.796875%20L%20107.355469%20188.394531%20Z%20M%20152.050781%2048%20L%20128.839844%2054.65625%20L%20135.496094%2077.863281%20L%20158.703125%2071.210938%20Z%20M%20128.839844%2092.378906%20L%20152.050781%2085.726562%20L%20158.703125%20108.933594%20L%20135.496094%20115.589844%20Z%20M%20152.050781%20123.449219%20L%20128.839844%20130.105469%20L%20135.496094%20153.316406%20L%20158.703125%20146.660156%20Z%20M%20128.839844%20167.832031%20L%20152.050781%20161.175781%20L%20158.703125%20184.386719%20L%20135.496094%20191.042969%20Z%20M%20128.839844%20167.832031%20'%20fill-opacity='1'%20fill-rule='evenodd'/%3e%3c/svg%3e";export{Na as A,rt as P,Te as Q,Oa as R,Aa as U,dt as a,ct as t,_e as u};
