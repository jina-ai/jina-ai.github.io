import{cq as m,aB as g,ab as f,cr as w,b4 as y}from"./index-C78ENz76.js";import{u as b}from"./blogs-NQ7xpBW-.js";const C=m.value.map(s=>({...s,type:"product"}));var S=(s=>(s.PRODUCT="product",s.NEWS="news",s.COMPANY="company",s.ELLIPSIS="ellipsis",s.HEADER="header",s.SEPARATOR="separator",s.ON_PAGE_RAG="onPageRAG",s.ASK_SOLUTION="askSolution",s))(S||{});const E=g("search",{state:()=>({answerChunks:"",isBusy:!1,isStreaming:!1,isComposing:!1,searchImmediate:!1}),getters:{},actions:{async composeResult(s){this.isComposing=!0;try{const r=b(),i=3;r.allBlogs.length===0&&await r.getAllNews();const l=r.allBlogs.map(n=>({label:n.title,icon:n.featureImage,value:n.title,description:n.excerpt,time:f(n.publishedAt).format("MMMM DD, YYYY"),slug:n.slug,type:"news"}));let t=[];if(s){t.push({type:"onPageRAG",label:s}),t.push({type:"askSolution",label:s});const n=C.filter(e=>{const c=this.te(e.label)?this.t(e.label):e.label,p=this.te(e.description)?this.t(e.description):e.description;return c.toLowerCase().includes(s.toLowerCase())||p.toLowerCase().includes(s.toLowerCase())}).map(e=>({type:"product",label:e.label,icon:e.icon,link:e.link,description:e.description}));n.length&&(t.length&&t.push({type:"separator"}),t.push({label:"header.products",number:n.length,type:"header"}),t=t.concat(n.slice(0,i)),n.length>i&&t.push({label:"header.see_all_products",type:"ellipsis",number:n.length-i,moreResults:n.slice(i)}));const o=w.filter(e=>!e.external).filter(e=>this.t(e.label).toLowerCase().includes(s.toLowerCase())).map(e=>({type:"company",label:e.label,link:e.routerLink}));o.length&&(t.length&&t.push({type:"separator"}),t.push({label:"header.company",number:o.length,type:"header"}),t=t.concat(o.slice(0,i)),o.length>i&&t.push({label:"header.see_all_company",type:"ellipsis",number:o.length-i,moreResults:o.slice(i)}));const a=l.filter(e=>e.label.toLowerCase().includes(s.toLowerCase())||e.description.toLowerCase().replaceAll("-"," ").includes(s.toLowerCase())).map(e=>({type:"news",label:e.label,icon:e.icon,description:e.description,time:e.time,slug:e.slug}));a.length&&(t.length&&t.push({type:"separator"}),t.push({label:"header.news",number:a.length,type:"header"}),t=t.concat(a.slice(0,i)),a.length>i&&t.push({label:"header.see_all_news",type:"ellipsis",number:a.length-i,moreResults:a.slice(i)}))}return t}finally{this.isComposing=!1}},async search(s,r){var n,o;this.answerChunks="",this.isBusy=!0,this.isStreaming=!0;let i="";r==="onPageRAG"&&await fetch(`https://r.jina.ai/https://jina.ai${window.location.pathname}`).then(a=>a.text()).then(a=>{i=a});const l={parameters:{question:s,content:i}},t=r==="onPageRAG"?"https://api.promptperfect.jina.ai/BcHLFuKk3u9naJ4u4G1H":"https://api.promptperfect.jina.ai/EEBuotbLAugUDjr4mq1j";try{const a=await fetch(t,{headers:{"content-type":"application/json"},body:JSON.stringify(l),method:"POST"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);if((n=a.headers.get("content-type"))!=null&&n.includes("text/event-stream")){if(a.body){const e=a.body.getReader(),c=new TextDecoder;for(;;){const{done:p,value:h}=await e.read();if(p){this.isStreaming=!1;break}h&&(this.isBusy=!1,c.decode(h).split(`

`).forEach(d=>{const u=d.replace(/data: /g,"");u&&(this.answerChunks+=u)}))}}}else if((o=a.headers.get("content-type"))!=null&&o.includes("application/json")){const e=(await a.json()).data;this.answerChunks=e}else throw new Error("Unknown response type")}catch(a){y.create({color:"negative",message:this.t("landing_page.error",{message:a}),icon:"report_problem"})}finally{this.isBusy=!1}}}});export{S as R,E as u};
