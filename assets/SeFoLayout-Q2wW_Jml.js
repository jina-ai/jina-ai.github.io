import{s as re,m as C,p as ve,K as be,d7 as ke,dg as he,w as O,j as G,a0 as le,a2 as V,aB as z,ay as U,a3 as l,a4 as n,a5 as a,a6 as o,ae as c,ao as k,af as p,ag as _,ad as T,aa as S,a8 as u,ac as Se,u as we,ak as N,k as x,W as xe,n as De,al as Ke,am as Te,dI as Ce,cT as X,cU as Z,q as D,b2 as $,ai as P,ah as q,ab as y,b3 as Qe,a7 as Ae,a9 as ee,T as F,aj as ae,aM as Me,b8 as Ee}from"./index-CNxRRvi6.js";import{P as qe,Q as Ie}from"./PurchaseSuccessDialog-DDgOfsKA.js";import{u as Le,a as Re,b as Be,Q as Ne}from"./QTabs-CiY4i0_a.js";import{d as Pe,Q as Fe,a as Oe,b as ze,c as Ue}from"./QLayout-BhePeLtz.js";import{Q as L}from"./QItemLabel-C25DziD8.js";import{Q as te}from"./QList-DNkcIkB0.js";import{Q as Ge}from"./QMenu-BSdNc5SB.js";import{Q as K}from"./QTooltip-DhotFS0T.js";import{Q as Ve}from"./QBadge-Dj149qtI.js";import{c as je}from"./copy-to-clipboard-DMKghpXJ.js";import{f as He,e as Ye,c as Je}from"./date-Cx8xvgmI.js";import{S as oe,E as I,L as se,P as We}from"./PurchaseDialog-Dy5rer14.js";import{u as Xe}from"./use-dialog-plugin-component-CVzXx_xf.js";import{u as Ze}from"./finetune-CazJ9dAC.js";import"./QResizeObserver-C-i1SBsM.js";import"./QLinearProgress-DrltYmzX.js";import"./QChip-CLZgXYWd.js";import"./TouchPan-ByCgy1Is.js";import"./touch-BjYP5sR0.js";import"./position-engine-ChLcirF9.js";import"./use-fullscreen-BTtgp3xg.js";import"./package-D9JPNs5w.js";import"./_setToArray-C6nB_MsM.js";import"./QExpansionItem-DZ18pgNg.js";import"./ClosePopup-CTktk7iy.js";const $e=re({name:"QToolbarTitle",props:{shrink:Boolean},setup(d,{slots:r}){const s=C(()=>"q-toolbar__title ellipsis"+(d.shrink===!0?" col-shrink":""));return()=>ve("div",{class:s.value},be(r.default))}}),ea=re({name:"QRouteTab",props:{...ke,...Le},emits:Re,setup(d,{slots:r,emit:s}){const e=he({useDisableForRouterLinkProps:!1}),{renderTab:h,$tabs:f}=Be(d,r,s,{exact:C(()=>d.exact),...e});return O(()=>`${d.name} | ${d.exact} | ${(e.resolvedLink.value||{}).href}`,f.verifyRouteModel),()=>h(e.linkTag.value,e.linkAttrs.value)}}),aa=G({__name:"DrawerItemComponent",props:{item:{type:Object,required:!0},isActive:{type:Boolean,default:!1}},setup(d,{expose:r}){r();const{t:s}=le({useScope:"global"}),e={t:s};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}});function ta(d,r,s,e,h,f){return z((l(),n(T,{to:{name:"api",params:{tab:s.item.name}},"active-class":"text-primary",clickable:""},{default:a(()=>[o(c,{avatar:""},{default:a(()=>[o(k,{name:s.item.iconType==="svg"||s.item.icon.includes(".svg")?`img:${s.isActive?s.item.activeIcon:s.item.icon}`:s.item.icon},null,8,["name"])]),_:1}),o(c,null,{default:a(()=>[o(L,{lines:"1"},{default:a(()=>[p(_(e.t(s.item.label)),1)]),_:1})]),_:1})]),_:1},8,["to"])),[[U]])}const oa=V(aa,[["render",ta],["__file","DrawerItemComponent.vue"]]),sa=G({__name:"AnimatedLogo",props:{miniState:Boolean},setup(d,{expose:r}){r();const s={};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),ra={style:{height:"56px"},class:"row items-center absolute-top"},la={style:{"padding-left":"20px"}},na={viewBox:"0 0 232 100",style:{width:"56px",height:"56px",transition:"all 0.2s ease-in-out"}},ia={fill:"#FFFFFF"};function ua(d,r,s,e,h,f){return l(),S("div",ra,[u("div",la,[(l(),S("svg",na,[u("g",ia,[r[1]||(r[1]=u("circle",{id:"j-dot",cx:"15",cy:"84.5",r:"15"},null,-1)),r[2]||(r[2]=u("path",{id:"letter-j",d:"M61.5 36.35c2 0 3.6 1.6 3.6 3.6v29.3c0 16.7-13.5 30.3-30 30.5V69.3l-.1-29.4c0-2 1.6-3.6 3.6-3.6h23.3z"},null,-1)),u("g",{style:Se({opacity:s.miniState?0:1,transition:"opacity 0.2s ease-in-out"})},r[0]||(r[0]=[u("circle",{id:"top-dot",cx:"96",cy:"15",r:"15"},null,-1),u("path",{id:"letter-i",d:"M81 40c0-2 1.5-3.6 3.6-3.6h23.4c2 0 3.6 1.6 3.6 3.6v41c0 2-1.6 3.6-3.6 3.6H84.6c-2 0-3.6-1.6-3.6-3.6V40z"},null,-1),u("path",{id:"letter-n",d:"M128.5 39.8c0-2 1.6-3.6 3.6-3.6h13.3l.5.1c15 .2 27.2 12.3 27.6 27.3v17.3c0 2-1.6 3.6-3.6 3.6h-37.8c-2 0-3.6-1.6-3.6-3.6V39.8z"},null,-1),u("path",{id:"letter-a",d:"M207.2 84h-.2c-12.6-.7-22.5-11.2-22.5-24 0-13.3 10.8-24.1 24.1-24.1 12.8 0 23.3 10 24 22.6h.1V80.4c0 2-1.6 3.6-3.6 3.6h-21.9z"},null,-1)]),4)])]))])])}const ca=V(sa,[["render",ua],["__file","AnimatedLogo.vue"]]),da=G({__name:"SeFoLayout",setup(d,{expose:r}){r();const{t:s}=le({useScope:"global"}),e=De(),h=Ke(),f=Te(),Q=we(),{user:t}=N(Q),m=Xe(),{apiKeyTokens:ne,isPremiumPaidUser:ie,isPaidUser:ue}=N(m),w=Ze(),{keys:R,keysInfoCache:j}=N(w),ce=x(!0),H=x(!0),A=x(),de=oe.filter(i=>i.tooling),me=x(!1),_e=C(()=>{let i=[],v={};return oe.forEach(g=>{g.name===I.KEY_MANAGER?v=g:g.showsOn.includes("menu")&&i.push(g)}),t.value.uid&&i.unshift(v),i}),fe=i=>{A.value&&clearTimeout(A.value),A.value=setTimeout(()=>{H.value=!i},100)},ye=()=>{t.value.uid?h.push({params:{tab:I.KEY_MANAGER}}):(X(Z,"click_login_button"),e.dialog({component:se,componentProps:{user:t},persistent:!0}))},pe=C(()=>t.value.uid?t.value.displayName||t.value.email||t.value.uid:s("key_manager.login")),ge=C(()=>{var i,v;if(t.value.uid){const g=(v=(i=t.value.providerData)==null?void 0:i[0])==null?void 0:v.providerId;let b="";switch(g){case"google.com":b="Google";break;case"github.com":b="GitHub";break;case"password":b=s("key_manager.email");break}return b?s("key_manager.login_via",{_provider:b}):""}return""});function Y(){if(f.query.purchase_status==="success"){const i=new Date(parseInt(f.query.session_id)).toLocaleString();Ce.create({component:qe,componentProps:{purchasedTime:i,hideActions:!0}})}else f.query.register_status==="success"&&e.notify({message:s("key_manager.auto_recharge_enable_success",{_key:f.query.api_key}),icon:"done"})}const J=async()=>{await w.fetchKeys(f.params.tab===I.KEY_MANAGER),R.value.length===0?m.apiKey?(await w.addKey(m.apiKey),w.setPrimaryKey(m.apiKey)):B():w.checkPrimaryKey()},M=x(!1),B=()=>{var i,v,g,b;M.value||(M.value=!0,e.dialog({message:(i=t.value)!=null&&i.uid?s("key_manager.no_key_with_login"):s("key_manager.no_key_without_login",{_button:s("key_manager.get_free_key")}),title:s("key_manager.no_key_title"),persistent:!0,cancel:{flat:!0,padding:"md",icon:"key",square:!0,label:s("key_manager.get_free_key"),color:(v=t.value)!=null&&v.uid?"primary":"default",textColor:(g=t.value)!=null&&g.uid?"black":"",to:"/?newKey"},ok:{flat:!0,icon:"login",padding:"md",square:!0,label:s("key_manager.login"),textColor:"primary",style:`display: ${(b=t.value)!=null&&b.uid?"none":""}`}}).onOk(()=>{X(Z,"click_login_button"),e.dialog({component:se,componentProps:{user:t},persistent:!0})}).onDismiss(()=>{M.value=!1}))};xe(async()=>{Y()}),O(()=>m.apiKey,i=>{i&&m.getCurrentKeyInfo()}),O(()=>t.value.uid,async i=>{i?J():(R.value=[],j.value={},m.apiKey?m.getCurrentKeyInfo():B())},{immediate:!0});const E=x(!1),W={t:s,$q:e,router:h,route:f,userStore:Q,user:t,embeddingStore:m,apiKeyTokens:ne,isPremiumPaidUser:ie,isPaidUser:ue,apiKeyStore:w,keys:R,keysInfoCache:j,drawer:ce,miniState:H,timeout:A,seFoMoreRoutes:de,showFull:me,seFoRoutes:_e,handleMouseMove:fe,login:ye,userDisplayName:pe,userLoginType:ge,checkPurchaseStatus:Y,init:J,isNoKeyAvailableDialogShown:M,showNoKeyAvailableDialog:B,isApiKeyCopyDone:E,copyApiKey:()=>{!m.apiKey||E.value||(je(m.apiKey).then(()=>{e.notify({message:s("copy_to_clipboard_success"),icon:"done"}),E.value=!0,gtag==null||gtag("event","embedding_copy_api_key",{location:document.location.href})}),setTimeout(()=>{E.value=!1},1800))},onBuy:()=>{e.dialog({component:We,componentProps:{purchaseKey:m.apiKey}})},get formatNumber(){return He},get formatNumberShort(){return Ye},get EMBEDDING_TABS(){return I},DrawerItemComponent:oa,AnimatedLogo:ca,get formatKey(){return Je}};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),ma=["src","alt"],_a={class:"absolute-bottom"},fa={class:"relative-position"},ya={style:{"font-family":"monospace"}},pa=["src","alt"],ga={class:"ellipsis"};function va(d,r,s,e,h,f){const Q=Ee("router-view");return l(),n(Pe,{view:"lHh Lpr lff",class:"main-layout"},{default:a(()=>[e.$q.screen.gt.sm?y("",!0):(l(),n(Fe,{key:0,bordered:"",reveal:"",class:"bg-mixed-200 text-white","height-hint":"98"},{default:a(()=>[o(Ie,{class:"q-pa-none"},{default:a(()=>[o(D,{icon:"img:/Jina - Dark.svg",to:"/",stretch:"",size:"xl",dense:"",flat:"",class:"q-px-md q-pa-none",key:"logo"}),o($e,{class:"my-font non-selectable"}),o(D,{flat:"",stretch:"",square:"",onClick:e.userStore.logout},{default:a(()=>[e.user.photoURL?(l(),n($,{key:0,size:"sm",round:"",class:"bordered-avatar"},{default:a(()=>[u("img",{src:e.user.photoURL,referrerpolicy:"no-referrer",alt:e.userDisplayName},null,8,ma)]),_:1})):(l(),n(k,{key:1,size:"sm",round:"",name:"person"})),o(k,{name:"logout",class:"q-ml-md"})]),_:1},8,["onClick"])]),_:1}),e.user&&e.$q.screen.lt.md?(l(),n(Ne,{key:0,shrink:"","mobile-arrows":"",align:"left"},{default:a(()=>[(l(!0),S(q,null,P([...e.seFoRoutes,...e.seFoMoreRoutes],t=>(l(),n(ea,{key:t.name,to:{name:"api",params:{tab:t.name}},label:t.label?e.t(t.label):"",icon:t.tag==="usage"?`img:${t.name===(e.route.params.tab||e.EMBEDDING_TABS.READER_CODE)?t.activeIcon:t.icon}`:t.icon,"active-class":"text-primary","no-caps":"",exact:"",replace:""},null,8,["to","label","icon"]))),128))]),_:1})):y("",!0)]),_:1})),e.$q.screen.gt.sm?(l(),n(Oe,{key:1,modelValue:e.drawer,"onUpdate:modelValue":r[3]||(r[3]=t=>e.drawer=t),"show-if-above":"",mini:e.miniState,onMouseover:r[4]||(r[4]=t=>e.handleMouseMove(!0)),onMouseout:r[5]||(r[5]=t=>e.handleMouseMove(!1)),"mini-to-overlay":"",width:250,breakpoint:500,bordered:"",class:"bg-mixed-200"},{default:a(()=>[u("div",{class:"row items-center absolute-top cursor-pointer",onClick:r[0]||(r[0]=t=>e.router.push({name:"landing"}))},[o(e.AnimatedLogo,{"mini-state":e.miniState},null,8,["mini-state"])]),o(ze,{class:"fit",style:{"max-height":"calc(100% - 112px)","margin-top":"56px"},"horizontal-thumb-style":{opacity:"0"}},{default:a(()=>[o(te,null,{default:a(()=>[o(Qe,{"enter-to-class":"list-enter-from","enter-active-class":"animated bounceIn","leave-active-class":"animated backOutRight","leave-from-class":"list-leave-to","move-class":"list-move","enter-from-class":"list-enter-from","leave-to-class":"list-leave-to"},{default:a(()=>[(l(!0),S(q,null,P(e.seFoRoutes,t=>(l(),n(e.DrawerItemComponent,{item:t,key:t==null?void 0:t.label,"is-active":t.name===(e.route.params.tab||e.EMBEDDING_TABS.READER_CODE)},null,8,["item","is-active"]))),128)),z((l(),n(T,{clickable:"","active-class":"text-primary",key:"tools"},{default:a(()=>[o(c,{avatar:""},{default:a(()=>[o(k,{name:"service_toolbox"})]),_:1}),o(c,null,{default:a(()=>[o(L,{lines:"1"},{default:a(()=>[p(_(e.t("embedding.tools")),1)]),_:1})]),_:1}),o(Ge,{class:"bg-mixed-300 lock-blur","auto-close":""},{default:a(()=>[o(te,{class:"cursor-pointer",style:{width:"250px"}},{default:a(()=>[(l(!0),S(q,null,P(e.seFoMoreRoutes,t=>(l(),n(e.DrawerItemComponent,{item:t,key:t==null?void 0:t.label,"is-active":t.name===(e.route.params.tab||e.EMBEDDING_TABS.CODE)},null,8,["item","is-active"]))),128))]),_:1})]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})]),_:1}),u("div",_a,[o(F,{appear:"","enter-active-class":"animated faster fadeInLeft","leave-active-class":"animated faster fadeOutLeft"},{default:a(()=>[e.miniState?y("",!0):(l(),n(Ae,{key:0,flat:"",square:"",class:"bg-mixed-300"},{default:a(()=>[e.keys.length>0||e.embeddingStore.apiKey?(l(),n(ee,{key:0,class:"q-pb-none text-dim"},{default:a(()=>[p(_(e.t("key_manager.available_resources")),1)]),_:1})):y("",!0),o(ee,{class:"q-pa-none",onMouseenter:r[1]||(r[1]=t=>e.showFull=!0),onMouseleave:r[2]||(r[2]=t=>e.showFull=!1)},{default:a(()=>[e.keys.length>0||e.embeddingStore.apiKey?(l(),n(T,{key:0},{default:a(()=>[o(c,{side:""},{default:a(()=>[o(k,{name:"o_data_usage"})]),_:1}),o(c,null,{default:a(()=>[u("div",fa,[o(F,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",mode:"out-in"},{default:a(()=>[(l(),S("span",{key:e.showFull?"full":"short",class:ae(["text-h5",{"text-negative":e.apiKeyTokens<=0}])},_(e.showFull?e.formatNumber(e.apiKeyTokens):e.formatNumberShort(e.apiKeyTokens)),3))]),_:1})]),o(K,null,{default:a(()=>[p(_(e.t("key_manager.balance_primary_key")),1)]),_:1})]),_:1}),o(c,{side:""},{default:a(()=>[o(D,{icon:"add_shopping_cart",flat:"",square:"",onClick:e.onBuy},{default:a(()=>[o(K,null,{default:a(()=>[p(_(e.t("embedding.buy_more_quota")),1)]),_:1})]),_:1})]),_:1})]),_:1})):y("",!0),o(T,null,{default:a(()=>[o(c,{side:"",class:"relative-position"},{default:a(()=>[o(k,{name:"o_key"}),e.keys.length>0?(l(),n(Ve,{key:0,floating:"",rounded:"",label:e.keys.length,class:"bg-mixed-400"},{default:a(()=>[o(K,null,{default:a(()=>[p(_(e.t("key_manager.total_keys")+": "+e.keys.length),1)]),_:1})]),_:1},8,["label"])):y("",!0)]),_:1}),e.keys.length>0||e.embeddingStore.apiKey?(l(),S(q,{key:0},[o(c,null,{default:a(()=>[u("span",ya,_(e.formatKey(e.embeddingStore.apiKey,{tailOnly:!0})),1),o(K,null,{default:a(()=>[p(_(e.t("key_manager.is_primary")),1)]),_:1})]),_:1}),o(c,{side:""},{default:a(()=>[o(D,{icon:"content_copy",flat:"",square:"",onClick:e.copyApiKey})]),_:1})],64)):(l(),n(c,{key:1},{default:a(()=>[o(D,{label:e.t("key_manager.get_free_key"),flat:"",square:"",to:"/?newKey"},null,8,["label"])]),_:1}))]),_:1})]),_:1})]),_:1}))]),_:1}),z((l(),n(T,{clickable:"",style:{height:"56px"},onClick:e.login},{default:a(()=>[o(c,{avatar:"",class:"q-my-sm q-pr-none user-avatar"},{default:a(()=>[e.user.photoURL?(l(),n($,{key:0,size:"sm",round:"",class:"bordered-avatar"},{default:a(()=>[u("img",{src:e.user.photoURL,referrerpolicy:"no-referrer",alt:e.userDisplayName},null,8,pa)]),_:1})):(l(),n(k,{key:1,size:"sm",round:"",name:"person"}))]),_:1}),o(c,null,{default:a(()=>[o(L,{lines:"1",class:"row items-center"},{default:a(()=>[u("span",ga,[e.isPaidUser?(l(),n(k,{key:0,name:"verified",class:ae([{"golden-foil":e.isPremiumPaidUser,"silver-foil":e.isPaidUser},"q-mr-xs"])},null,8,["class"])):y("",!0),p(" "+_(e.userDisplayName),1)]),e.user.email?(l(),n(K,{key:0},{default:a(()=>[p(_(e.user.email),1)]),_:1})):y("",!0)]),_:1}),e.userLoginType?(l(),n(L,{key:0,caption:"",class:"text-dim",lines:"1",style:{"font-size":"0.4rem"}},{default:a(()=>[p(_(e.userLoginType),1)]),_:1})):y("",!0)]),_:1}),o(F,{appear:"","enter-active-class":"animated slower fadeIn","leave-active-class":"animated faster fadeOut"},{default:a(()=>[e.user.uid&&!e.miniState?(l(),n(c,{key:0,side:""},{default:a(()=>[o(D,{flat:"",square:"",id:"more_menu",icon:"logout",onClick:Me(e.userStore.logout,["stop"])},null,8,["onClick"])]),_:1})):y("",!0)]),_:1})]),_:1})),[[U]])])]),_:1},8,["modelValue","mini"])):y("",!0),o(Ue,null,{default:a(()=>[o(Q)]),_:1})]),_:1})}const ja=V(da,[["render",va],["__file","SeFoLayout.vue"]]);export{ja as default};
