import{aB as d,ai as c,d as m}from"./index-BFB6eUR2.js";const h=d("news",{state:()=>({authors:[],blogs:{all:[],featured:[],press:[],events:[],insights:[],"knowledge-base":[],releases:[],"tech-blog":[]},blogsMeta:{pagination:{limit:0,next:0,page:0,pages:0,prev:0,total:0}},allBlogs:[],updatedAt:void 0,accessedAt:"",lastAccessedAt:""}),getters:{hasNewPost:t=>t.accessedAt?t.allBlogs.length?t.allBlogs.some(s=>new Date(s.publishedAt).getTime()>new Date(t.accessedAt).getTime()):!1:!0},actions:{async getNews(t,s="authors,tags"){var l;const a=c();let e;if(a.language!==m){const i=await fetch(`/assets/blogs/${a.language}/${t}.json`);i.ok&&((l=i.headers.get("content-type"))!=null&&l.includes("application/json"))&&(e=await i.json())}if(!e){const i=await fetch(`https://jina-ai-gmbh.ghost.io/ghost/api/content/posts/slug/${t}/?${new URLSearchParams({key:"2652cf20335454671600707967",include:s})}`);if(i.ok){const{posts:g}=await i.json();g.length>0&&(e=g[0])}}if(e)return{id:e.id,url:e.url,html:e.html,excerpt:e.excerpt,featureImage:e.feature_image,featureImageAlt:e.feature_image_alt,publishedAt:e.published_at,updatedAt:e.updated_at,title:e.title,slug:e.slug,readingTime:e.reading_time,featured:e.featured,primaryTag:e.primary_tag,authors:e.authors.map(i=>({id:i.id,name:i.name,bio:i.bio,location:i.location,profileImage:i.profile_image,slug:i.slug,url:i.url,twitter:i.twitter})),tags:e.tags.map(i=>({id:i.id,name:i.name,slug:i.slug,url:i.url,visibility:i.visibility}))}},async getNewsList({filter:t,include:s="authors,tags",page:a,limit:e=6}){let l={include:s,limit:String(e),key:"2652cf20335454671600707967"};t!==void 0&&(l=Object.assign(l,{filter:t})),a!==void 0&&(l=Object.assign(l,{page:String(a)}));const i="https://jina-ai-gmbh.ghost.io/ghost/api/content/posts/?"+new URLSearchParams(l),g=await fetch(i),{posts:o,meta:u}=await g.json();return{posts:o.map(n=>({id:n.id,url:n.url,html:n.html,excerpt:n.excerpt,featureImage:n.feature_image,featureImageAlt:n.feature_image_alt,publishedAt:n.published_at,updatedAt:n.updated_at,title:n.title,slug:n.slug,readingTime:n.reading_time,featured:n.featured,primaryTag:n.primary_tag,authors:n.authors.map(r=>({id:r.id,name:r.name,bio:r.bio,location:r.location,profileImage:r.profile_image,slug:r.slug,url:r.url,twitter:r.twitter})),tags:n.tags.map(r=>({id:r.id,name:r.name,slug:r.slug,url:r.url,visibility:r.visibility}))})),meta:u}},async getNewsBy({authors:t,tag:s="all",page:a=1,limit:e=6}){const l=[];t&&t.length>0&&l.push(`authors.slug:[${t.join(",")}]`),s!=="all"&&(s==="featured"?l.push("featured:true"):l.push(`tag:${s}`));const{posts:i,meta:g}=await this.getNewsList({filter:l.join("+"),page:a,limit:e});this.blogs[s]=i,this.blogsMeta=g},async getSuggestionNews(t,s){var e;const a=[];if((e=s.tags)!=null&&e.length){const{posts:l}=await this.getNewsList({limit:t,filter:`tag:${s.primaryTag.slug}+id:-${s.id}`,page:1});if(a.push(...l),a&&a.length<t){const{posts:i}=await this.getNewsList({limit:"all",filter:`tag:-${s.primaryTag.slug}+id:-${s.id}`}),g=i,o=Math.floor(Math.random()*(g.length-1));a.push(...g.slice(o,o+t-a.length))}}else{const{posts:l}=await this.getNewsList({limit:t,filter:`id:-${s.id}`,page:1});a.push(...l)}return a},async getAllNews(){let t={limit:"all"};if(this.allBlogs.length>0&&this.updatedAt){t=Object.assign(t,{filter:`updated_at:>${this.updatedAt}`});const{posts:s}=await this.getNewsList(t);s.reverse().forEach(a=>{const e=this.allBlogs.findIndex(l=>l.id===a.id);e!==-1?this.allBlogs[e]=a:this.allBlogs.unshift(a)})}else{const{posts:s}=await this.getNewsList(t);this.allBlogs=s}this.allBlogs=[...this.allBlogs.sort((s,a)=>new Date(a.publishedAt).getTime()-new Date(s.publishedAt).getTime())],this.updatedAt=new Date().toISOString()},async getAuthors(){const t="https://jina-ai-gmbh.ghost.io/ghost/api/content/authors/?"+new URLSearchParams({key:"2652cf20335454671600707967",limit:"all"}),s=await fetch(t),{authors:a}=await s.json();this.authors=a.map(e=>({id:e.id,name:e.name,bio:e.bio,location:e.location,profileImage:e.profile_image,slug:e.slug,url:e.url,twitter:e.twitter}))},async select(t){let s;return typeof t=="string"?s=[t]:s=t,this.allBlogs.filter(a=>s.some(e=>a.title.toLowerCase().includes(e.toLowerCase())))}},persist:!0});export{h as u};
