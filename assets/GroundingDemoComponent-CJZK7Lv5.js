import{Q as R}from"./QTooltip-CFIa7knv.js";import{av as K,s as W,ax as J,m,p,az as X,J as Y,j as Z,am as $,a0 as ee,k as h,W as ae,V as te,b9 as ne,a2 as re,a3 as _,a4 as x,a5 as n,a6 as t,a9 as I,aT as le,aK as oe,aN as se,af as S,ag as C,q as M,a8 as ie,ab as B,ad as j,ae as w,aq as L,ap as ue,b5 as ce,aa as de,ah as me,ai as fe,a7 as ve}from"./index-CVyhdJtP.js";import{b as G,a as ge}from"./QChip-Bfh74F0V.js";import{a as be}from"./finetune-BXNK99jE.js";import{b as he,a as _e}from"./QLinearProgress-ClRjU9eg.js";import{Q as z}from"./QItemLabel-ysan_UVK.js";import{Q as ye}from"./QList-lgrsSunF.js";import{f as ke}from"./date-CAEOQdOY.js";import{u as pe}from"./use-dialog-plugin-component-BGUqRzU0.js";const xe={...K,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:a=>a>=0&&a<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},P=50,O=2*P,A=O*Math.PI,Se=Math.round(A*1e3)/1e3,Ce=W({name:"QCircularProgress",props:{...xe,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(a,{slots:c}){const{proxy:{$q:y}}=Y(),e=J(a),Q=m(()=>{const o=(y.lang.rtl===!0?-1:1)*a.angle;return{transform:a.reverse!==(y.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-o}deg)`:`rotate3d(0, 0, 1, ${o-90}deg)`}}),D=m(()=>a.instantFeedback!==!0&&a.indeterminate!==!0?{transition:`stroke-dashoffset ${a.animationSpeed}ms ease 0s, stroke ${a.animationSpeed}ms ease`}:""),i=m(()=>O/(1-a.thickness/2)),r=m(()=>`${i.value/2} ${i.value/2} ${i.value} ${i.value}`),s=m(()=>he(a.value,a.min,a.max)),u=m(()=>a.max-a.min),f=m(()=>a.thickness/2*i.value),b=m(()=>{const o=(a.max-s.value)/u.value,d=a.rounded===!0&&s.value<a.max&&o<.25?f.value/2*(1-o/.25):0;return A*o+d});function k({thickness:o,offset:d,color:q,cls:N,rounded:T}){return p("circle",{class:"q-circular-progress__"+N+(q!==void 0?` text-${q}`:""),style:D.value,fill:"transparent",stroke:"currentColor","stroke-width":o,"stroke-dasharray":Se,"stroke-dashoffset":d,"stroke-linecap":T,cx:i.value,cy:i.value,r:P})}return()=>{const o=[];a.centerColor!==void 0&&a.centerColor!=="transparent"&&o.push(p("circle",{class:`q-circular-progress__center text-${a.centerColor}`,fill:"currentColor",r:P-f.value/2,cx:i.value,cy:i.value})),a.trackColor!==void 0&&a.trackColor!=="transparent"&&o.push(k({cls:"track",thickness:f.value,offset:0,color:a.trackColor})),o.push(k({cls:"circle",thickness:f.value,offset:b.value,color:a.color,rounded:a.rounded===!0?"round":void 0}));const d=[p("svg",{class:"q-circular-progress__svg",style:Q.value,viewBox:r.value,"aria-hidden":"true"},o)];return a.showValue===!0&&d.push(p("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:a.fontSize}},c.default!==void 0?c.default():[p("div",s.value)])),p("div",{class:`q-circular-progress q-circular-progress--${a.indeterminate===!0?"in":""}determinate`,style:e.value,role:"progressbar","aria-valuemin":a.min,"aria-valuemax":a.max,"aria-valuenow":a.indeterminate===!0?void 0:s.value},X(c.internal,d))}}}),we=Z({__name:"GroundingDemoComponent",props:{useLazyLoading:{type:Boolean,default:!0}},setup(a,{expose:c}){c();const y=a,e=pe(),{apiKey:Q}=$(e),{t:D}=ee({useScope:"global"}),i=h("In 2012, President Barack Hussein Obama repealed the Smith-Mundt act, which had been in place in 1948. The law prevented the government from putting its propaganda on TV and Radio."),r=h(!1),s=h(!0),u=h(0),f=h(null),b=h(null),k=h(null);let o=null;const d=m(()=>{var l;return(l=f.value)==null?void 0:l.data}),q=m(()=>{var l;return(l=d.value)!=null&&l.factuality?d.value.factuality*100:0}),N=m(()=>{var l;return((l=d.value)==null?void 0:l.references.filter(v=>v.isSupportive))||[]}),T=m(()=>{const l=Math.floor(u.value/1e3),v=Math.floor(u.value%1e3/100);return`${l}.${v} s`}),U=m(()=>{var l,v;return b.value!==null?((l=d.value)==null?void 0:l.references.filter(g=>g.isSupportive===b.value))||[]:((v=d.value)==null?void 0:v.references)||[]}),H=l=>{b.value===l?b.value=null:b.value=l},V=async()=>{if(!i.value)return;s.value=!0,f.value=null;const l=Date.now(),v=`https://g.jina.ai/${encodeURIComponent(i.value)}${r.value?"?deepdive=true":""}`;try{const g=await fetch(v,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${Q.value}`}});u.value=Date.now()-l,f.value=await g.json()}catch(g){f.value={message:g instanceof Error?g.message:String(g)}}finally{s.value=!1}},E=()=>{var v;const l=((v=k.value)==null?void 0:v.$el)||k.value;l instanceof HTMLElement?(o=new IntersectionObserver(g=>{g[0].isIntersecting&&(V(),o==null||o.disconnect())},{root:null,threshold:.1}),o.observe(l)):console.error("Element is not an HTMLElement:",l)};ae(()=>{y.useLazyLoading?te(()=>{setTimeout(()=>{E()},100)}):V()}),ne(()=>{o&&o.disconnect()});const F={props:y,embeddingStore:e,apiKey:Q,t:D,query:i,isDeepDive:r,isBusy:s,responseTime:u,response:f,filters:b,componentRef:k,get observer(){return o},set observer(l){o=l},responseData:d,factuality:q,supportiveNum:N,responseTimeString:T,references:U,onFilter:H,sendQuery:V,initIntersectionObserver:E,ref:h,get formatNumber(){return ke}};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),Qe={class:"text-negative"};function De(a,c,y,e,Q,D){return _(),x(ve,{ref:"componentRef",flat:"",square:"",bordered:"",class:"col-12 col-md-10"},{default:n(()=>{var i;return[t(I,{class:"q-pa-none"},{default:n(()=>[t(be,{onSubmit:e.sendQuery,ref:"formRef"},{default:n(()=>{var r,s;return[t(le,{square:"",filled:"","bottom-slots":!!e.response,modelValue:e.query,"onUpdate:modelValue":c[1]||(c[1]=u=>e.query=u),disable:e.isBusy,clearable:"",label:e.t("reader.demo.your_statement")},oe({prepend:n(()=>[t(se,{modelValue:e.isDeepDive,"onUpdate:modelValue":c[0]||(c[0]=u=>e.isDeepDive=u),disable:e.isBusy,"checked-icon":"biotech","icon-color":"black","unchecked-icon":"bolt"},{default:n(()=>[t(R,null,{default:n(()=>[S(C(e.t("reader.demo.headers.deepdive")),1)]),_:1})]),_:1},8,["modelValue","disable"])]),append:n(()=>[t(M,{square:"",flat:"",icon:"send",padding:"md",loading:e.isBusy,onClick:e.sendQuery,type:"submit"},null,8,["loading"])]),_:2},[(r=e.response)!=null&&r.name||(s=e.response)!=null&&s.message?{name:"hint",fn:n(()=>[ie("span",Qe,[S(C(e.response.name||e.response.message)+" ",1),e.response.readableMessage?(_(),x(R,{key:0},{default:n(()=>[S(C(e.response.readableMessage),1)]),_:1})):B("",!0)])]),key:"0"}:e.response?{name:"hint",fn:n(()=>{var u;return[t(G,{icon:"timer",label:`${e.responseTimeString}`,size:"sm",class:"text-dim bg-transparent"},null,8,["label"]),t(G,{icon:"straighten",label:`${e.formatNumber(((u=e.responseData)==null?void 0:u.usage.tokens)||0)} ${e.t("embedding.tokens")}`,size:"sm",class:"text-dim bg-transparent"},null,8,["label"])]}),key:"1"}:void 0]),1032,["bottom-slots","modelValue","disable","label"])]}),_:1},512)]),_:1}),e.isBusy?(_(),x(_e,{key:0,indeterminate:"",size:"1px"})):B("",!0),e.responseData?(_(),x(I,{key:1,class:"q-mt-lg"},{default:n(()=>[t(j,null,{default:n(()=>[t(w,{side:""},{default:n(()=>[t(Ce,{"show-value":"",value:e.factuality,size:"60px",thickness:.1,color:e.factuality>50?"positive":"negative","track-color":"surface-mixed-200"},{default:n(()=>{var r,s;return[t(L,{name:(r=e.responseData)!=null&&r.result?"check":"close",color:(s=e.responseData)!=null&&s.result?"accent":"negative",size:"30px"},null,8,["name","color"])]}),_:1},8,["value","color"])]),_:1}),t(w,null,{default:n(()=>[t(z,{class:"text-bold"},{default:n(()=>[S(C(e.responseData.result?e.t("reader.demo.grounding_result_true"):e.t("reader.demo.grounding_result_false")),1)]),_:1}),t(z,{caption:""},{default:n(()=>{var r;return[S(C((r=e.responseData)==null?void 0:r.reason),1)]}),_:1})]),_:1}),t(w,{side:""},{default:n(()=>[t(ge,{outline:"",square:""},{default:n(()=>{var r,s,u;return[t(M,{label:(r=e.supportiveNum)==null?void 0:r.length,icon:"thumb_up",square:"",onClick:c[2]||(c[2]=f=>e.onFilter(!0)),outline:""},null,8,["label"]),t(ue),t(M,{label:(((s=e.responseData)==null?void 0:s.references.length)||0)-((u=e.supportiveNum)==null?void 0:u.length),icon:"thumb_down",square:"",onClick:c[3]||(c[3]=f=>e.onFilter(!1)),outline:""},null,8,["label"])]}),_:1})]),_:1})]),_:1})]),_:1})):B("",!0),(i=e.responseData)!=null&&i.references.length?(_(),x(I,{key:2},{default:n(()=>[t(ye,null,{default:n(()=>[t(ce,{name:"list2"},{default:n(()=>[(_(!0),de(me,null,fe(e.references,r=>(_(),x(j,{clickable:"",key:r.url,href:r.url,target:"_blank",class:"card-details"},{default:n(()=>[t(w,{avatar:""},{default:n(()=>[t(L,{name:r.isSupportive?"thumb_up":"thumb_down",color:r.isSupportive?"positive":"negative"},null,8,["name","color"])]),_:2},1024),t(w,null,{default:n(()=>[t(z,{lines:"1",class:"text-italic"},{default:n(()=>[S("... "+C(r.keyQuote)+" ...",1)]),_:2},1024),t(z,{caption:""},{default:n(()=>[t(G,{square:"",size:"sm",icon:`img:https://www.google.com/s2/favicons?sz=32&domain_url=${r.url}`,label:r.url,class:"text-caption q-mx-none bg-mixed-200",style:{"max-width":"60%"}},null,8,["icon","label"])]),_:2},1024)]),_:2},1024),t(w,{side:""},{default:n(()=>[t(L,{name:"open_in_new",size:"xs",class:"read-more-btn"})]),_:1})]),_:2},1032,["href"]))),128))]),_:1})]),_:1})]),_:1})):B("",!0)]}),_:1},512)}const Pe=re(we,[["render",De],["__file","GroundingDemoComponent.vue"]]);export{Pe as G};
