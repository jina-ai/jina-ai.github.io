<!DOCTYPE html><html lang="en"><head><link rel="preload" as="style" data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&amp;display=swap"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta property="og:title" content="Jina AI - a Neural Search Company"/><meta name="author" content="Jina AI"/><meta property="og:locale" content="en_US"/><meta property="og:site_name" content="Jina AI"/><meta property="og:image" content="https://jina.ai/assets/images/jina_banner_new.png"/><meta name="twitter:card" content="summary"/><meta property="twitter:image" content="https://jina.ai/assets/images/jina_banner_new.png"/><meta property="twitter:title" content="Jina AI - a Neural Search Company"/><meta name="twitter:site" content="@JinaAI_"/><meta name="twitter:creator" content="@Jina AI"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-96x96.png"/><link rel="icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"/><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&amp;display=swap"/><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Open source neural search ecosystem for businesses and developers, allowing anyone to search any kind of data with high availability and scalability."/><meta property="og:url" content="https://jina.ai/"/><meta property="og:title" content="Jina AI | Jina AI is a Neural Search Company"/><meta property="og:description" content="Open source neural search ecosystem for businesses and developers, allowing anyone to search any kind of data with high availability and scalability."/><meta property="og:locale" content="en"/><meta property="og:site_name" content="Jina AI, Ltd"/><link rel="canonical" href="https://jina.ai/"/><title>Jina and Terraform | Jina AI</title><meta name="next-head-count" content="30"/><link rel="preload" href="/_next/static/css/25d6efe0ea2e2dcdacf0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/25d6efe0ea2e2dcdacf0.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-7104263f55fe667182de.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-94f262366e752bd48d82.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons-4667b98b62a60d7c050b.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-9a4182dc8e7736869bf9.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-a6a417216c843cabb548.js" as="script"/><link rel="preload" href="/_next/static/chunks/596-13cdde2fb793b77184ee.js" as="script"/><link rel="preload" href="/_next/static/chunks/522-e45333ebcf36799b860c.js" as="script"/><link rel="preload" href="/_next/static/chunks/373-350caaa5387e56e8b807.js" as="script"/><link rel="preload" href="/_next/static/chunks/93-d39fe6d1ec4ad9d5d4fc.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bslug%5D-f696244b1bc09a37c8f2.js" as="script"/><style id="__jsx-3792957869">.dropdown.jsx-3792957869{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));padding:1.5rem;--tw-text-opacity:1;color:rgba(74,85,104,var(--tw-text-opacity));top:5rem;width:24rem;border-radius:0.75rem;}.dropdown.jsx-3792957869>.jsx-3792957869:not([hidden])~.jsx-3792957869:not([hidden]){--tw-divide-y-reverse:0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse));border-style:solid;--tw-divide-opacity:1;border-color:rgba(235,235,235,var(--tw-divide-opacity));}.dropdown.jsx-3792957869{box-shadow:3px 6px 33px rgba(205,205,205,0.25);}</style><style id="__jsx-3128403005">.dropdown.jsx-3128403005{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(74,85,104,var(--tw-text-opacity));top:5rem;width:100%;border-radius:0.75rem;}.dropdown.jsx-3128403005>.jsx-3128403005:not([hidden])~.jsx-3128403005:not([hidden]){--tw-divide-y-reverse:0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse));border-style:solid;--tw-divide-opacity:1;border-color:rgba(235,235,235,var(--tw-divide-opacity));}</style><style id="__jsx-3949856645">.btn.jsx-3949856645{text-align:center;}.btn-base.jsx-3949856645{font-size:1.125rem;font-weight:600;}.btn-xl.jsx-3949856645{padding-top:1rem;padding-bottom:1rem;padding-left:1.5rem;padding-right:1.5rem;font-size:1.25rem;font-weight:800;}.btn-full-rounded.jsx-3949856645{border-radius:9999px;}.btn-primary.jsx-3949856645{border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(0,129,129,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity));}.btn-primary.jsx-3949856645:hover{background-color:#009191;}.btn-secondary.jsx-3949856645{--tw-bg-opacity:1;background-color:rgba(251,203,103,var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(0,0,0,var(--tw-text-opacity));}.btn-secondary.jsx-3949856645:hover{background-color:#fbd076;}.btn-tertiary.jsx-3949856645{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity));border:1px solid #999999;}.btn-tertiary.jsx-3949856645:hover{background-color:#f6f6f6;}.btn-outlined.jsx-3949856645{border-width:2px;border-style:solid;--tw-border-opacity:1;border-color:rgba(255,255,255,var(--tw-border-opacity));background-color:transparent;}.btn-outlined.jsx-3949856645:hover{background-color:#f6f6f622;}</style><style id="__jsx-223001487">.navbar.jsx-223001487 a{display:inline-block;width:100%;}.navbar.jsx-223001487 li:not(:first-child){margin-top:0.75rem;}.navbar.jsx-223001487 a .btn{width:100%;}.navbar.jsx-223001487 a:hover{--tw-text-opacity:1;color:rgba(0,129,129,var(--tw-text-opacity));}@media (min-width:640px){.navbar.jsx-223001487 a,.navbar.jsx-223001487 a .btn{width:auto;}.navbar.jsx-223001487 li:not(:first-child){margin-top:0px;}.navbar.jsx-223001487>(li:not(:last-child)){margin-right:1.25rem;}}</style><style id="__jsx-649517993">.top-nav-bar.jsx-649517993{box-shadow:3px 6px 33px 0px #cdcdcd40;z-index:200;position:fixed;width:100vw;background:white;top:0;}</style><style id="__jsx-4055754880">.markdown.jsx-4055754880{font-size:1.125rem;line-height:1.625;}.markdown.jsx-4055754880 p.jsx-4055754880,.markdown.jsx-4055754880 ul.jsx-4055754880,.markdown.jsx-4055754880 ol.jsx-4055754880,.markdown.jsx-4055754880 blockquote.jsx-4055754880{margin-top:1.5rem;margin-bottom:1.5rem;}.markdown.jsx-4055754880 h2.jsx-4055754880{margin-top:3rem;margin-bottom:1rem;font-size:1.875rem;line-height:1.375;}.markdown.jsx-4055754880 h3.jsx-4055754880{margin-top:2rem;margin-bottom:1rem;font-size:1.5rem;line-height:1.375;}</style><style id="__jsx-1324436386">.footer-links.jsx-1324436386 li{margin-top:0.25rem;}.footer-items-title.jsx-1324436386{font-size:1.375rem;line-height:1.5rem;-webkit-letter-spacing:0.22px;-moz-letter-spacing:0.22px;-ms-letter-spacing:0.22px;letter-spacing:0.22px;}</style><style id="__jsx-1956813867">.footer-left-margin.jsx-1956813867{width:20rem;height:inherit;background:no-repeat 40% 20% / 30% url('/assets/images/planet-beige.svg');}.footer-right-margin.jsx-1956813867{width:16rem;height:inherit;background:no-repeat 10% 10% / 50% url('/assets/images/planet-green.svg');}</style><style data-href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap">@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrFJM.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7V1g.woff) format('woff')}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrJJbecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrJJnecnFHGPezSQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiEyp8kv8JHgFVrJJfecnFHGPc.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLEj6Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z11lFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0900-097F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z1JlFd2JQEl8qw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Poppins';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/poppins/v15/pxiByp8kv8JHgFVrLCz7Z1xlFd2JQEk.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><script async="" src="https://www.googletagmanager.com/gtag/js?id=undefined"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'undefined', {
              page_path: window.location.pathname,
            });
          </script><body><div id="__next"><div class="jsx-649517993 top-nav-bar"><div class="md:max-w-screen-md lg:max-w-screen-lg xl:max-w-screen-2xl mx-auto px-3 py-6 undefined"><div class="jsx-223001487 flex flex-wrap justify-between items-center"><div class="jsx-223001487"><a class="jsx-223001487" href="/"><div class="text-gray-900 flex items-center font-semibold text-3xl"><img src="/assets/images/logo.svg" alt="Jina.ai logo" class="w-24"/></div></a></div><div class="jsx-223001487 sm:hidden"><button type="button" aria-label="show menu" class="jsx-223001487 p-3 text-gray-900 rounded-md hover:bg-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round" class="jsx-223001487 stroke-current h-6 w-6"><path d="M0 0h24v24H0z" stroke="none" class="jsx-223001487"></path><path d="M4 6h16M4 12h16M4 18h16" class="jsx-223001487"></path></svg></button></div><nav class="jsx-223001487 w-full sm:w-auto sm:block mt-2 sm:mt-0 hidden"><ul class="jsx-223001487 navbar flex flex-col sm:flex-row sm:items-center font-medium text-xl text-gray-800 pt-3 pb-5 px-5 sm:p-0 bg-white sm:bg-transparent rounded"><li class="jsx-649517993 hidden md:inline-block"><div class="jsx-3792957869 group inline-block relative"><button aria-label="Open Products dropdown" class="jsx-3792957869 text-gray-700 font-semibold py-2 px-4 rounded inline-flex items-center"><span class="jsx-3792957869 mr-1 font-bold">Products</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="jsx-3792957869 fill-current h-4 w-4 mt-2"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" class="jsx-3792957869"></path></svg></button><div class="jsx-3792957869 absolute hidden group-hover:block bg-transparent pt-7"><ul class="jsx-3792957869 dropdown"><li class="jsx-3792957869 hover:bg-gray-200"><a href="/core" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/core-icon.svg" alt="core icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Jina Core</span></div><span class="jsx-3792957869 text-xs text-gray-500">An open-source framework for building multimedia search applications.</span></div></a></li><li class="jsx-3792957869 hover:bg-gray-200"><a href="/hub" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/hub-icon.svg" alt="hub icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Jina Hub</span></div><span class="jsx-3792957869 text-xs text-gray-500">Jina’s community-driven module marketplace for building your Flow</span></div></a></li></ul></div></div></li><li class="jsx-649517993 hidden md:inline-block"><div class="jsx-3792957869 group inline-block relative"><button aria-label="Open Developers dropdown" class="jsx-3792957869 text-gray-700 font-semibold py-2 px-4 rounded inline-flex items-center"><span class="jsx-3792957869 mr-1 font-bold">Developers</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="jsx-3792957869 fill-current h-4 w-4 mt-2"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" class="jsx-3792957869"></path></svg></button><div class="jsx-3792957869 absolute hidden group-hover:block bg-transparent pt-7"><ul class="jsx-3792957869 dropdown"><li class="jsx-3792957869 hover:bg-gray-200"><a href="/contribute" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/contribute-icon.svg" alt="contribute icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Contribute</span></div><span class="jsx-3792957869 text-xs text-gray-500">Want to shape the future of neural search? Find out how you can contribute to Jina here.</span></div></a></li><li class="jsx-3792957869 hover:bg-gray-200"><a href="/join" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/join-icon.svg" alt="join icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Join</span></div><span class="jsx-3792957869 text-xs text-gray-500">Join the Jina Slack community to meet the team and get support.</span></div></a></li><li class="jsx-3792957869 hover:bg-gray-200"><a href="/learn" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/learn-icon.svg" alt="learn icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Learn</span></div><span class="jsx-3792957869 text-xs text-gray-500">Docs, tutorials and examples for developers to get started with Jina. </span></div></a></li></ul></div></div></li><li class="jsx-649517993 hidden md:inline-block"><div class="jsx-3792957869 group inline-block relative"><button aria-label="Open Company dropdown" class="jsx-3792957869 text-gray-700 font-semibold py-2 px-4 rounded inline-flex items-center"><span class="jsx-3792957869 mr-1 font-bold">Company</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="jsx-3792957869 fill-current h-4 w-4 mt-2"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" class="jsx-3792957869"></path></svg></button><div class="jsx-3792957869 absolute hidden group-hover:block bg-transparent pt-7"><ul class="jsx-3792957869 dropdown"><li class="jsx-3792957869 hover:bg-gray-200"><a href="/about" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/about-icon.svg" alt="about icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">About</span></div><span class="jsx-3792957869 text-xs text-gray-500">Learn more about Jina AI as a company.</span></div></a></li><li class="jsx-3792957869 hover:bg-gray-200"><a href="/careers" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/careers-icon.svg" alt="careers icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Careers</span></div><span class="jsx-3792957869 text-xs text-gray-500">Interested in joining us? Find out what it&#x27;s like to work at Jina AI.</span></div></a></li><li class="jsx-3792957869 hover:bg-gray-200"><a href="/events" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/events-icon.svg" alt="events icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Events</span></div><span class="jsx-3792957869 text-xs text-gray-500">Online and offline meetups, hackathons, workshops and webinars.</span></div></a></li><li class="jsx-3792957869 hover:bg-gray-200"><a href="/news" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/news-icon.svg" alt="news icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">News</span></div><span class="jsx-3792957869 text-xs text-gray-500">Check out the latest news about our company and products.</span></div></a></li><li class="jsx-3792957869 hover:bg-gray-200"><a href="/contact" class="jsx-3792957869 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3792957869 leading-4"><div class="jsx-3792957869 flex items-center"><div class=""><img src="/assets/images/icons/contact-icon.svg" alt="contact icon" class="w-full h-full"/></div><span class="jsx-3792957869 text-gray-800 font-semibold text-sm ml-2">Contact</span></div><span class="jsx-3792957869 text-xs text-gray-500">Interested in cooperating with Jina AI? Get in touch!</span></div></a></li></ul></div></div></li><li class="jsx-649517993 hidden md:inline-block mr-1 font-bold text-gray-700"><a href="/blog/">Blog</a></li><div class="jsx-3128403005 md:hidden h-96 overflow-y-scroll"><ul class="jsx-3128403005 dropdown"><div class="jsx-3128403005 linkItem.label divide-solid divide-gray-200 divide-y"><li class="jsx-3128403005 hover:bg-gray-200"><a href="/core" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/core-icon.svg" alt="core icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Jina Core</span></div><span class="jsx-3128403005 text-xs text-gray-500">An open-source framework for building multimedia search applications.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/hub" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/hub-icon.svg" alt="hub icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Jina Hub</span></div><span class="jsx-3128403005 text-xs text-gray-500">Jina’s community-driven module marketplace for building your Flow</span></div></a></li></div><div class="jsx-3128403005 linkItem.label divide-solid divide-gray-200 divide-y"><li class="jsx-3128403005 hover:bg-gray-200"><a href="/contribute" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/contribute-icon.svg" alt="contribute icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Contribute</span></div><span class="jsx-3128403005 text-xs text-gray-500">Want to shape the future of neural search? Find out how you can contribute to Jina here.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/join" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/join-icon.svg" alt="join icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Join</span></div><span class="jsx-3128403005 text-xs text-gray-500">Join the Jina Slack community to meet the team and get support.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/learn" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/learn-icon.svg" alt="learn icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Learn</span></div><span class="jsx-3128403005 text-xs text-gray-500">Docs, tutorials and examples for developers to get started with Jina. </span></div></a></li></div><div class="jsx-3128403005 linkItem.label divide-solid divide-gray-200 divide-y"><li class="jsx-3128403005 hover:bg-gray-200"><a href="/about" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/about-icon.svg" alt="about icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">About</span></div><span class="jsx-3128403005 text-xs text-gray-500">Learn more about Jina AI as a company.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/careers" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/careers-icon.svg" alt="careers icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Careers</span></div><span class="jsx-3128403005 text-xs text-gray-500">Interested in joining us? Find out what it&#x27;s like to work at Jina AI.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/events" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/events-icon.svg" alt="events icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Events</span></div><span class="jsx-3128403005 text-xs text-gray-500">Online and offline meetups, hackathons, workshops and webinars.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/news" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/news-icon.svg" alt="news icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">News</span></div><span class="jsx-3128403005 text-xs text-gray-500">Check out the latest news about our company and products.</span></div></a></li><li class="jsx-3128403005 hover:bg-gray-200"><a href="/contact" class="jsx-3128403005 py-2 px-4 block whitespace-no-wrap"><div class="jsx-3128403005 leading-4"><div class="jsx-3128403005 flex items-center"><div class=""><img src="/assets/images/icons/contact-icon.svg" alt="contact icon" class="w-full h-full"/></div><span class="jsx-3128403005 text-gray-800 font-semibold text-sm ml-2">Contact</span></div><span class="jsx-3128403005 text-xs text-gray-500">Interested in cooperating with Jina AI? Get in touch!</span></div></a></li></div></ul><span class="jsx-3128403005 text-gray-700 font-semibold text-sm ml-2 p-4">Blog</span></div><li class="jsx-223001487"><div class="jsx-3949856645 btn cursor-pointer flex items-center justify-center px-6 py-2 md:hidden btn-base btn-primary"><div class="mr-4 w-7"><img src="/assets/images/icons/GitHub-white-icon.svg" alt="GitHub-white icon" class="w-full h-full"/></div><span class="jsx-223001487 mr-4">Try it out!</span></div></li></ul></nav><div class="jsx-3949856645 btn cursor-pointer flex items-center justify-center px-6 py-2 hidden md:flex btn-base btn-primary"><div class="mr-4 w-7"><img src="/assets/images/icons/GitHub-white-icon.svg" alt="GitHub-white icon" class="w-full h-full"/></div><span class="jsx-223001487 mr-4">Try it out!</span></div></div></div></div><div class="mt-24"><div class="min-h-screen"><main><div class="container mx-auto px-5 flex flex-col"><img src="/assets/images/blog/jina_terraform.png" alt="Jina and Terraform-image" class="mb-4 w-full"/><article class="mb-32 md:max-w-6xl md:shadow-lg xl:rounded-3xl md:px-32 md:py-20 md:mx-auto md:-mt-20 bg-white shadow"><div class="mb-3"><div class="inline-block px-2 py-0 rounded text-primary-500 bg-primary-500 bg-opacity-20 mr-2 mb-2">Terraform</div><div class="inline-block px-2 py-0 rounded text-primary-500 bg-primary-500 bg-opacity-20 mr-2 mb-2">infrastructure</div></div><h1 class="text-xl md:text-4xl font-bold tracking-tighter leading-tight md:leading-none mb-6 md:text-left">Jina and Terraform</h1><div class="flex items-center justify-between text-gray-600 mb-12"><div class="flex items-center"><img src="/assets/images/team/avatar-default.svg" class="w-8 h-auto rounded-full mr-4" alt="Susana Guzmán"/><div class="text-gray-600">Susana Guzmán</div></div><time dateTime="2020-11-05T14:00:39.923Z">5 November, 2020</time></div><div class="jsx-4055754880 mx-auto markdown"><div class="jsx-4055754880 "><h1>Jina ❤️ Terraform</h1>
<p>Hi everyone!
Recently I've been working with Terraform and tinkering with it to see how we can integrate it with Jina, so I thought to share with you all that I got.</p>
<p><img src="https://cdn-images-1.medium.com/max/800/1*NOHC39WweKZll_StMSz6Vg.jpeg" alt=""></p>
<p>First thing was to see what Terraform is and why everyone is so hyped about it. According to their website:</p>
<blockquote class="blockquote ml-5 mr-5">
“Terraform is a tool for building, changing, and versioning infrastructure safely and efficiently. Terraform can manage existing and popular service providers as well as custom in-house solutions.”
</blockquote>
<p>So that's a lot of fancy words to say it's a way for you to define your infrastructure via code. No need to go to AWS console and define every part of the infrastructure there. This comes in very handy since it's easier to debug when you have everything in one script so you can see all the details in one single place.</p>
<p>Cool! Nice, sold, what now?</p>
<p>Let's tweak our <a href="https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Fjina-ai%2Fexamples%2Ftree%2Fmaster%2Fsouthpark-search">South Park</a> example and instead of running our Docker image locally and then checking the results with Curl, let's set everything on an AWS instance and use that URL. And of course, because otherwise this post wouldn't make sense and I could be napping instead, let's set up the infrastructure with Terraform. </p>
<hr>
<h2>What will you need?</h2>
<ol>
<li>Terraform</li>
<li>An AWS account</li>
<li>The South Park Docker image</li>
</ol>
<p>The first thing is to install Terraform, and the installation will depend on your OS. I'm using macOS and I installed it via Homebrew:</p>
<p><code>brew install terraform</code></p>
<p>Once you have it installed, you need to configure your AWS, so on your console the first command you'll run is:</p>
<p><code>aws configure</code></p>
<p>This will ask for the credentials of your AWS account. Once you set this, you won't need to specify keys through code, which is good because that's a bad practice and you will end up with your account in quarantine…this might have or not have happened to me. </p>
<p>Ok! we have all the setup ready and we can start to write our Terraform file. </p>
<hr>
<h2>What is happening? What is going to happen?</h2>
<ol>
<li>Create an image repository in AWS and push our South Park docker image</li>
<li>Create an ECS Cluster &#x26; Task</li>
<li>Create an ECS service &#x26; load balancer</li>
</ol>
<hr>
<h2>Create an image repository in AWS and push our South Park docker image</h2>
<p>We already have a Docker image with the South Park example so we don't need to create a new one.</p>
<p>So the first thing is to create our Terraform script. It can be called whatever you want but with a .tf extension</p>
<pre class="rounded-xl m-0 md:mr-6" style="display:block;overflow-x:auto;padding:0.5em;background:#2d2b57;font-weight:normal;color:#e3dfff" data-reactroot=""><code class="language-python" style="white-space:pre"><span>provider </span><span style="color:#4cd213">&quot;aws&quot;</span><span> {
</span><span>  version = </span><span style="color:#4cd213">&quot;~&gt; 2.0&quot;</span><span>
</span><span>  region  = </span><span style="color:#4cd213">&quot;us-east-2&quot;</span><span>
</span>}
<!-- -->
<span></span><span style="color:#ac65ff">#Create repo</span><span>
</span><span>resource </span><span style="color:#4cd213">&quot;aws_ecr_repository&quot;</span><span> </span><span style="color:#4cd213">&quot;southpark&quot;</span><span> {
</span><span>  name = </span><span style="color:#4cd213">&quot;sp-repo&quot;</span><span> </span><span style="color:#ac65ff"># Naming my repository</span><span>
</span>  tags = {
<span>    Name = </span><span style="color:#4cd213">&quot;southpark_repo&quot;</span><span>
</span>  }
<!-- -->}
<!-- -->
</code></pre>
<p>The first part is to create a provider, with Terraform you can use <strong>AWS</strong>, <strong>Azure</strong>, <strong>Google Cloud Platform</strong> or many others, you can even write your own if you feel like life is too boring and you are an expert in Go. Whatever floats your boat. We'll use AWS for this example. The second part is to create our repository and we just need to set the name for it. The tags are always optional.</p>
<p>This is the simplest Terraform file you can have, if you run this, Terraform will create an AWS repository for you, so let's do that. </p>
<p>You can run </p>
<p><code>terraform plan</code></p>
<p>And this will print a plan with all the resources that will be created, modified, or deleted. In this case, we are only creating a resource so it will show that. This command is always nice to do for a sanity check, so you see what will happen before it happens, and if we agree with this we run the script with</p>
<p><code>terraform apply</code></p>
<p>After we run this, if we go to our AWS console, we'll see that an sp-repo has been created</p>
<p><img src="https://miro.medium.com/max/700/1*uBSArpUv9O6DcpElkv4OFQ.png" alt=""></p>
<p>Great, we have our repository ready. But at the moment it's empty, we need to push our Southpark docker image into it. To do that click on the repository name, and then in the upper right corner you'll see a button of "View Push commands"</p>
<p><img src="https://miro.medium.com/max/700/1*ZcUygghp_Ifw2oCrgYca8w.png" alt=""></p>
<p>We will use that information to push our Docker image</p>
<p><img src="https://miro.medium.com/max/700/1*HkhGylAFXfmbqcniAOs_WA.png" alt=""></p>
<p>Follow the steps that are shown there except step 2, we don't need that since we already have our Docker image. After you've done that, you should have the Southpark image in your repository, yay. </p>
<h2>Create a Cluster &#x26; Task</h2>
<p>The next step is to create a Cluster.</p>
<pre class="rounded-xl m-0 md:mr-6" style="display:block;overflow-x:auto;padding:0.5em;background:#2d2b57;font-weight:normal;color:#e3dfff" data-reactroot=""><code class="language-python" style="white-space:pre"><span>resource </span><span style="color:#4cd213">&quot;aws_ecs_cluster&quot;</span><span> </span><span style="color:#4cd213">&quot;southpark_cluster&quot;</span><span> {
</span><span>  name = </span><span style="color:#4cd213">&quot;southpark_cluster&quot;</span><span> </span><span style="color:#ac65ff"># Naming the cluster</span><span>
</span>}
<!-- -->
</code></pre>
<p>Ok, for the task we need a bit more details</p>
<pre class="rounded-xl m-0 md:mr-6" style="display:block;overflow-x:auto;padding:0.5em;background:#2d2b57;font-weight:normal;color:#e3dfff" data-reactroot=""><code class="language-python" style="white-space:pre"><span style="color:#ac65ff">#Create task</span><span>
</span><span>resource </span><span style="color:#4cd213">&quot;aws_ecs_task_definition&quot;</span><span> </span><span style="color:#4cd213">&quot;southpark_task&quot;</span><span> {
</span><span>  family                   = </span><span style="color:#4cd213">&quot;southpark_task&quot;</span><span> 
</span><span>  container_definitions    = &amp;</span><span style="color:#ac65ff">#x3C;&amp;#x3C;DEFINITION</span><span>
</span>  [
<!-- -->    {
<span>      </span><span style="color:#4cd213">&quot;name&quot;</span><span>: </span><span style="color:#4cd213">&quot;southpark_task&quot;</span><span>,
</span><span>      </span><span style="color:#4cd213">&quot;image&quot;</span><span>: </span><span style="color:#4cd213">&quot;${aws_ecr_repository.southpark.repository_url}&quot;</span><span>,
</span><span>      </span><span style="color:#4cd213">&quot;essential&quot;</span><span>: true,
</span><span>      </span><span style="color:#4cd213">&quot;portMappings&quot;</span><span>: [
</span>        {
<span>          </span><span style="color:#4cd213">&quot;containerPort&quot;</span><span>: </span><span style="color:#fa658d">45678</span><span>,
</span><span>          </span><span style="color:#4cd213">&quot;hostPort&quot;</span><span>: </span><span style="color:#fa658d">45678</span><span>
</span>        }
<!-- -->      ],
<span>      </span><span style="color:#4cd213">&quot;memory&quot;</span><span>: </span><span style="color:#fa658d">2014</span><span>,
</span><span>      </span><span style="color:#4cd213">&quot;cpu&quot;</span><span>: </span><span style="color:#fa658d">1024</span><span>
</span>    }
<!-- -->  ]
<!-- -->  DEFINITION
<span>  requires_compatibilities = [</span><span style="color:#4cd213">&quot;FARGATE&quot;</span><span>] </span><span style="color:#ac65ff"># Stating that we are using ECS Fargate</span><span>
</span><span>  network_mode             = </span><span style="color:#4cd213">&quot;awsvpc&quot;</span><span>    </span><span style="color:#ac65ff"># Using awsvpc as our network mode as this is required for Fargate</span><span>
</span><span>  memory                   = </span><span style="color:#fa658d">2048</span><span>         </span><span style="color:#ac65ff"># Specifying the memory our container requires</span><span>
</span><span>  cpu                      = </span><span style="color:#fa658d">1024</span><span>        </span><span style="color:#ac65ff"># Specifying the CPU our container requires</span><span>
</span><span>  execution_role_arn       = </span><span style="color:#4cd213">&quot;${aws_iam_role.ecsExecutionRole.arn}&quot;</span><span>
</span>}
<!-- -->
</code></pre>
<p>For this, we will set the image URL of our Docker image and set the ports to <code>45678</code>, the same that the Southpark example is using. </p>
<p>If you run <code>terraform apply</code> you should see a new cluster with a task attached to it</p>
<p><img src="https://miro.medium.com/max/700/1*HJc1oek7Yf7ry0X5ZhyJ4w.png" alt=""></p>
<h2>Create a service &#x26; load balancer</h2>
<p>Ok, now we want to create a service that will use the task we just created as a blueprint. Here we will set the name of the service, a reference to our cluster, and to the task we just made. We will have only one container so we set <code>desired_count</code> to 1</p>
<pre class="rounded-xl m-0 md:mr-6" style="display:block;overflow-x:auto;padding:0.5em;background:#2d2b57;font-weight:normal;color:#e3dfff" data-reactroot=""><code class="language-python" style="white-space:pre"><span style="color:#ac65ff">#create service</span><span>
</span><span>resource </span><span style="color:#4cd213">&quot;aws_ecs_service&quot;</span><span> </span><span style="color:#4cd213">&quot;southpark_service&quot;</span><span> {
</span><span>  name            = </span><span style="color:#4cd213">&quot;southpark_service&quot;</span><span>                             </span><span style="color:#ac65ff"># Naming our first service</span><span>
</span><span>  cluster         = </span><span style="color:#4cd213">&quot;${aws_ecs_cluster.southpark_cluster.id}&quot;</span><span>             </span><span style="color:#ac65ff"># Referencing our created Cluster</span><span>
</span><span>  task_definition = </span><span style="color:#4cd213">&quot;${aws_ecs_task_definition.southpark_task.arn}&quot;</span><span> </span><span style="color:#ac65ff"># Referencing the task our service will spin up</span><span>
</span><span>  launch_type     = </span><span style="color:#4cd213">&quot;FARGATE&quot;</span><span>
</span><span>  desired_count   = </span><span style="color:#fa658d">1</span><span>
</span>
<!-- -->  load_balancer {
<span>    target_group_arn = </span><span style="color:#4cd213">&quot;${aws_lb_target_group.target_group.arn}&quot;</span><span> </span><span style="color:#ac65ff"># Referencing our target group</span><span>
</span><span>    container_name   = </span><span style="color:#4cd213">&quot;${aws_ecs_task_definition.southpark_task.family}&quot;</span><span>
</span><span>    container_port   = </span><span style="color:#fa658d">45678</span><span> </span><span style="color:#ac65ff"># Specifying the container port</span><span>
</span>  }
<!-- -->
<!-- -->  network_configuration {
<!-- -->    subnets          = data.aws_subnet_ids.default.ids
<span>    assign_public_ip = true                                                </span><span style="color:#ac65ff"># Providing our containers with public IPs</span><span>
</span><span>    security_groups  = [</span><span style="color:#4cd213">&quot;${aws_security_group.service_security_group.id}&quot;</span><span>] </span><span style="color:#ac65ff"># Setting the security group</span><span>
</span>  }
<!-- -->  depends_on = [aws_lb_listener.lsr, aws_iam_role_policy_attachment.ecsTaskExecutionRole_policy]
<!-- -->}
<!-- -->
</code></pre>
<p>We need a load balancer as the access point to our container. The load balancer needs a security group, so we need to create that too</p>
<pre class="rounded-xl m-0 md:mr-6" style="display:block;overflow-x:auto;padding:0.5em;background:#2d2b57;font-weight:normal;color:#e3dfff" data-reactroot=""><code class="language-python" style="white-space:pre"><span style="color:#ac65ff"># Creating a security group for the load balancer:</span><span>
</span><span></span><span style="color:#ac65ff"># This is the one that will receive traffic from internet</span><span>
</span><span>resource </span><span style="color:#4cd213">&quot;aws_security_group&quot;</span><span> </span><span style="color:#4cd213">&quot;load_balancer_security_group&quot;</span><span> {
</span><span>  description = </span><span style="color:#4cd213">&quot;control access to the ALB&quot;</span><span>
</span>  ingress {
<span>    from_port   = </span><span style="color:#fa658d">45678</span><span>
</span><span>    to_port     = </span><span style="color:#fa658d">45678</span><span>
</span><span>    protocol    = </span><span style="color:#4cd213">&quot;tcp&quot;</span><span>
</span><span>    cidr_blocks = [</span><span style="color:#4cd213">&quot;0.0.0.0/0&quot;</span><span>] </span><span style="color:#ac65ff"># Allowing traffic in from all sources</span><span>
</span>  }
<!-- -->
<!-- -->  egress {
<span>    from_port   = </span><span style="color:#fa658d">0</span><span>
</span><span>    to_port     = </span><span style="color:#fa658d">0</span><span>
</span><span>    protocol    = </span><span style="color:#4cd213">&quot;-1&quot;</span><span>
</span><span>    cidr_blocks = [</span><span style="color:#4cd213">&quot;0.0.0.0/0&quot;</span><span>]
</span>  }
<!-- -->}
<!-- -->
<span></span><span style="color:#ac65ff">#ECS will receive traffic from the ALB</span><span>
</span><span>resource </span><span style="color:#4cd213">&quot;aws_security_group&quot;</span><span> </span><span style="color:#4cd213">&quot;service_security_group&quot;</span><span> {
</span><span>  description = </span><span style="color:#4cd213">&quot;Allow acces only from the ALB&quot;</span><span>
</span>  ingress {
<span>    from_port = </span><span style="color:#fa658d">0</span><span>
</span><span>    to_port   = </span><span style="color:#fa658d">0</span><span>
</span><span>    protocol  = </span><span style="color:#4cd213">&quot;-1&quot;</span><span>
</span><span>    </span><span style="color:#ac65ff"># Only allowing traffic in from the load balancer security group</span><span>
</span><span>    security_groups = [</span><span style="color:#4cd213">&quot;${aws_security_group.load_balancer_security_group.id}&quot;</span><span>]
</span>  }
<!-- -->
<!-- -->  egress { 
<span>    from_port   = </span><span style="color:#fa658d">0</span><span>
</span><span>    to_port     = </span><span style="color:#fa658d">0</span><span>
</span><span>    protocol    = </span><span style="color:#4cd213">&quot;-1&quot;</span><span>
</span><span>    cidr_blocks = [</span><span style="color:#4cd213">&quot;0.0.0.0/0&quot;</span><span>]
</span>  }
<!-- -->}
<!-- -->
</code></pre>
<p>The idea is that all traffic will be received by our <em>load_balancer_security_group</em> (ALB), and the <em>service_security_group</em> will receive only from the ALB.</p>
<p>Just for debugging, we have also an output to show us the URL that will use to access our Southpark example</p>
<pre class="rounded-xl m-0 md:mr-6" style="display:block;overflow-x:auto;padding:0.5em;background:#2d2b57;font-weight:normal;color:#e3dfff" data-reactroot=""><code class="language-python" style="white-space:pre"><span>output </span><span style="color:#4cd213">&quot;alb_url&quot;</span><span> {
</span><span>  value = </span><span style="color:#4cd213">&quot;http://${aws_alb.application_load_balancer.dns_name}&quot;</span><span>
</span>}
<!-- -->
</code></pre>
<p>If you run <code>terraform apply</code> you will have now a cluster with 1 task and 1 service running on it.</p>
<p><img src="https://miro.medium.com/max/700/1*HJc1oek7Yf7ry0X5ZhyJ4w.png" alt=""></p>
<p>Also in your terminal, you'll see the output with the URL, we can use that one to check our results with CURL as in the Southpark example.</p>
<p><img src="https://miro.medium.com/max/430/1*HAnkv3PSwmOiu17FSbC9lA.jpeg" alt=""></p>
<p>That's it! But just before you go and nap, do a terraform destroy if you won't need it anymore so you release all the resources and don't get charged extra in AWS if you're using the free version.</p>
</div></div></article></div></main></div></div><div class="jsx-1956813867"><div class="bg-primary-500 pt-20 text-white"><div class="jsx-1956813867 flex flex-col md:flex-row justify-between px-6 md:px-0"><div class="jsx-1956813867 footer-left-margin"></div><div class="jsx-1956813867 pr-4 md:py-16 md:mr-16"><div class="text-center md:text-left"><div class="flex md:justify-start"><div class="text-gray-900 flex items-center font-semibold text-3xl"><img src="/assets/images/logo-white.svg" alt="Jina.ai logo" class="w-24"/></div></div></div></div><div class="jsx-1956813867 grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-16 py-16"><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Company</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="/about/">About us</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/careers/">Careers</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/contact/">Contact us</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/blog/">Blog</a></li></ul></nav></div><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Products</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="/core/">Core</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/hub/">Hub</a></li></ul></nav></div><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Developers</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="/contribute/">Contribute</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/learn/">Learn</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="/join/">Join</a></li></ul></nav></div><div class="jsx-1324436386 footer-links sm:text-left"><div class="jsx-1324436386 font-semibold text-white footer-items-title">Social</div><nav class="jsx-1324436386 mt-3"><ul class="jsx-1324436386"><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://github.com/jina-ai/jina/">GitHub</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://www.linkedin.com/company/jinaai/">LinkedIn</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://twitter.com/jinaAI_/">Twitter</a></li><li class="jsx-1956813867"><a class="jsx-1956813867" href="https://jina-ai.slack.com/">Slack</a></li></ul></nav></div></div><div class="jsx-1956813867 footer-right-margin"></div></div><div class="text-center bg-primary-400 text-gray-100 text-sm mt-12 py-6"><span class="block md:inline-block">© 2021 Jina AI GmbH. All rights reserved.</span><span class="mx-4 hidden md:inline-block">|</span><a href="/legal"><span>Terms of Service</span></a><span class="mx-4">|</span><a href="/legal"><span>Privacy Policy</span></a></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Jina and Terraform","date":"2020-11-05T14:00:39.923Z","slug":"Terraform-plus-Jina","author":"Susana Guzmán","content":"\u003ch1\u003eJina ❤️ Terraform\u003c/h1\u003e\n\u003cp\u003eHi everyone!\nRecently I've been working with Terraform and tinkering with it to see how we can integrate it with Jina, so I thought to share with you all that I got.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn-images-1.medium.com/max/800/1*NOHC39WweKZll_StMSz6Vg.jpeg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eFirst thing was to see what Terraform is and why everyone is so hyped about it. According to their website:\u003c/p\u003e\n\u003cblockquote class=\"blockquote ml-5 mr-5\"\u003e\n“Terraform is a tool for building, changing, and versioning infrastructure safely and efficiently. Terraform can manage existing and popular service providers as well as custom in-house solutions.”\n\u003c/blockquote\u003e\n\u003cp\u003eSo that's a lot of fancy words to say it's a way for you to define your infrastructure via code. No need to go to AWS console and define every part of the infrastructure there. This comes in very handy since it's easier to debug when you have everything in one script so you can see all the details in one single place.\u003c/p\u003e\n\u003cp\u003eCool! Nice, sold, what now?\u003c/p\u003e\n\u003cp\u003eLet's tweak our \u003ca href=\"https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2Fjina-ai%2Fexamples%2Ftree%2Fmaster%2Fsouthpark-search\"\u003eSouth Park\u003c/a\u003e example and instead of running our Docker image locally and then checking the results with Curl, let's set everything on an AWS instance and use that URL. And of course, because otherwise this post wouldn't make sense and I could be napping instead, let's set up the infrastructure with Terraform. \u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eWhat will you need?\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eTerraform\u003c/li\u003e\n\u003cli\u003eAn AWS account\u003c/li\u003e\n\u003cli\u003eThe South Park Docker image\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThe first thing is to install Terraform, and the installation will depend on your OS. I'm using macOS and I installed it via Homebrew:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ebrew install terraform\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eOnce you have it installed, you need to configure your AWS, so on your console the first command you'll run is:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eaws configure\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThis will ask for the credentials of your AWS account. Once you set this, you won't need to specify keys through code, which is good because that's a bad practice and you will end up with your account in quarantine…this might have or not have happened to me. \u003c/p\u003e\n\u003cp\u003eOk! we have all the setup ready and we can start to write our Terraform file. \u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eWhat is happening? What is going to happen?\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eCreate an image repository in AWS and push our South Park docker image\u003c/li\u003e\n\u003cli\u003eCreate an ECS Cluster \u0026#x26; Task\u003c/li\u003e\n\u003cli\u003eCreate an ECS service \u0026#x26; load balancer\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch2\u003eCreate an image repository in AWS and push our South Park docker image\u003c/h2\u003e\n\u003cp\u003eWe already have a Docker image with the South Park example so we don't need to create a new one.\u003c/p\u003e\n\u003cp\u003eSo the first thing is to create our Terraform script. It can be called whatever you want but with a .tf extension\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eprovider \"aws\" {\n  version = \"~\u003e 2.0\"\n  region  = \"us-east-2\"\n}\n\n#Create repo\nresource \"aws_ecr_repository\" \"southpark\" {\n  name = \"sp-repo\" # Naming my repository\n  tags = {\n    Name = \"southpark_repo\"\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe first part is to create a provider, with Terraform you can use \u003cstrong\u003eAWS\u003c/strong\u003e, \u003cstrong\u003eAzure\u003c/strong\u003e, \u003cstrong\u003eGoogle Cloud Platform\u003c/strong\u003e or many others, you can even write your own if you feel like life is too boring and you are an expert in Go. Whatever floats your boat. We'll use AWS for this example. The second part is to create our repository and we just need to set the name for it. The tags are always optional.\u003c/p\u003e\n\u003cp\u003eThis is the simplest Terraform file you can have, if you run this, Terraform will create an AWS repository for you, so let's do that. \u003c/p\u003e\n\u003cp\u003eYou can run \u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eterraform plan\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eAnd this will print a plan with all the resources that will be created, modified, or deleted. In this case, we are only creating a resource so it will show that. This command is always nice to do for a sanity check, so you see what will happen before it happens, and if we agree with this we run the script with\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eterraform apply\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eAfter we run this, if we go to our AWS console, we'll see that an sp-repo has been created\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/max/700/1*uBSArpUv9O6DcpElkv4OFQ.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eGreat, we have our repository ready. But at the moment it's empty, we need to push our Southpark docker image into it. To do that click on the repository name, and then in the upper right corner you'll see a button of \"View Push commands\"\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/max/700/1*ZcUygghp_Ifw2oCrgYca8w.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eWe will use that information to push our Docker image\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/max/700/1*HkhGylAFXfmbqcniAOs_WA.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eFollow the steps that are shown there except step 2, we don't need that since we already have our Docker image. After you've done that, you should have the Southpark image in your repository, yay. \u003c/p\u003e\n\u003ch2\u003eCreate a Cluster \u0026#x26; Task\u003c/h2\u003e\n\u003cp\u003eThe next step is to create a Cluster.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eresource \"aws_ecs_cluster\" \"southpark_cluster\" {\n  name = \"southpark_cluster\" # Naming the cluster\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOk, for the task we need a bit more details\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#Create task\nresource \"aws_ecs_task_definition\" \"southpark_task\" {\n  family                   = \"southpark_task\" \n  container_definitions    = \u0026#x3C;\u0026#x3C;DEFINITION\n  [\n    {\n      \"name\": \"southpark_task\",\n      \"image\": \"${aws_ecr_repository.southpark.repository_url}\",\n      \"essential\": true,\n      \"portMappings\": [\n        {\n          \"containerPort\": 45678,\n          \"hostPort\": 45678\n        }\n      ],\n      \"memory\": 2014,\n      \"cpu\": 1024\n    }\n  ]\n  DEFINITION\n  requires_compatibilities = [\"FARGATE\"] # Stating that we are using ECS Fargate\n  network_mode             = \"awsvpc\"    # Using awsvpc as our network mode as this is required for Fargate\n  memory                   = 2048         # Specifying the memory our container requires\n  cpu                      = 1024        # Specifying the CPU our container requires\n  execution_role_arn       = \"${aws_iam_role.ecsExecutionRole.arn}\"\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFor this, we will set the image URL of our Docker image and set the ports to \u003ccode\u003e45678\u003c/code\u003e, the same that the Southpark example is using. \u003c/p\u003e\n\u003cp\u003eIf you run \u003ccode\u003eterraform apply\u003c/code\u003e you should see a new cluster with a task attached to it\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/max/700/1*HJc1oek7Yf7ry0X5ZhyJ4w.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2\u003eCreate a service \u0026#x26; load balancer\u003c/h2\u003e\n\u003cp\u003eOk, now we want to create a service that will use the task we just created as a blueprint. Here we will set the name of the service, a reference to our cluster, and to the task we just made. We will have only one container so we set \u003ccode\u003edesired_count\u003c/code\u003e to 1\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#create service\nresource \"aws_ecs_service\" \"southpark_service\" {\n  name            = \"southpark_service\"                             # Naming our first service\n  cluster         = \"${aws_ecs_cluster.southpark_cluster.id}\"             # Referencing our created Cluster\n  task_definition = \"${aws_ecs_task_definition.southpark_task.arn}\" # Referencing the task our service will spin up\n  launch_type     = \"FARGATE\"\n  desired_count   = 1\n\n  load_balancer {\n    target_group_arn = \"${aws_lb_target_group.target_group.arn}\" # Referencing our target group\n    container_name   = \"${aws_ecs_task_definition.southpark_task.family}\"\n    container_port   = 45678 # Specifying the container port\n  }\n\n  network_configuration {\n    subnets          = data.aws_subnet_ids.default.ids\n    assign_public_ip = true                                                # Providing our containers with public IPs\n    security_groups  = [\"${aws_security_group.service_security_group.id}\"] # Setting the security group\n  }\n  depends_on = [aws_lb_listener.lsr, aws_iam_role_policy_attachment.ecsTaskExecutionRole_policy]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe need a load balancer as the access point to our container. The load balancer needs a security group, so we need to create that too\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# Creating a security group for the load balancer:\n# This is the one that will receive traffic from internet\nresource \"aws_security_group\" \"load_balancer_security_group\" {\n  description = \"control access to the ALB\"\n  ingress {\n    from_port   = 45678\n    to_port     = 45678\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"] # Allowing traffic in from all sources\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\n#ECS will receive traffic from the ALB\nresource \"aws_security_group\" \"service_security_group\" {\n  description = \"Allow acces only from the ALB\"\n  ingress {\n    from_port = 0\n    to_port   = 0\n    protocol  = \"-1\"\n    # Only allowing traffic in from the load balancer security group\n    security_groups = [\"${aws_security_group.load_balancer_security_group.id}\"]\n  }\n\n  egress { \n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe idea is that all traffic will be received by our \u003cem\u003eload_balancer_security_group\u003c/em\u003e (ALB), and the \u003cem\u003eservice_security_group\u003c/em\u003e will receive only from the ALB.\u003c/p\u003e\n\u003cp\u003eJust for debugging, we have also an output to show us the URL that will use to access our Southpark example\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eoutput \"alb_url\" {\n  value = \"http://${aws_alb.application_load_balancer.dns_name}\"\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you run \u003ccode\u003eterraform apply\u003c/code\u003e you will have now a cluster with 1 task and 1 service running on it.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/max/700/1*HJc1oek7Yf7ry0X5ZhyJ4w.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eAlso in your terminal, you'll see the output with the URL, we can use that one to check our results with CURL as in the Southpark example.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://miro.medium.com/max/430/1*HAnkv3PSwmOiu17FSbC9lA.jpeg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThat's it! But just before you go and nap, do a terraform destroy if you won't need it anymore so you release all the resources and don't get charged extra in AWS if you're using the free version.\u003c/p\u003e\n","coverImage":"/assets/images/blog/jina_terraform.png","tags":["Terraform","infrastructure"]}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"Terraform-plus-Jina"},"buildId":"XbA3jkEVoR3KwG4kcJpM_","runtimeConfig":{},"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-7104263f55fe667182de.js" async=""></script><script src="/_next/static/chunks/framework-94f262366e752bd48d82.js" async=""></script><script src="/_next/static/chunks/commons-4667b98b62a60d7c050b.js" async=""></script><script src="/_next/static/chunks/main-9a4182dc8e7736869bf9.js" async=""></script><script src="/_next/static/chunks/pages/_app-a6a417216c843cabb548.js" async=""></script><script src="/_next/static/chunks/596-13cdde2fb793b77184ee.js" async=""></script><script src="/_next/static/chunks/522-e45333ebcf36799b860c.js" async=""></script><script src="/_next/static/chunks/373-350caaa5387e56e8b807.js" async=""></script><script src="/_next/static/chunks/93-d39fe6d1ec4ad9d5d4fc.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-f696244b1bc09a37c8f2.js" async=""></script><script src="/_next/static/XbA3jkEVoR3KwG4kcJpM_/_buildManifest.js" async=""></script><script src="/_next/static/XbA3jkEVoR3KwG4kcJpM_/_ssgManifest.js" async=""></script></body></html>